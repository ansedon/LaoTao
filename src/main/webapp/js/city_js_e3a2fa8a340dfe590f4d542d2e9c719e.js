function QiniuJsSDK(){this.detectIEVersion=function(){for(var t=4,e=document.createElement("div"),i=e.getElementsByTagName("i");e.innerHTML="<!--[if gt IE "+t+"]><i></i><![endif]-->",i[0];)t++;return t>4&&t},this.isImage=function(t){var e,i="",n=["png","jpg","jpeg","gif","bmp"],o=/\.([a-zA-Z0-9]+)(\?|\@|$)/;if(!t||!o.test(t))return!1;e=o.exec(t),i=e[1].toLowerCase();for(var r=0,a=n.length;r<a;r++)if(i===n[r])return!0;return!1},this.getFileExtension=function(t){var e,i=t.split(".");return e=1===i.length||""===i[0]&&2===i.length?"":i.pop().toLowerCase()},this.utf8_encode=function(t){if(null===t||"undefined"==typeof t)return"";var e,i,n=t+"",o="",r=0;e=i=0,r=n.length;for(var a=0;a<r;a++){var s=n.charCodeAt(a),c=null;if(s<128)i++;else if(s>127&&s<2048)c=String.fromCharCode(s>>6|192,63&s|128);else if(63488&s^!0)c=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if(64512&s^!0)throw new RangeError("Unmatched trail surrogate at "+a);var l=n.charCodeAt(++a);if(64512&l^!0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&l)+65536,c=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==c&&(i>e&&(o+=n.slice(e,i)),o+=c,e=i=a+1)}return i>e&&(o+=n.slice(e,r)),o},this.base64_encode=function(t){var e,i,n,o,r,a,s,c,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,p="",h=[];if(!t)return t;t=this.utf8_encode(t+"");do e=t.charCodeAt(u++),i=t.charCodeAt(u++),n=t.charCodeAt(u++),c=e<<16|i<<8|n,o=c>>18&63,r=c>>12&63,a=c>>6&63,s=63&c,h[d++]=l.charAt(o)+l.charAt(r)+l.charAt(a)+l.charAt(s);while(u<t.length);switch(p=h.join(""),t.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},this.URLSafeBase64Encode=function(t){return t=this.base64_encode(t),t.replace(/\//g,"_").replace(/\+/g,"-")},this.createAjax=function(t){var e={};return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(t){return window.JSON&&window.JSON.parse?window.JSON.parse(t):null===t?t:"string"==typeof t&&(t=this.trim(t),t&&/^[\],:{}\s]*$/.test(t.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,"@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))?function(){return t}():void 0},this.trim=function(t){return null===t?"":this.trim.call(t)};var t=this;this.uploader=function(e){if(!e.domain)throw"uptoken_url or domain is required!";if(!e.browse_button)throw"browse_button is required!";var i={},n=e.init&&e.init.Error,o=e.init&&e.init.FileUploaded;e.init.Error=function(){},e.init.FileUploaded=function(){},t.uptoken_url=e.uptoken_url,t.token="",t.key_handler="function"==typeof e.init.Key?e.init.Key:"",this.domain=e.domain;var r="",a=function(){var i,n,o,r=t.detectIEVersion();r&&r<=9&&e.chunk_size&&e.runtimes.indexOf("flash")>=0?e.chunk_size=0:(i=20,n=4<<i,o=plupload.parseSize(e.chunk_size),o>n&&(e.chunk_size=n))};a();var s=function(){if(e.uptoken)t.token=e.uptoken;else{var i=t.createAjax();i.open("GET",t.uptoken_url,!0),i.setRequestHeader("If-Modified-Since","0"),i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var e=t.parseJSON(i.responseText);t.token=e.uptoken}},i.send()}},c=function(i,n,o){var r="",a=!1;if(!e.save_key)if(a=i.getOption&&i.getOption("unique_names"),a=a||i.settings&&i.settings.unique_names){var s=t.getFileExtension(n.name);r=s?n.id+"."+s:n.id}else r="function"==typeof o?o(i,n):n.name;return r};plupload.extend(i,e,{url:"http://up.qiniug.com",chunk_size:0,multipart_params:{token:""}});var l=new plupload.Uploader(i);return l.bind("Init",function(t,e){s()}),l.init(),l.bind("FilesAdded",function(t,e){var i=t.getOption&&t.getOption("auto_start");i=i||t.settings&&t.settings.auto_start,i&&$.each(e,function(e,i){t.start()}),t.refresh()}),l.bind("BeforeUpload",function(i,n){r="";var o=function(i,n,o){var r;r=e.save_key?{token:t.token}:{key:c(i,n,o),token:t.token};var a=e.x_vars;if(void 0!==a&&"object"==typeof a)for(var s in a)a.hasOwnProperty(s)&&("function"==typeof a[s]?r["x:"+s]=a[s](i,n):"object"!=typeof a[s]&&(r["x:"+s]=a[s]));i.setOption({url:"http://up.qiniug.com/",multipart:!0,chunk_size:void 0,multipart_params:r})},a=i.getOption&&i.getOption("chunk_size");if(a=a||i.settings&&i.settings.chunk_size,"html5"===l.runtime&&a)if(n.size<a)o(i,n,t.key_handler);else{var s=a;r="",i.setOption({url:"http://up.qiniug.com/mkblk/"+s,multipart:!1,chunk_size:a,headers:{Authorization:"UpToken "+t.token},multipart_params:{}})}else o(i,n,t.key_handler)}),l.bind("ChunkUploaded",function(e,i,n){var o=t.parseJSON(n.response);r=r?r+","+o.ctx:o.ctx;var a=n.total-n.offset,s=e.getOption&&e.getOption("chunk_size");s=s||e.settings&&e.settings.chunk_size,a<s&&e.setOption({url:"http://up.qiniug.com/mkblk/"+a})}),l.bind("Error",function(e){return function(i,n){var o="",r=n.file;if(r){switch(n.code){case plupload.FAILED:o="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var a=i.getOption&&i.getOption("max_file_size");a=a||i.settings&&i.settings.max_file_size,o="浏览器最大可上传"+a+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:o="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:var s=t.parseJSON(n.response),c=s.error;switch(n.status){case 400:o="请求报文格式错误。";break;case 401:o="客户端认证授权失败。请重试或提交反馈。";break;case 405:o="客户端请求错误。请重试或提交反馈。";break;case 579:o="资源上传成功，但回调失败。";break;case 599:o="网络连接异常。请重试或提交反馈。";break;case 614:o="文件已存在。";try{s=t.parseJSON(s.error),c=s.error||"file exists"}catch(u){throw"invalid json format"}break;case 631:o="指定空间不存在。";break;case 701:o="上传数据块校验出错。请重试或提交反馈。";break;default:o="未知错误。"}o=o+"("+n.status+"："+c+")";break;case plupload.SECURITY_ERROR:o="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:o="上传失败。请稍后再试。";break;case plupload.IO_ERROR:o="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:o="网站配置错误。请联系网站管理员。",l.destroy();break;default:o=n.message+n.details}e&&e(i,n,o)}i.refresh()}}(n)),l.bind("FileUploaded",function(i){return function(n,o,a){var s=function(n,o,r){if(e.downtoken_url){var a=t.createAjax();a.open("POST",e.downtoken_url,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e;try{e=t.parseJSON(a.responseText)}catch(s){throw"invalid json format"}var c={};plupload.extend(c,t.parseJSON(r),e),i&&i(n,o,JSON.stringify(c))}else l.trigger("Error",{status:a.status,response:a.responseText,file:o,code:plupload.HTTP_ERROR}),window.BJ_REPORT&&window.BJ_REPORT.report("feUploadderError , code = "+plupload.HTTP_ERROR)},a.send("key="+t.parseJSON(r).key+"&domain="+e.domain)}else i&&i(n,o,r)},u=t.parseJSON(a.response);if(r=r?r:u.ctx){var d="";e.save_key||(d=c(n,o,t.key_handler),d=d?"/key/"+t.URLSafeBase64Encode(d):"");var p=e.x_vars,h="",f="";if(void 0!==p&&"object"==typeof p)for(var m in p)p.hasOwnProperty(m)&&("function"==typeof p[m]?h=t.URLSafeBase64Encode(p[m](n,o)):"object"!=typeof p[m]&&(h=t.URLSafeBase64Encode(p[m])),f+="/x:"+m+"/"+h);var g="http://up.qiniug.com/mkfile/"+o.size+d+f,v=t.createAjax();v.open("POST",g,!0),v.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),v.setRequestHeader("Authorization","UpToken "+t.token),v.onreadystatechange=function(){if(4===v.readyState)if(200===v.status){var t=v.responseText;s(n,o,t)}else l.trigger("Error",{status:v.status,response:v.responseText,file:o,code:-200}),window.BJ_REPORT&&window.BJ_REPORT.report("feUploadderError , code = -200")},v.send(r)}else s(n,o,a.response)}}(o)),l},this.getUrl=function(t){if(!t)return!1;t=encodeURI(t);var e=this.domain;return"/"!==e.slice(e.length-1)&&(e+="/"),e+t},this.imageView2=function(t,e){var i=t.mode||"",n=t.w||"",o=t.h||"",r=t.quality||"",a=t.format||"";if(!i)return!1;if(!n&&!o)return!1;var s="imageView2/"+i;return s+=n?"/w/"+n:"",s+=o?"/h/"+o:"",s+=r?"/q/"+r:"",s+=a?"/format/"+a:"",e&&(s=this.getUrl(e)+"?"+s),s},this.imageMogr2=function(t,e){var i=t["auto-orient"]||"",n=t.thumbnail||"",o=t.strip||"",r=t.gravity||"",a=t.crop||"",s=t.quality||"",c=t.rotate||"",l=t.format||"",u=t.blur||"",d="imageMogr2";return d+=i?"/auto-orient":"",d+=n?"/thumbnail/"+n:"",d+=o?"/strip":"",d+=r?"/gravity/"+r:"",d+=s?"/quality/"+s:"",d+=a?"/crop/"+a:"",d+=c?"/rotate/"+c:"",d+=l?"/format/"+l:"",d+=u?"/blur/"+u:"",e&&(d=this.getUrl(e)+"?"+d),d},this.watermark=function(t,e){var i=t.mode;if(!i)return!1;var n="watermark/"+i;if(1===i){var o=t.image||"";if(!o)return!1;n+=o?"/image/"+this.URLSafeBase64Encode(o):""}else{if(2!==i)return!1;var r=t.text?t.text:"",a=t.font?t.font:"",s=t.fontsize?t.fontsize:"",c=t.fill?t.fill:"";if(!r)return!1;n+=r?"/text/"+this.URLSafeBase64Encode(r):"",n+=a?"/font/"+this.URLSafeBase64Encode(a):"",n+=s?"/fontsize/"+s:"",n+=c?"/fill/"+this.URLSafeBase64Encode(c):""}var l=t.dissolve||"",u=t.gravity||"",d=t.dx||"",p=t.dy||"";return n+=l?"/dissolve/"+l:"",n+=u?"/gravity/"+u:"",n+=d?"/dx/"+d:"",n+=p?"/dy/"+p:"",e&&(n=this.getUrl(e)+"?"+n),n},this.imageInfo=function(t){if(!t)return!1;var e,i=this.getUrl(t)+"?imageInfo",n=this.createAjax(),o=this;return n.open("GET",i,!1),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(e=o.parseJSON(n.responseText))},n.send(),e},this.exif=function(t){if(!t)return!1;var e,i=this.getUrl(t)+"?exif",n=this.createAjax(),o=this;return n.open("GET",i,!1),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(e=o.parseJSON(n.responseText))},n.send(),e},this.get=function(t,e){return!(!e||!t)&&("exif"===t?this.exif(e):"imageInfo"===t&&this.imageInfo(e))},this.pipeline=function(t,e){var i,n,o="[object Array]"===Object.prototype.toString.call(t),r="";if(o){for(var a=0,s=t.length;a<s;a++){if(i=t[a],!i.fop)return!1;switch(i.fop){case"watermark":r+=this.watermark(i)+"|";break;case"imageView2":r+=this.imageView2(i)+"|";break;case"imageMogr2":r+=this.imageMogr2(i)+"|";break;default:n=!0}if(n)return!1}if(e){r=this.getUrl(e)+"?"+r;var c=r.length;"|"===r.slice(c-1)&&(r=r.slice(0,c-1))}return r}return!1}}function cachePlaceData(t){var e={data:{city_id:t.id},onSuccess:function(e){e&&e.data&&(window.__globalData__._cacheData={},window.__globalData__._cacheData[t.id]=e.data)},onError:function(t){console&&console.log("请求城市数据失败！")}};requirejs(["project/js/search/apiModel"],function(t){t.getPlace(e)})}window.qyerUtil.insertStyle([".qui-feedback { position:fixed; _position:absolute; z-index:99; top:120px; right:-246px; display:none;}",".qui-feedback .icon { float:left; width:24px; height:150px; background:url(http://common2.qyerstatic.com/place/common/component/feedback/icons_feedback.png) 0 0 no-repeat; cursor:pointer;}",".qui-feedback.js-current > .icon { background-position:-29px 0;}",".qui-feedback .cnt { float:left; width:246px; background-color:#e8e4df;}",".qui-feedback .cnt form { padding:0 10px 10px; font-size:0;}",".qui-feedback .cnt textarea { width:214px; height:192px; padding:2px 5px; border:1px solid #ccc; font-size:12px;}",".qui-feedback .cnt input { float:right; margin:10px 0;}",".qui-feedback .help { position:relative; top:-1px; border:1px solid #ccc; border-top:none; background:#fefdc9; height:24px; line-height:22px; text-align:center;font-size:12px;}",".qui-feedback .help a { font-weight:bold; }",".qui-feedback h4 { font-size:14px; font-weight:bold; line-height:3; padding:0 10px; clear:both;}",".qui-feedback .feedback-weixin { padding: 0 10px; }",".qui-feedback .feedback-weixin img { width:76px; float:left; margin-right:10px;}",".qui-feedback .feedback-weixin p b { margin-left:-5px;}"].join("")),setTimeout(function(){!function(){function t(){this.init()}var e;t.prototype={$div:null,init:function(){this.createDom(),this.bindEvt()},tip:function(t){requirejs(["common/ui/tip/tip"],function(e){e.tip(t)})},createDom:function(){var t=['<div class="qui-feedback">','<div class="icon js-btn" title="意见反馈"></div>','<div class="cnt">',"<h4>微信反馈，更快更方便</h4>",'<div class="feedback-weixin">','<img src="http://common2.qyerstatic.com/place/common/component/feedback/placeFeedbackQR.jpg">',"<p>扫码关注<br><b>“穷游出境游助手”</b>微信号<br>发文字、发语音、发图片<br>随时随地提意见</p>","</div>","<h4>直接在站内反馈</h4>",'<form method="post">','<textarea class="js-feedback-cnt" cols="50" rows="10" placeholder="有任何意见或建议请告诉我们"></textarea>','<p class="help">使用遇到问题？请先进入<a href="http://bbs.qyer.com/forum-10-1.html" target="_blank">帮助中心</a></p>','<input class="ui_button js-submitBtn" type="button" value="提交" class="ui_button">',"</form>","</div>","</div>"].join("");$(document.body).append(t),this.$div=$(".qui-feedback").fadeIn(300),$div=null},showLogin:function(){qyerUtil.doLogin()},bindEvt:function(){var t=this;this.$div.on("click",".js-btn",function(e){t[t.$div.hasClass("js-current")?"hideDiv":"showDiv"]()}).on("click","textarea.js-feedback-cnt",function(t){window.QYER&&window.QYER.uid||e.showLogin()}).on("click","input.js-submitBtn",function(i){if(window.QYER&&window.QYER.uid){var n=t.checkForm();n&&t.submitForm(n)}else e.showLogin()}),$(document).on("click",function(e){var i=$(e.target);i.closest(".qui-feedback").size()<1&&t.hideDiv()})},showDiv:function(){var t=this;this.$div.animate({right:0},200,function(){t.$div.addClass("js-current")})},hideDiv:function(){var t=this;this.$div.animate({right:-246},200,function(){t.$div.removeClass("js-current")})},checkValue:{cnt:function(t){var i=$(".js-feedback-cnt").val();if(i=$.trim(i),""==i||"有任何意见或建议请告诉我们"==i)return e.tip({text:"意见或建议不能为空",type:"error"}),!1;var n=window.qyerUtil.getWordLen(i);return n<20?(e.tip({text:"不能少于10个字",type:"error"}),!1):i}},checkForm:function(){var t=this.$div.find(".js-feedback-cnt").val();return this.checkValue.cnt(t)},submitForm:function(t){var i=this,n={data:{cnt:t,url:location.href},onSuccess:function(t){i.$div.find("textarea.js-feedback-cnt").val(""),e.tip({text:t.data.msg})},onError:function(t){console.log(t),77==t.error_code?e.showLogin():e.tip({text:t.data.msg,type:"error"})}};this.postFeedback(n)},postFeedback:function(t){t.posturl="/api.php?action=feedback",window.qyerUtil.doAjax(t)}},e=new t}()},3e3),function(){var t=function(){var e=[].slice.call(arguments);return e.push(t.options),e[0].match(/^\s*#([\w:\-\.]+)\s*$/gim)&&e[0].replace(/^\s*#([\w:\-\.]+)\s*$/gim,function(t,i){var n=document,o=n&&n.getElementById(i);e[0]=o?o.value||o.innerHTML:t}),1==arguments.length?t.compile.apply(t,e):arguments.length>=2?t.to_html.apply(t,e):void 0},e={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(t){return e.escapehash[t]},escaping:function(t){return"string"!=typeof t?t:t.replace(/[&<>"]/gim,this.escapereplace)},detection:function(t){return"undefined"==typeof t?"":t}},i=function(t){if("undefined"!=typeof console){if(console.warn)return void console.warn(t);if(console.log)return void console.log(t)}throw t},n=function(t,e){if(t=t!==Object(t)?{}:t,t.__proto__)return t.__proto__=e,t;var i=function(){},n=Object.create?Object.create(e):new(i.prototype=e,i);for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);return n};t.__cache={},t.version="0.6.5-stable",t.settings={},t.tags={operationOpen:"{@",operationClose:"}",interpolateOpen:"\\${",interpolateClose:"}",noneencodeOpen:"\\$\\${",noneencodeClose:"}",commentOpen:"\\{#",commentClose:"\\}"},t.options={cache:!0,strip:!0,errorhandling:!0,detection:!0,_method:n({__escapehtml:e,__throw:i,__juicer:t},{})},t.tagInit=function(){var e=t.tags.operationOpen+"each\\s*([^}]*?)\\s*as\\s*(\\w*?)\\s*(,\\s*\\w*?)?"+t.tags.operationClose,i=t.tags.operationOpen+"\\/each"+t.tags.operationClose,n=t.tags.operationOpen+"if\\s*([^}]*?)"+t.tags.operationClose,o=t.tags.operationOpen+"\\/if"+t.tags.operationClose,r=t.tags.operationOpen+"else"+t.tags.operationClose,a=t.tags.operationOpen+"else if\\s*([^}]*?)"+t.tags.operationClose,s=t.tags.interpolateOpen+"([\\s\\S]+?)"+t.tags.interpolateClose,c=t.tags.noneencodeOpen+"([\\s\\S]+?)"+t.tags.noneencodeClose,l=t.tags.commentOpen+"[^}]*?"+t.tags.commentClose,u=t.tags.operationOpen+"each\\s*(\\w*?)\\s*in\\s*range\\(([^}]+?)\\s*,\\s*([^}]+?)\\)"+t.tags.operationClose,d=t.tags.operationOpen+"include\\s*([^}]*?)\\s*,\\s*([^}]*?)"+t.tags.operationClose;t.settings.forstart=new RegExp(e,"igm"),t.settings.forend=new RegExp(i,"igm"),t.settings.ifstart=new RegExp(n,"igm"),t.settings.ifend=new RegExp(o,"igm"),t.settings.elsestart=new RegExp(r,"igm"),t.settings.elseifstart=new RegExp(a,"igm"),t.settings.interpolate=new RegExp(s,"igm"),t.settings.noneencode=new RegExp(c,"igm"),t.settings.inlinecomment=new RegExp(l,"igm"),t.settings.rangestart=new RegExp(u,"igm"),t.settings.include=new RegExp(d,"igm")},t.tagInit(),t.set=function(t,e){var i=this,n=function(t){return t.replace(/[\$\(\)\[\]\+\^\{\}\?\*\|\.]/gim,function(t){return"\\"+t})},o=function(t,e){var o=t.match(/^tag::(.*)$/i);return o?(i.tags[o[1]]=n(e),void i.tagInit()):void(i.options[t]=e)};if(2===arguments.length)return void o(t,e);if(t===Object(t))for(var r in t)t.hasOwnProperty(r)&&o(r,t[r])},t.register=function(t,e){var i=this.options._method;return!i.hasOwnProperty(t)&&(i[t]=e)},t.unregister=function(t){var e=this.options._method;if(e.hasOwnProperty(t))return delete e[t]},t.template=function(e){var i=this;this.options=e,this.__interpolate=function(t,e,i){var n,o=t.split("|"),r=o[0]||"";return o.length>1&&(t=o.shift(),n=o.shift().split(","),r="_method."+n.shift()+".call({}, "+[t].concat(n)+")"),"<%= "+(e?"_method.__escapehtml.escaping":"")+"("+(i&&i.detection===!1?"":"_method.__escapehtml.detection")+"("+r+")) %>"},this.__removeShell=function(e,n){var o=0;return e=e.replace(t.settings.forstart,function(t,e,i,n){var i=i||"value",n=n&&n.substr(1),r="i"+o++;return"<% ~function() {for(var "+r+" in "+e+") {if("+e+".hasOwnProperty("+r+")) {var "+i+"="+e+"["+r+"];"+(n?"var "+n+"="+r+";":"")+" %>"}).replace(t.settings.forend,"<% }}}(); %>").replace(t.settings.ifstart,function(t,e){return"<% if("+e+") { %>"}).replace(t.settings.ifend,"<% } %>").replace(t.settings.elsestart,function(t){return"<% } else { %>"}).replace(t.settings.elseifstart,function(t,e){return"<% } else if("+e+") { %>"}).replace(t.settings.noneencode,function(t,e){return i.__interpolate(e,!1,n)}).replace(t.settings.interpolate,function(t,e){return i.__interpolate(e,!0,n)}).replace(t.settings.inlinecomment,"").replace(t.settings.rangestart,function(t,e,i,n){var r="j"+o++;return"<% ~function() {for(var "+r+"="+i+";"+r+"<"+n+";"+r+"++) {{var "+e+"="+r+"; %>"}).replace(t.settings.include,function(t,e,i){return"<%= _method.__juicer("+e+", "+i+"); %>"}),n&&n.errorhandling===!1||(e="<% try { %>"+e,e+='<% } catch(e) {_method.__throw("Juicer Render Exception: "+e.message);} %>'),e},this.__toNative=function(t,e){return this.__convert(t,!e||e.strip)},this.__lexicalAnalyze=function(e){var i=[],n=[],o="",r=["if","each","_","_method","console","break","case","catch","continue","debugger","default","delete","do","finally","for","function","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","null","typeof","class","enum","export","extends","import","super","implements","interface","let","package","private","protected","public","static","yield","const","arguments","true","false","undefined","NaN"],a=function(t,e){if(Array.prototype.indexOf&&t.indexOf===Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},s=function(e,o){if(o=o.match(/\w+/gim)[0],a(i,o)===-1&&a(r,o)===-1&&a(n,o)===-1){if("undefined"!=typeof window&&"function"==typeof window[o]&&window[o].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return e;if("undefined"!=typeof global&&"function"==typeof global[o]&&global[o].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return e;if("function"==typeof t.options._method[o]||t.options._method.hasOwnProperty(o))return n.push(o),e;i.push(o)}return e};e.replace(t.settings.forstart,s).replace(t.settings.interpolate,s).replace(t.settings.ifstart,s).replace(t.settings.elseifstart,s).replace(t.settings.include,s).replace(/[\+\-\*\/%!\?\|\^&~<>=,\(\)\[\]]\s*([A-Za-z_]+)/gim,s);for(var c=0;c<i.length;c++)o+="var "+i[c]+"=_."+i[c]+";";for(var c=0;c<n.length;c++)o+="var "+n[c]+"=_method."+n[c]+";";return"<% "+o+" %>"},this.__convert=function(t,e){var i=[].join("");return i+="'use strict';",i+="var _=_||{};",i+="var _out='';_out+='",i+=e!==!1?t.replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out;":t.replace(/\\/g,"\\\\").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out.replace(/[\\r\\n]\\s+[\\r\\n]/g, '\\r\\n');"},this.parse=function(t,e){var o=this;return e&&e.loose===!1||(t=this.__lexicalAnalyze(t)+t),t=this.__removeShell(t,e),t=this.__toNative(t,e),this._render=new Function("_, _method",t),this.render=function(t,e){return e&&e===i.options._method||(e=n(e,i.options._method)),o._render.call(this,t,e)},this}},t.compile=function(t,e){e&&e===this.options||(e=n(e,this.options));try{var o=this.__cache[t]?this.__cache[t]:new this.template(this.options).parse(t,e);return e&&e.cache===!1||(this.__cache[t]=o),o}catch(r){return i("Juicer Compile Exception: "+r.message),{render:function(){}}}},t.to_html=function(t,e,i){return i&&i===this.options||(i=n(i,this.options)),this.compile(t,i).render(e,i._method)},"undefined"!=typeof module&&module.exports?module.exports=t:this.juicer=t}(),$(function(){function t(){$(".qyer_head_crumb .arrow").removeClass("hover"),$(".qyer_head_crumb_pulldown").hide()}var e,i,n,o,r,a;$(".qyer_head_crumb .arrow").hover(function(){a=$(this),e=a.parent(".drop"),o=e.height(),i=e.offset().left,n=e.offset().top;var t=$(this).attr("data");window.clearTimeout(r),$(".qyer_head_crumb .arrow").removeClass("hover"),$(this).addClass("hover"),$(".qyer_head_crumb_pulldown").hide(),$("."+t).css({left:i,top:n+o}).show()},function(){}),$(".qyer_head_crumb .drop").hover(function(){},function(){r=window.setTimeout(t,300)}),$(".qyer_head_crumb_pulldown").hover(function(){window.clearTimeout(r),a.addClass("hover"),$(this).show()},function(){r=window.setTimeout(t,300)})}),$(function(){$(document).on("click",function(t){0===t.button&&"true"==t.target.getAttribute("data-addtoplan")&&require(["common/component/addListToPlan/addListToPlan"],function(e){var i=$(t.target);e.qyerAddToPlan({obj:t.target,type:i.attr("data-type"),pid:i.attr("data-pid"),css:{"z-index":20}})})})}),$(function(){function t(t,e){var i=$(".plcMenuBar"),n=0;t.hover(function(){n=$(this).position().left-1,e.css("left",n).show(),i.css("z-index","99")},function(){e.hide(),i.css("z-index","")}),e.hover(function(){e.show(),i.css("z-index","99")},function(){e.hide(),i.css("z-index","")})}var e=$("#topbarPrompt");if(1==e.length){var i=e.find(".trigger"),n=e.find(".layer"),o=n.find(".title,.close");i.on("click",function(){n.show()}),o.on("click",function(){n.hide()})}var r=$(".plcMenuBarHolder"),a=$(".plcMenuBars"),s=r.offset().top;$(document).on("scroll",function(){var t=$(this).scrollTop();t>s?a.css({position:"fixed","z-index":"99",top:"0"}):a.css({position:"","z-index":"",top:""})});var c=$("#menuBarGuide"),l=$("#menuBarPoi"),u=$("#menuBarCity"),d=$("#menuBarGuideDrop"),p=$("#menuBarPoiDrop"),h=$("#menuBarCityDrop");t(c,d),t(l,p),t(u,h)}),!function(t,e,i,n){var o=t(e);t.fn.lazyload=function(r){function a(){var e=0;c.each(function(){var i=t(this);if(!l.skip_invisible||i.is(":visible"))if(t.abovethetop(this,l)||t.leftofbegin(this,l));else if(t.belowthefold(this,l)||t.rightoffold(this,l)){if(++e>l.failure_limit)return!1}else i.trigger("appear"),e=0})}var s,c=this,l={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:e,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return r&&(n!==r.failurelimit&&(r.failure_limit=r.failurelimit,delete r.failurelimit),n!==r.effectspeed&&(r.effect_speed=r.effectspeed,delete r.effectspeed),t.extend(l,r)),s=l.container===n||l.container===e?o:t(l.container),0===l.event.indexOf("scroll")&&s.bind(l.event,function(){return a()}),this.each(function(){var e=this,i=t(e);e.loaded=!1,(i.attr("src")===n||i.attr("src")===!1)&&i.is("img")&&i.attr("src",l.placeholder),i.one("appear",function(){if(!this.loaded){if(l.appear){var n=c.length;l.appear.call(e,n,l)}t("<img />").bind("load",function(){var n=i.attr("data-"+l.data_attribute);i.hide(),i.is("img")?i.attr("src",n):i.css("background-image","url('"+n+"')"),i[l.effect](l.effect_speed),e.loaded=!0;var o=t.grep(c,function(t){return!t.loaded});if(c=t(o),l.load){var r=c.length;l.load.call(e,r,l)}}).attr("src",i.attr("data-"+l.data_attribute))}}),0!==l.event.indexOf("scroll")&&i.bind(l.event,function(){e.loaded||i.trigger("appear")})}),o.bind("resize",function(){a()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.bind("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&c.each(function(){t(this).trigger("appear")})}),t(i).ready(function(){a()}),this},t.belowthefold=function(i,r){var a;return a=r.container===n||r.container===e?(e.innerHeight?e.innerHeight:o.height())+o.scrollTop():t(r.container).offset().top+t(r.container).height(),a<=t(i).offset().top-r.threshold},t.rightoffold=function(i,r){var a;return a=r.container===n||r.container===e?o.width()+o.scrollLeft():t(r.container).offset().left+t(r.container).width(),a<=t(i).offset().left-r.threshold},t.abovethetop=function(i,r){var a;return a=r.container===n||r.container===e?o.scrollTop():t(r.container).offset().top,a>=t(i).offset().top+r.threshold+t(i).height()},t.leftofbegin=function(i,r){var a;return a=r.container===n||r.container===e?o.scrollLeft():t(r.container).offset().left,a>=t(i).offset().left+r.threshold+t(i).width()},t.inviewport=function(e,i){return!(t.rightoffold(e,i)||t.leftofbegin(e,i)||t.belowthefold(e,i)||t.abovethetop(e,i))},t.extend(t.expr[":"],{"below-the-fold":function(e){return t.belowthefold(e,{threshold:0})},"above-the-top":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-screen":function(e){return t.rightoffold(e,{threshold:0})},"left-of-screen":function(e){return!t.rightoffold(e,{threshold:0})},"in-viewport":function(e){return t.inviewport(e,{threshold:0})},"above-the-fold":function(e){return!t.belowthefold(e,{threshold:0})},"right-of-fold":function(e){return t.rightoffold(e,{threshold:0})},"left-of-fold":function(e){return!t.rightoffold(e,{threshold:0})}})}(jQuery,window,document),setTimeout(function(){qyerUtil.insertStyle([".qui-gotoTop{","display:none;","width: 60px;","z-index: 100;","border: 1px solid #d7d7d7;","box-shadow: 0 0 3px rgba(0, 0, 0, 0.15);","right: 50px;","position: fixed;","bottom: 100px;",'background: url("http://static.qyer.com/models/common/component/gotoTop/icon_gotop.png") no-repeat scroll center 16px #fff;',"color: #959595;","cursor: pointer;","height: 25px;","padding-top: 53px;","text-align: center;","}"].join(""));var t=$('<div class="qui-gotoTop">回页顶</div>').appendTo(document.body).click(function(){$("html,body").animate({scrollTop:0},300)});$(window).scroll(qyerUtil.runOneInPeriodOfTime(function(){t[$(document).scrollTop()>=100?"fadeIn":"fadeOut"](300)})),t[$(document).scrollTop()>=100?"fadeIn":"fadeOut"](300)},6e3),define("project/js/slider",[],function(){function t(t){var e={prev:$(),next:$(),content:$(),item:$(),page:$(),width:0,step:1,amount:0,loop:!0,curIndex:0,autoPlay:!1,showTime:3e3,hoverPause:!0};this.options=$.extend(e,t)}function e(e){var i=new t(e);return i.init(),i}var i=null;return t.prototype.oldAnimate=function(t){this.options.item.eq(this.options.curIndex).stop(!0).animate({left:t},400)},t.prototype.newAnimate=function(t){var e=this,i=this.options.item.eq(this.options.curIndex);e.beforeAnimate(e.options.curIndex,i),i.css({left:t}).stop(!0).animate({left:0},400,function(){e.onAnimate(e.options.curIndex,i)})},t.prototype.beforeAnimate=function(t,e){"function"==typeof this.options.beforeAnimate&&this.options.beforeAnimate(t,e)},t.prototype.onAnimate=function(t,e){"function"==typeof this.options.onAnimate&&this.options.onAnimate(t,e)},t.prototype.autoPlay=function(){var t=this;this.options.autoPlay&&(window.clearTimeout(i),i=window.setTimeout(function(){t.doNext()},t.options.showTime))},t.prototype.doNext=function(){!this.options.loop&&this.options.next.hasClass("disabled")||(this.oldAnimate("-100%"),this.getNext(),this.newAnimate("100%"),1==this.options.page.length&&this.options.page.children().removeClass("current").eq(this.options.curIndex).addClass("current"),this.autoPlay(),this.options.loop||(this.options.curIndex>=this.options.amount-1&&this.options.next.addClass("disabled"),this.options.prev.removeClass("disabled")))},t.prototype.doPrev=function(){!this.options.loop&&this.options.prev.hasClass("disabled")||(this.oldAnimate("100%"),this.getPrev(),this.newAnimate("-100%"),this.options.loop||(this.options.curIndex<=0&&this.options.prev.addClass("disabled"),this.options.next.removeClass("disabled")))},t.prototype.getNext=function(){this.options.curIndex++,this.options.curIndex>this.options.amount-1&&(this.options.curIndex=0)},t.prototype.getPrev=function(){this.options.curIndex--,this.options.curIndex<0&&(this.options.curIndex=this.options.amount-1)},t.prototype.bindEvent=function(){var t=this;this.options.next.on("click",function(){t.doNext()}),this.options.prev.on("click",function(){t.doPrev()}),this.options.autoPlay&&this.options.hoverPause&&(this.options.content.on("mouseenter",function(){window.clearTimeout(i)}),this.options.content.on("mouseleave",function(){t.autoPlay()}))},t.prototype.init=function(){this.options.item=this.options.content.children(),this.options.width=this.options.item.eq(0).outerWidth(),this.options.amount=this.options.item.length,this.options.amount<2||(this.options.item.css({position:"absolute",left:"100%"}).eq(0).css({left:"0"}),this.bindEvent(),this.autoPlay(),this.options.loop||this.options.prev.addClass("disabled"))},e}),define("common/util/util",[],function(){"use strict";return{getInstance:function(t,e){switch(e=e||[],e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);default:for(var i=[],n=0,o=e.length;n<o;n++)i.push("arguments["+n+"]");return new Function("return new this("+i.join(",")+");").apply(t,e)}},extend:function(t,e){$.extend(!0,t,e,t)},getStarHtml:function(t,e,i,n){t=Math.floor(t)/2;for(var o=[],r=1;r<=5;r++)t>=r?o.push(e):t+1>r?o.push(i):o.push(n);return o.join("")}}}),define("common/lang/aop",[],function(){"use strict";var t=function(t,i,n,o){var r,a,s=$.isFunction(t);if(s?(r=t,o=n,n=i):r=t[i],a=r,$.isFunction(n)){a=e(n,a,1);for(var c in r)a[c]=r[c]}if($.isFunction(o)){a=e(a,o,0);for(var c in r)a[c]=r[c]}return s||(t[i]=a),a},e=function(t,e,i){return function(){var n=t.apply(this,arguments),o=e.apply(this,arguments);return 0==i?n:o}},i=function(e,i,n){return t(e,i,n,null)},n=function(e,i,n){return t(e,i,null,n)},o=function(e,i,n,o){return t(e,i,n,o)};return{before:i,after:n,wrapper:o}}),define("common/lang/oo-static",["../util/util"],function(t){"use strict";return function(){t.extend(this,{getStatic:function(t){return t?this[t]:this},setStatic:function(e,i){return 1===arguments.length?t.extend(this,e):this[e]=i,this}}),this.implement({getStatic:function(t){return this.constructor.getStatic.apply(this.constructor,arguments)},setStatic:function(t,e){return this.constructor.setStatic.apply(this.constructor,arguments),this},callStatic:function(t,e){return this.getStatic(t).apply(this.constructor,e)}})}}),define("common/lang/oo",["../util/util","./aop","./oo-static"],function(t,e,i){"use strict";var n=function(t){var e=function(){};return e.prototype=t,new e},o=function(e,i,n){e?"function"!=typeof e&&(n=i,i=e,e=c):e=c;var o=r(e,function(){
return this instanceof o?o.superclass.prototype.constructor.apply(this,arguments):t.getInstance(o,arguments)});return a(o,i),t.extend(o,e),t.extend(o,n),o.superclass=e,o},r=function(t,e){return e.prototype=n(t.prototype),e.prototype.constructor=e,e},a=function(t,e){for(var i in e)if(e[i]instanceof Function&&"callSuper"!==i&&"callParent"!==i){var n=s(i,t,e[i]);t.prototype[i]=n}else t.prototype[i]=e[i]},s=function(t,i,n){var o,r=e.wrapper(n,function(){o=this.__caller,this.__caller=r},function(){void 0===o?delete this.__caller:this.__caller=o});return r.__name=t,r.__owner=i,r},c=o(function(){this.init.apply(this,arguments)},{init:function(t){this.lang=t&&t.lang||this.lang},callParent:function(t){var e=Array.prototype.slice.call(arguments);return this.__caller.__owner.superclass.prototype[e.shift(0)].apply(this,e)},callSuper:function(){return this.__caller.__owner.superclass.prototype[this.__caller.__name].apply(this,arguments)},before:function(t,i){return e.before(this,t,s(t,this.constructor,function(){return i.apply(this,arguments)})),this},after:function(t,i){return e.after(this,t,s(t,this.constructor,function(){return i.apply(this,arguments)})),this}},{createClass:function(t,e){return o.apply(this,Array.prototype.concat.apply([this],arguments))},implement:function(t){return a(this,t),this},plugin:function(t,e){return t instanceof Function&&t.apply(this,e),this}}).plugin(i),l={Parent:c,createClass:o};return l}),define("common/lang/oo-event",["./aop"],function(t){"use strict";var e={getEventproxy:function(){return $(this)},bind:function(t,e){var i=this.getEventproxy();return i.bind.apply(i,arguments),this},unbind:function(t,e){var i=this.getEventproxy();return i.unbind.apply(i,arguments),this},on:function(){return this.bind.apply(this,arguments)},off:function(){return this.unbind.apply(this,arguments)},one:function(e,i){var n=arguments[1]=t.before(arguments[1],function(){this.unbind(e,n)});return this.bind.apply(this,arguments),this},trigger:function(t,e){var i=this.getEventproxy();return i.trigger.apply(i,arguments),this}};return e}),define("common/lang/i18n",[],function(){"use strict";var t={lang:"zh",i18n:function(t){return this.callStatic("getI18n",[this.lang,t])}},e={i18n_key:"i18n",lang:"zh",i18n:function(t,e){1===arguments.length&&(e=t,t=this.lang);var i=this.getStatic(this._i18n_key)||{};return i[t]=e,this.setStatic(this._i18n_key,i),this},getI18n:function(t,e){var i=(this.getStatic(this._i18n_key)||{})[t];return e?i[e]:i}};return function(){this.implement(t),this.setStatic(e)}}),define("common/widget/widget",["../lang/oo","../lang/oo-event","../lang/i18n"],function(t,e,i){return t.createClass({$el:null,_event_alias:"__widget",init:function(t){this.callSuper.apply(this,arguments),this.setAttrs(t||{}),this.delegateEvents(this.events),this.delegateEvents(t.events)},setAttrs:function(t,e){1===arguments.length&&(e=t,t=this.getStatic("ATTRS")),this._setAttrs(t,e)},_setAttrs:function(t,e){$.each(t,this.proxy(function(t,i){this.setAttr(t,e[t])}))},setAttr:function(t,e){e="undefined"==typeof e?this.getStatic("ATTRS")[t]:e,e="$"===t.charAt(0)?$(e):e,this[t]=e},$:function(t){return t?$(t,this.$el):this.$el},delegateEvents:function(t){return t&&$.each(t,$.proxy(function(t,e){this.delegateEvent.apply(this,e)},this)),this},delegateEvent:function(t,e,i){return t&&e&&(e="string"==typeof e&&$.isFunction(this[e])?$.proxy(this[e],this):$.proxy(e,this),this.$el.on(t+"."+this._event_alias,$.isFunction(i)?i.call(this):i,e)),this},undelegateEvents:function(){this.$el.off("."+this._event_alias)},proxy:function(t){return Array.prototype.splice.call(arguments,1,0,this),$.proxy.apply($,arguments)},destroy:function(){this.undelegateEvents();for(var t in this)if(this.hasOwnProperty(t)){if(this[t]&&$.isFunction(this[t].destroy))try{this[t].destroy()}catch(e){}delete this[t]}}},{ATTRS:{$el:document.body}}).implement(e).plugin(i)}),define("common/widget/userbehavior/config",[],function(){var t=['<span class="poiRedPoint" id="poiRedPoint"></span>','<div class="poiLikeTip" id="poiLikeTip">','<span class="close"></span>','<a href="javscript:void(0)" class="neverShow">不再提示</a>','<p class="text fontYaHei t1"><em>点击想去</em>，心爱的目的地不再错过！</p>','<p class="text fontYaHei t2">旅途中穷游app还可同步查看！</p>',"</div>",'<div class="poiLikeSmallTip" id="poiLikeSmallTip">',"收藏至“我的想去”，随时查看最新信息","</div>"].join(""),e={addPoiComment:{text:"点评旅行地",link:"javascript:void(0)",classname:"js-poiComment","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-addcomment"}},addMguide:{text:"添加微锦囊",link:"http://place.qyer.com/mguide/add","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-addmguide"}},addTripNote:{text:"写游记",link:function(t){return"http://bbs.qyer.com/thread-new?type=1&fid="+__GLOBAL_DATA__.fid},"data-bn-ipg":function(t){return"place-"+t.type+"-footprint-post"}},canelFootprint:{text:"取消足迹",link:"javascript:void(0)",classname:"js-cancelFootprint","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-cancel"}}},i=function(t,e,i,n){return'<li><a data-bn-ipg="'+n+'" class="'+i+'" href="'+e+'">'+t+"</a></li>"},n=function(t,e){switch(typeof t){case"string":return t;case"function":return t(e);case"undefined":return""}},o={country:["planto","beento","lived"],city:["planto","beento","lived"],poi:["planto","beento","addToPlan"],outerClass:"place-userbehavior",beDoneClass:"selected",planto:{classname:["planto","fontYaHei","plcZIndex"].join(" "),text:"想去",sText:"已想去",exStr:t,"data-bn-ipg":function(t){switch(t.status){case 1:return"place-"+t.type+"-footprint-wishto-add";case 0:return"place-"+t.type+"-footprint-wishto-delete"}}},beento:{classname:["beento","fontYaHei"].join(" "),text:"去过",sText:"已去过",exStr:function(t){__GLOBAL_DATA__&&__GLOBAL_DATA__.fid||delete e.addTripNote;var o="<ul>";return $.each(e,function(e,r){o+=i(r.text,n(r.link,t),r.classname,n(r["data-bn-ipg"],t))}),o+="</ul>"},"data-bn-ipg":function(t){return"place-"+t.type+"-top-beenTo"}},lived:{classname:["lived","fontYaHei"].join(" "),text:"生活过",sText:"已生活过","data-bn-ipg":function(t){return"place-"+t.type+"-footprint-lived"}},addToPlan:{classname:["addToPlan","fontYaHei"].join(" "),text:"加入行程",sText:"加入行程",special:!0,getDom:function(t){return'<li class="'+o[t].classname+'" data-type="'+o.type+'" data-addtoplan="true" data-pid="'+o.id+'"><span class="fonts">'+o[t].text+"</span></li>"},"data-bn-ipg":function(){return"place-poi-top-addtoplan"}},getDom:function(t,e,i){o.type=t,o.id=e;var n="undefined"!=typeof i,r={};return r.inner=o[t],r.isLogin=n,i&&(r.userinfo=i),o.createDom(r)},createDom:function(t){var e="",i=t.isLogin,r={type:o.type,id:o.id};return $.each(t.inner,function(a,s){if(o[s].special)e+=o[s].getDom(s);else{var c=i?t.userinfo[s]-0:0;r.status=c,e+='<li class="'+o[s].classname+(i&&c?" selected":"")+'" data-type="'+s+'" data-status="'+(i?c:0)+'" data-bn-ipg="'+n(o[s]["data-bn-ipg"],r)+'"><span class="fonts">'+o[s][i&&c?"sText":"text"]+"</span>"+n(o[s].exStr,r)+"</li>"}}),'<ul class="'+o.outerClass+'">'+e+"</ul>"}};return o}),define("common/service/service",[],function(){return{post:function(t,e,i,n){return qyerUtil.doAjax({url:t,type:"POST",data:e,onSuccess:i,onError:n})},get:function(t,e,i,n){return qyerUtil.doAjax({url:t,type:"GET",data:e,onSuccess:i,onError:n})}}}),define("common/service/userbehavior/urls",[],function(){return{getBehaviorInfo:"/api.php?action=getfeeling",feeling:"/api.php?action=feeling"}}),define("common/service/userbehavior/userbehavior-service",["../service","./urls"],function(t,e){"use strict";var i={getBehaviorInfo:function(i,n,o){t.get(e.getBehaviorInfo,i,n,o)},feeling:function(i,n,o){t.post(e.feeling,i,n,o)}};return i}),define("common/widget/userbehavior/liketip",[],function(){function t(t){$.extend(this,t||{$poiRedPoint:$("#poiRedPoint"),$poiLikeTip:$("#poiLikeTip"),$poiLikeSmallTip:$("#poiLikeSmallTip"),$like:$("#poiRedPoint").parent(),$been:$("#poiRedPoint").parents("ul").find(".beento")}),this.init(),window.likeTipHanlder=this}return t.prototype={init:function(){var t=this;if(window.qyerUtil.isLogin()){if(t.checkIsLike()||t.checkIsBeenTo()||t.checkIsLived())return t.hideDom(t.$poiRedPoint),t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip),!1;t.showDom(t.$poiRedPoint)}else t.showDom(t.$poiRedPoint);t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip),t.checkCookie("_isNeverShowBigTip")?t.hoverShowDom(t.$poiLikeSmallTip):t.checkCookie("_isShowBigTip")>=3&&t.hoverShowDom(t.$poiLikeSmallTip),t.bindEvent()},bindEvent:function(){var t=this;t.$poiLikeTip.find(".close").on("click",function(e){if(t.checkCookie("_isShowBigTip")){var i=new Date;i.setTime(i.getTime()+31104e6),t.setCookie("_isNeverShowBigTip=true;expires="+i.toGMTString()+";path=/")}else t.setCookie("_isShowBigTip=1");return t.hideDom(t.$poiLikeTip),e.stopPropagation(),!1}).addBack().find(".neverShow").on("click",function(e){var i=t.checkCookie("_isShowBigTip")-0+1,n=new Date;return n.setTime(n.getTime()+31104e6),t.setCookie("_isNeverShowBigTip="+i+";expires="+n.toGMTString()+";path=/"),t.hideDom(t.$poiLikeTip),e.stopPropagation(),!1}),t.$like.on("mouseenter",function(){t.checkCookie("_isNeverShowBigTip")||t.checkCookie("_isShowBigTip")>=3||t.checkIsBeenTo()||t.checkIsLike()||t.checkIsLived()||t.showDom(t.$poiLikeTip)})},hideDom:function(t){t.removeClass("poiLikeHoverShow poiLikeShow")},showDom:function(t){t.addClass("poiLikeShow")},hoverShowDom:function(t){t.addClass("poiLikeHoverShow")},checkIsLike:function(){return this.$like.hasClass("selected")},checkIsBeenTo:function(){return this.$been.hasClass("selected")},checkIsLived:function(){return $(".place-userbehavior").length>0&&($(".place-userbehavior").find(".lived").length>0&&$(".place-userbehavior").find(".lived").hasClass("selected"))},setCookie:function(t){document.cookie=t},checkCookie:function(t){for(var e=this.getCookie(),i=e.split(";"),n=0,o=i.length,r=!1;n<o;n++)if($.trim(t)==$.trim(i[n]).split("=")[0]){r=$.trim(i[n]).split("=")[1];break}return r},getCookie:function(){return document.cookie},closeAll:function(){var t=this;t.hideDom(t.$poiRedPoint),t.hideDom(t.$poiLikeTip),t.hideDom(t.$poiLikeSmallTip)}},t}),define("project/js/batch_add_footprint",[],function(){function t(t,e,i,n){var o="";"city"==e||"area"==e?requirejs(["common/component/footprint/js/footprint"],function(e){e.poiShow({city_id:t,show_type:"poi"})}):"poi"==e?qyerUI.popup.ajax({url:"/api.php?action=addpoicomment&from=poi&source_type=11&poiid="+t+"&typeid="+PLACE.CITYID+"&type=city",width:"690",isclose:"show"}):"country"==e&&requirejs(["common/component/footprint/js/footprint"],function(e){e.countryFpShow({country_id:t,show_type:"country"})}),""==o}return t}),define("common/basic/js/normalize",[],function(){function t(t,i,o){if(t.match(s)||t.match(a))return t;t=r(t);var c=o.match(a),l=i.match(a);return!l||c&&c[1]==l[1]&&c[2]==l[2]?n(e(t,i),o):e(t,i)}function e(t,e){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(s)||t.match(a))return t;var i=e.split("/"),n=t.split("/");for(i.pop();curPart=n.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function n(t,e){var n=e.split("/");for(n.pop(),e=n.join("/")+"/",i=0;e.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),t=t.substr(i+1),n=e.split("/");var o=t.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,r=function(t){return t.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,c=function(e,i,n){i=r(i),n=r(n);for(var o,a,e,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(e);){a=o[3]||o[2]||o[5]||o[6]||o[4];var c;c=t(a,i,n);var l=o[5]||o[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+c+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(c.length-a.length)}return e};return c.convertURIBase=t,c.absoluteURI=e,c.relativeURI=n,c}),define("common/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(t,e,i){i()}};var t=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,i=!1,n=!0;e[1]||e[7]?i=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?n=!1:e[4]&&(i=parseInt(e[4])<18);var o={};o.pluginBuilder="./css-builder";var r,a,s,c=function(){r=document.createElement("style"),t.appendChild(r),a=r.styleSheet||r.sheet},l=0,u=[],d=function(t){a.addImport(t),r.onload=function(){p()},l++,31==l&&(c(),l=0)},p=function(){s();var t=u.shift();return t?(s=t[1],void d(t[0])):void(s=null)},h=function(t,e){if(a&&a.addImport||c(),a&&a.addImport)s?u.push([t,e]):(d(t),s=e);else{r.textContent='@import "'+t+'";';var i=setInterval(function(){try{r.sheet.cssRules,clearInterval(i),e()}catch(t){}},10)}},f=function(e,i){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",n)o.onload=function(){o.onload=function(){},setTimeout(i,7)};else var r=setInterval(function(){for(var t=0;t<document.styleSheets.length;t++){var e=document.styleSheets[t];if(e.href==o.href)return clearInterval(r),i()}},10);o.href=e,t.appendChild(o)};return o.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},o.load=function(t,e,n,o){(i?h:f)(e.toUrl(t+".css"),n)},o}),define("common/basic/js/require-css!common/ui/popup/popup",[],function(){}),define("common/ui/popup/popup",["css!common/ui/popup/popup.css"],function(){var t=jQuery,e={$ui:null,$content:null,$box:null,$title:null,$okBtn:null,$cancelBtn:null,$loadBtn:null,$closeIcon:null,_uiState:"normal",defaultWidth:400,init:function(){var e=['<div class="qui-popup" style="display:none">',"<div>",'<div class="qui-popup-dt">','<div class="qui-popup-box">','<div class="qui-popup-closeIcon">&nbsp;</div>','<div class="qui-popup-box-title fontYaHei">title</div>','<div class="qui-popup-box-content">',"</div>",'<div class="qui-popup-box-bottom">',"&nbsp;",'<input class="qui-popup-cancelBtn ui_button_cancel" type="button" value="取消" />  ','<input class="qui-popup-okBtn ui_button" type="button" value="确定" />  ','<input class="qui-popup-loadingBtn  ui_button_load" type="button" value="" />  ',"</div>","</div>","</div>","</div>","</div>"].join("");this.$ui=t(e),this.$content=this.$ui.find(".qui-popup-box-content"),this.$box=this.$ui.find(".qui-popup-box"),this.$title=this.$ui.find(".qui-popup-box-title"),this.$okBtn=this.$ui.find(".qui-popup-okBtn"),this.$cancelBtn=this.$ui.find(".qui-popup-cancelBtn"),this.$loadBtn=this.$ui.find(".qui-popup-loadingBtn"),this.$closeIcon=this.$ui.find(".qui-popup-closeIcon"),this.$ui.appendTo(document.body)},setWidth:function(t){this.$box.animate({width:t},300)},setUIDefault:function(t){this.$ui[0].className="qui-popup",t.exClassName&&this.$ui.addClass(t.exClassName),t.iframeSrc?this.$content.html('<iframe src="'+t.iframeSrc+'"  scrolling="auto" style="height:'+(t.iframeHeight||300)+'px;"  />'):this.$content.html(t.contentHTML||"&nbsp;"),this.$title.html(t.title||"Title"),this.$box.css("width",t.width||this.defaultWidth),this.$title[t.showTitle===!1?"hide":"show"](),this.$okBtn.val(t.okText||"确定"),this.$cancelBtn.val(t.cancelText||"取消"),this.$okBtn[t.showOKBtn===!1?"hide":"show"](),this.$okBtn.removeAttr("data-bn-ipg"),this.$cancelBtn[t.showCancelBtn===!1?"hide":"show"](),this.$cancelBtn.removeAttr("data-bn-ipg"),this.$loadBtn[t.showLoadBtn===!0?"show":"hide"](),this.$loadBtn.removeAttr("data-bn-ipg"),this.$ui.find(".qui-popup-closeIcon").removeAttr("data-bn-ipg"),this.$closeIcon[t.showCloseIcon===!1?"hide":"show"]()},show:function(i){if("hideing"==e._uiState)e.$box.stop(),e.$ui.stop(),this.$ui.css({display:"block",opacity:1}),this.$box.css({top:0,opacity:1}),e._uiState="normal",i.onShow&&i.onShow();else{e._uiState="showing";var n={},o={top:0};t.support.leadingWhitespace&&(n.opacity=1,o.opacity=1),this.$ui.css("display","block").animate(n,200,function(){e.$box.css("top",-30).animate(o,200,function(){e._uiState="normal",i.onShow&&i.onShow()})})}},hide:function(i){if(!i||!i.onBeforeHide||i.onBeforeHide()!==!1){e._uiState="hideing";var n={top:-30},o={};t.support.leadingWhitespace&&(n.opacity=0,o.opacity=0),this.$box.animate(n,200,function(){e.$ui.animate(o,200,function(){e._uiState="normal",e.$ui.css("display","none"),e.$content.html(""),i&&i.onAfterHide&&i.onAfterHide()})})}}};e.init();var i=null,n={show:function(t){return i=t,e.setUIDefault(t),e.$ui.undelegate("click").delegate(".qui-popup-okBtn,.qui-popup-cancelBtn,.qui-popup-closeIcon","click",function(i){if(this.className.indexOf("qui-popup-closeIcon")!=-1||this.className.indexOf("qui-popup-cancelBtn")!=-1){if(t.onBeforeCancel&&!t.onBeforeCancel(i))return;t.onCancel&&t.onCancel()}else if(this.className.indexOf("qui-popup-okBtn")!=-1&&t.onOK&&t.onOK()===!1)return;e.hide(t)}),e.show(t),this},hide:function(t){return e.hide(t),this},setContent:function(t){return e.$content.html(t),this},getContent:function(){return e.$content[0]},getButtons:function(){return{okBtn:e.$okBtn[0],cancelBtn:e.$cancelBtn[0],loadBtn:e.$loadBtn[0],closeIcon:e.$ui.find(".qui-popup-closeIcon")[0]}},setOption:function(n){var o={width:function(){e.setWidth(n.width)},showTitle:function(){n.showTitle===!1?e.$title.hide():e.$title.show()},okText:function(){e.$okBtn.val(n.okText)},cancelText:function(){e.$cancelBtn.val(n.cancelText)},showOKBtn:function(){n.showOKBtn===!1?e.$okBtn.hide():e.$okBtn.show()},showCancelBtn:function(){n.showCancelBtn===!1?e.$cancelBtn.hide():e.$cancelBtn.show()},showLoadBtn:function(){n.showLoadBtn===!1?e.$loadBtn.hide():e.$loadBtn.show()},showCloseIcon:function(){n.showCloseIcon===!1?e.$closeIcon.hide():e.$closeIcon.show()},title:function(){e.$title.html(n.title)},exClassName:function(){e.$ui[0].className="qui-popup "+n.exClassName},contentHTML:function(){n.iframeSrc||e.$content.html(n.contentHTML)},iframeSrc:function(){e.$content.html('<iframe src="'+n.iframeSrc+'"  scrolling="auto" style="height:'+(n.iframeHeight||300)+'px;" />')},iframeHeight:function(){e.$content.children("iframe").css("height",n.iframeHeight)}};for(var r in n)i[r]=n[r],"function"==t.type(o[r])&&o[r]()}};return n}),!function(t,e){"use strict";function i(t,e){for(var i,n=[],r=0;r<t.length;++r){if(i=a[t[r]]||o(t[r]),!i)throw"module definition dependecy not found: "+t[r];n.push(i)}e.apply(null,n)}function n(t,n,o){if("string"!=typeof t)throw"invalid module definition, module id must be defined and be a string";if(n===e)throw"invalid module definition, dependencies must be specified";if(o===e)throw"invalid module definition, definition function must be specified";i(n,function(){a[t]=o.apply(null,arguments)})}function o(e){for(var i=t,n=e.split(/[.\/]/),o=0;o<n.length;++o){if(!i[n[o]])return;i=i[n[o]]}return i}function r(i){for(var n=0;n<i.length;n++){for(var o=t,r=i[n],s=r.split(/[.\/]/),c=0;c<s.length-1;++c)o[s[c]]===e&&(o[s[c]]={}),o=o[s[c]];o[s[s.length-1]]=a[r]}}var a={},s="moxie/core/utils/Basic",c="moxie/core/I18n",l="moxie/core/utils/Mime",u="moxie/core/utils/Env",d="moxie/core/utils/Dom",p="moxie/core/Exceptions",h="moxie/core/EventTarget",f="moxie/core/utils/Encode",m="moxie/runtime/Runtime",g="moxie/runtime/RuntimeClient",v="moxie/file/Blob",_="moxie/file/File",y="moxie/file/FileInput",b="moxie/file/FileDrop",x="moxie/runtime/RuntimeTarget",w="moxie/file/FileReader",k="moxie/core/utils/Url",D="moxie/file/FileReaderSync",E="moxie/xhr/FormData",C="moxie/xhr/XMLHttpRequest",T="moxie/runtime/Transporter",A="moxie/image/Image",S="moxie/runtime/html5/Runtime",$="moxie/runtime/html5/file/Blob",R="moxie/core/utils/Events",I="moxie/runtime/html5/file/FileInput",j="moxie/runtime/html5/file/FileDrop",q="moxie/runtime/html5/file/FileReader",O="moxie/runtime/html5/xhr/XMLHttpRequest",M="moxie/runtime/html5/utils/BinaryReader",L="moxie/runtime/html5/image/JPEGHeaders",N="moxie/runtime/html5/image/ExifParser",P="moxie/runtime/html5/image/JPEG",F="moxie/runtime/html5/image/PNG",z="moxie/runtime/html5/image/ImageInfo",B="moxie/runtime/html5/image/MegaPixel",U="moxie/runtime/html5/image/Image",H="moxie/runtime/flash/Runtime",Y="moxie/runtime/flash/file/Blob",G="moxie/runtime/flash/file/FileInput",V="moxie/runtime/flash/file/FileReader",W="moxie/runtime/flash/file/FileReaderSync",K="moxie/runtime/flash/xhr/XMLHttpRequest",X="moxie/runtime/flash/runtime/Transporter",J="moxie/runtime/flash/image/Image",Q="moxie/runtime/silverlight/Runtime",Z="moxie/runtime/silverlight/file/Blob",tt="moxie/runtime/silverlight/file/FileInput",et="moxie/runtime/silverlight/file/FileDrop",it="moxie/runtime/silverlight/file/FileReader",nt="moxie/runtime/silverlight/file/FileReaderSync",ot="moxie/runtime/silverlight/xhr/XMLHttpRequest",rt="moxie/runtime/silverlight/runtime/Transporter",at="moxie/runtime/silverlight/image/Image",st="moxie/runtime/html4/Runtime",ct="moxie/runtime/html4/file/FileInput",lt="moxie/runtime/html4/file/FileReader",ut="moxie/runtime/html4/xhr/XMLHttpRequest",dt="moxie/runtime/html4/image/Image";n(s,[],function(){var t=function(t){var e;return t===e?"undefined":null===t?"null":t.nodeType?"node":{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},e=function(n){var o;return i(arguments,function(r,s){s>0&&i(r,function(i,r){i!==o&&(t(n[r])===t(i)&&~a(t(i),["array","object"])?e(n[r],i):n[r]=i)})}),n},i=function(t,e){var i,n,o,r;if(t){try{i=t.length}catch(a){i=r}if(i===r){for(n in t)if(t.hasOwnProperty(n)&&e(t[n],n)===!1)return}else for(o=0;i>o;o++)if(e(t[o],o)===!1)return}},n=function(e){var i;if(!e||"object"!==t(e))return!0;for(i in e)return!1;return!0},o=function(e,i){function n(o){"function"===t(e[o])&&e[o](function(t){++o<r&&!t?n(o):i(t)})}var o=0,r=e.length;"function"!==t(i)&&(i=function(){}),e&&e.length||i(),n(o)},r=function(t,e){var n=0,o=t.length,r=new Array(o);i(t,function(t,i){t(function(t){if(t)return e(t);var a=[].slice.call(arguments);a.shift(),r[i]=a,n++,n===o&&(r.unshift(null),e.apply(this,r))})})},a=function(t,e){if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i}return-1},s=function(e,i){var n=[];"array"!==t(e)&&(e=[e]),"array"!==t(i)&&(i=[i]);for(var o in e)-1===a(e[o],i)&&n.push(e[o]);return!!n.length&&n},c=function(t,e){var n=[];return i(t,function(t){-1!==a(t,e)&&n.push(t)}),n.length?n:null},l=function(t){var e,i=[];for(e=0;e<t.length;e++)i[e]=t[e];return i},u=function(){var t=0;return function(e){var i,n=(new Date).getTime().toString(32);for(i=0;5>i;i++)n+=Math.floor(65535*Math.random()).toString(32);return(e||"o_")+n+(t++).toString(32)}}(),d=function(t){return t?String.prototype.trim?String.prototype.trim.call(t):t.toString().replace(/^\s*/,"").replace(/\s*$/,""):t},p=function(t){if("string"!=typeof t)return t;var e,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return t=/^([0-9]+)([mgk]?)$/.exec(t.toLowerCase().replace(/[^0-9mkg]/g,"")),e=t[2],t=+t[1],i.hasOwnProperty(e)&&(t*=i[e]),t};return{guid:u,typeOf:t,extend:e,each:i,isEmptyObj:n,inSeries:o,inParallel:r,inArray:a,arrayDiff:s,arrayIntersect:c,toArray:l,trim:d,parseSizeStr:p}}),n(c,[s],function(t){var e={};return{addI18n:function(i){return t.extend(e,i)},translate:function(t){return e[t]||t},_:function(t){return this.translate(t)},sprintf:function(e){var i=[].slice.call(arguments,1);return e.replace(/%[a-z]/g,function(){var e=i.shift();return"undefined"!==t.typeOf(e)?e:""})}}}),n(l,[s,c],function(t,e){var i="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",n={mimes:{},extensions:{},addMimeType:function(t){var e,i,n,o=t.split(/,/);for(e=0;e<o.length;e+=2){for(n=o[e+1].split(/ /),i=0;i<n.length;i++)this.mimes[n[i]]=o[e];this.extensions[o[e]]=n}},extList2mimes:function(e,i){var n,o,r,a,s=this,c=[];for(o=0;o<e.length;o++)for(n=e[o].extensions.split(/\s*,\s*/),r=0;r<n.length;r++){if("*"===n[r])return[];if(a=s.mimes[n[r]])-1===t.inArray(a,c)&&c.push(a);else{if(!i||!/^\w+$/.test(n[r]))return[];c.push("."+n[r])}}return c},mimes2exts:function(e){var i=this,n=[];return t.each(e,function(e){if("*"===e)return n=[],!1;var o=e.match(/^(\w+)\/(\*|\w+)$/);o&&("*"===o[2]?t.each(i.extensions,function(t,e){new RegExp("^"+o[1]+"/").test(e)&&[].push.apply(n,i.extensions[e])}):i.extensions[e]&&[].push.apply(n,i.extensions[e]))}),n},mimes2extList:function(i){var n=[],o=[];return"string"===t.typeOf(i)&&(i=t.trim(i).split(/\s*,\s*/)),o=this.mimes2exts(i),n.push({title:e.translate("Files"),extensions:o.length?o.join(","):"*"}),n.mimes=i,n},getFileExtension:function(t){var e=t&&t.match(/\.([^.]+)$/);return e?e[1].toLowerCase():""},getFileMime:function(t){return this.mimes[this.getFileExtension(t)]||""}};return n.addMimeType(i),n}),n(u,[s],function(t){function e(t,e,i){var n=0,o=0,r=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(t){return t=(""+t).replace(/[_\-+]/g,"."),t=t.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),t.length?t.split("."):[-8]},c=function(t){return t?isNaN(t)?a[t]||-7:parseInt(t,10):0};for(t=s(t),e=s(e),o=Math.max(t.length,e.length),n=0;o>n;n++)if(t[n]!=e[n]){if(t[n]=c(t[n]),e[n]=c(e[n]),t[n]<e[n]){r=-1;break}if(t[n]>e[n]){r=1;break}}if(!i)return r;switch(i){case">":case"gt":return r>0;case">=":case"ge":return r>=0;case"<=":case"le":return 0>=r;case"==":case"=":case"eq":return 0===r;case"<>":case"!=":case"ne":return 0!==r;case"":case"<":case"lt":return 0>r;default:return null}}var i=function(t){var e="",i="?",n="function",o="undefined",r="object",a="major",s="name",c="version",l={has:function(t,e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()}},u={rgx:function(){for(var e,i,a,s,c,l,u,d=0,p=arguments;d<p.length;d+=2){var h=p[d],f=p[d+1];if(typeof e===o){e={};for(s in f)c=f[s],typeof c===r?e[c[0]]=t:e[c]=t}for(i=a=0;i<h.length;i++)if(l=h[i].exec(this.getUA())){for(s=0;s<f.length;s++)u=l[++a],c=f[s],typeof c===r&&c.length>0?2==c.length?e[c[0]]=typeof c[1]==n?c[1].call(this,u):c[1]:3==c.length?e[c[0]]=typeof c[1]!==n||c[1].exec&&c[1].test?u?u.replace(c[1],c[2]):t:u?c[1].call(this,u,c[2]):t:4==c.length&&(e[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):t):e[c]=u?u:t;break}if(l)break}return e},str:function(e,n){for(var o in n)if(typeof n[o]===r&&n[o].length>0){for(var a=0;a<n[o].length;a++)if(l.has(n[o][a],e))return o===i?t:o}else if(l.has(n[o],e))return o===i?t:o;return e}},d={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},p={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,c,a],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],c,a],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,c,a],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],c,a],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],c,a],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],c,a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,c,a],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],c,a],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],c,a],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],c,a],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[c,a,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[c,a,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[a,u.str,d.browser.oldsafari.major],[c,u.str,d.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,c,a],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],c,a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,c,a]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]+).*(gecko)/i],[c,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[c,u.str,d.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[c,u.str,d.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],c],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,c],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[c,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[c,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,c]]},h=function(t){var i=t||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:e);this.getBrowser=function(){return u.rgx.apply(this,p.browser)},this.getEngine=function(){return u.rgx.apply(this,p.engine)},this.getOS=function(){return u.rgx.apply(this,p.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return i},this.setUA=function(t){return i=t,this},this.setUA(i)};return(new h).getResult();
}(),n=function(){var e={define_property:function(){return!1}(),create_canvas:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}(),return_response_type:function(e){try{if(-1!==t.inArray(e,["","text","document"]))return!0;if(window.XMLHttpRequest){var i=new XMLHttpRequest;if(i.open("get","/"),"responseType"in i)return i.responseType=e,i.responseType===e}}catch(n){}return!1},use_data_uri:function(){var t=new Image;return t.onload=function(){e.use_data_uri=1===t.width&&1===t.height},setTimeout(function(){t.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return e.use_data_uri&&("IE"!==o.browser||o.version>=9)},use_data_uri_of:function(t){return e.use_data_uri&&33e3>t||e.use_data_uri_over32kb()},use_fileinput:function(){var t=document.createElement("input");return t.setAttribute("type","file"),!t.disabled}};return function(i){var n=[].slice.call(arguments);return n.shift(),"function"===t.typeOf(e[i])?e[i].apply(this,n):!!e[i]}}(),o={can:n,browser:i.browser.name,version:parseFloat(i.browser.major),os:i.os.name,osVersion:i.os.version,verComp:e,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return o.OS=o.os,o}),n(d,[u],function(t){var e=function(t){return"string"!=typeof t?t:document.getElementById(t)},i=function(t,e){if(!t.className)return!1;var i=new RegExp("(^|\\s+)"+e+"(\\s+|$)");return i.test(t.className)},n=function(t,e){i(t,e)||(t.className=t.className?t.className.replace(/\s+$/,"")+" "+e:e)},o=function(t,e){if(t.className){var i=new RegExp("(^|\\s+)"+e+"(\\s+|$)");t.className=t.className.replace(i,function(t,e,i){return" "===e&&" "===i?" ":""})}},r=function(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(t,null)[e]:void 0},a=function(e,i){function n(t){var e,i,n=0,o=0;return t&&(i=t.getBoundingClientRect(),e="CSS1Compat"===l.compatMode?l.documentElement:l.body,n=i.left+e.scrollLeft,o=i.top+e.scrollTop),{x:n,y:o}}var o,r,a,s=0,c=0,l=document;if(e=e,i=i||l.body,e&&e.getBoundingClientRect&&"IE"===t.browser&&(!l.documentMode||l.documentMode<8))return r=n(e),a=n(i),{x:r.x-a.x,y:r.y-a.y};for(o=e;o&&o!=i&&o.nodeType;)s+=o.offsetLeft||0,c+=o.offsetTop||0,o=o.offsetParent;for(o=e.parentNode;o&&o!=i&&o.nodeType;)s-=o.scrollLeft||0,c-=o.scrollTop||0,o=o.parentNode;return{x:s,y:c}},s=function(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:e,hasClass:i,addClass:n,removeClass:o,getStyle:r,getPos:a,getSize:s}}),n(p,[s],function(t){function e(t,e){var i;for(i in t)if(t[i]===e)return i;return null}return{RuntimeError:function(){function i(t){this.code=t,this.name=e(n,t),this.message=this.name+": RuntimeError "+this.code}var n={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return t.extend(i,n),i.prototype=Error.prototype,i}(),OperationNotAllowedException:function(){function e(t){this.code=t,this.name="OperationNotAllowedException"}return t.extend(e,{NOT_ALLOWED_ERR:1}),e.prototype=Error.prototype,e}(),ImageError:function(){function i(t){this.code=t,this.name=e(n,t),this.message=this.name+": ImageError "+this.code}var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return t.extend(i,n),i.prototype=Error.prototype,i}(),FileException:function(){function i(t){this.code=t,this.name=e(n,t),this.message=this.name+": FileException "+this.code}var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return t.extend(i,n),i.prototype=Error.prototype,i}(),DOMException:function(){function i(t){this.code=t,this.name=e(n,t),this.message=this.name+": DOMException "+this.code}var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return t.extend(i,n),i.prototype=Error.prototype,i}(),EventException:function(){function e(t){this.code=t,this.name="EventException"}return t.extend(e,{UNSPECIFIED_EVENT_TYPE_ERR:0}),e.prototype=Error.prototype,e}()}}),n(h,[p,s],function(t,e){function i(){var i={};e.extend(this,{uid:null,init:function(){this.uid||(this.uid=e.guid("uid_"))},addEventListener:function(t,n,o,r){var a,s=this;return t=e.trim(t),/\s/.test(t)?void e.each(t.split(/\s+/),function(t){s.addEventListener(t,n,o,r)}):(t=t.toLowerCase(),o=parseInt(o,10)||0,a=i[this.uid]&&i[this.uid][t]||[],a.push({fn:n,priority:o,scope:r||this}),i[this.uid]||(i[this.uid]={}),void(i[this.uid][t]=a))},hasEventListener:function(t){return t?!(!i[this.uid]||!i[this.uid][t]):!!i[this.uid]},removeEventListener:function(t,n){t=t.toLowerCase();var o,r=i[this.uid]&&i[this.uid][t];if(r){if(n){for(o=r.length-1;o>=0;o--)if(r[o].fn===n){r.splice(o,1);break}}else r=[];r.length||(delete i[this.uid][t],e.isEmptyObj(i[this.uid])&&delete i[this.uid])}},removeAllEventListeners:function(){i[this.uid]&&delete i[this.uid]},dispatchEvent:function(n){var o,r,a,s,c,l={},u=!0;if("string"!==e.typeOf(n)){if(s=n,"string"!==e.typeOf(s.type))throw new t.EventException(t.EventException.UNSPECIFIED_EVENT_TYPE_ERR);n=s.type,s.total!==c&&s.loaded!==c&&(l.total=s.total,l.loaded=s.loaded),l.async=s.async||!1}if(-1!==n.indexOf("::")?function(t){o=t[0],n=t[1]}(n.split("::")):o=this.uid,n=n.toLowerCase(),r=i[o]&&i[o][n]){r.sort(function(t,e){return e.priority-t.priority}),a=[].slice.call(arguments),a.shift(),l.type=n,a.unshift(l);var d=[];e.each(r,function(t){a[0].target=t.scope,l.async?d.push(function(e){setTimeout(function(){e(t.fn.apply(t.scope,a)===!1)},1)}):d.push(function(e){e(t.fn.apply(t.scope,a)===!1)})}),d.length&&e.inSeries(d,function(t){u=!t})}return u},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(t){var i;"array"!==e.typeOf(t)&&(t=[t]);for(var n=0;n<t.length;n++)i="on"+t[n],"function"===e.typeOf(this[i])?this.addEventListener(t[n],this[i]):"undefined"===e.typeOf(this[i])&&(this[i]=null)}})}return i.instance=new i,i}),n(f,[],function(){var t=function(t){return unescape(encodeURIComponent(t))},e=function(t){return decodeURIComponent(escape(t))},i=function(t,i){if("function"==typeof window.atob)return i?e(window.atob(t)):window.atob(t);var n,o,r,a,s,c,l,u,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!t)return t;t+="";do a=d.indexOf(t.charAt(p++)),s=d.indexOf(t.charAt(p++)),c=d.indexOf(t.charAt(p++)),l=d.indexOf(t.charAt(p++)),u=a<<18|s<<12|c<<6|l,n=255&u>>16,o=255&u>>8,r=255&u,m[h++]=64==c?String.fromCharCode(n):64==l?String.fromCharCode(n,o):String.fromCharCode(n,o,r);while(p<t.length);return f=m.join(""),i?e(f):f},n=function(e,i){if(i&&t(e),"function"==typeof window.btoa)return window.btoa(e);var n,o,r,a,s,c,l,u,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,h=0,f="",m=[];if(!e)return e;do n=e.charCodeAt(p++),o=e.charCodeAt(p++),r=e.charCodeAt(p++),u=n<<16|o<<8|r,a=63&u>>18,s=63&u>>12,c=63&u>>6,l=63&u,m[h++]=d.charAt(a)+d.charAt(s)+d.charAt(c)+d.charAt(l);while(p<e.length);f=m.join("");var g=e.length%3;return(g?f.slice(0,g-3):f)+"===".slice(g||3)};return{utf8_encode:t,utf8_decode:e,atob:i,btoa:n}}),n(m,[s,d,h],function(t,e,i){function n(i,o,a,s,c){var l,u=this,d=t.guid(o+"_"),p=c||"browser";i=i||{},r[d]=this,a=t.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},a),i.preferred_caps&&(p=n.getMode(s,i.preferred_caps,p)),l=function(){var e={};return{exec:function(t,i,n,o){return l[i]&&(e[t]||(e[t]={context:this,instance:new l[i]}),e[t].instance[n])?e[t].instance[n].apply(this,o):void 0},removeInstance:function(t){delete e[t]},removeAllInstances:function(){var i=this;t.each(e,function(e,n){"function"===t.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context),i.removeInstance(n)})}}}(),t.extend(this,{initialized:!1,uid:d,type:o,mode:n.getMode(s,i.required_caps,p),shimid:d+"_container",clients:0,options:i,can:function(e,i){var o=arguments[2]||a;if("string"===t.typeOf(e)&&"undefined"===t.typeOf(i)&&(e=n.parseCaps(e)),"object"===t.typeOf(e)){for(var r in e)if(!this.can(r,e[r],o))return!1;return!0}return"function"===t.typeOf(o[e])?o[e].call(this,i):i===o[e]},getShimContainer:function(){var i,n=e.get(this.shimid);return n||(i=this.options.container?e.get(this.options.container):document.body,n=document.createElement("div"),n.id=this.shimid,n.className="moxie-shim moxie-shim-"+this.type,t.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),i.appendChild(n),i=null),n},getShim:function(){return l},shimExec:function(t,e){var i=[].slice.call(arguments,2);return u.getShim().exec.call(this,this.uid,t,e,i)},exec:function(t,e){var i=[].slice.call(arguments,2);return u[t]&&u[t][e]?u[t][e].apply(this,i):u.shimExec.apply(this,arguments)},destroy:function(){if(u){var t=e.get(this.shimid);t&&t.parentNode.removeChild(t),l&&l.removeAllInstances(),this.unbindAll(),delete r[this.uid],this.uid=null,d=u=l=t=null}}}),this.mode&&i.required_caps&&!this.can(i.required_caps)&&(this.mode=!1)}var o={},r={};return n.order="html5,flash,silverlight,html4",n.getRuntime=function(t){return!!r[t]&&r[t]},n.addConstructor=function(t,e){e.prototype=i.instance,o[t]=e},n.getConstructor=function(t){return o[t]||null},n.getInfo=function(t){var e=n.getRuntime(t);return e?{uid:e.uid,type:e.type,mode:e.mode,can:function(){return e.can.apply(e,arguments)}}:null},n.parseCaps=function(e){var i={};return"string"!==t.typeOf(e)?e||{}:(t.each(e.split(","),function(t){i[t]=!0}),i)},n.can=function(t,e){var i,o,r=n.getConstructor(t);return!!r&&(i=new r({required_caps:e}),o=i.mode,i.destroy(),!!o)},n.thatCan=function(t,e){var i=(e||n.order).split(/\s*,\s*/);for(var o in i)if(n.can(i[o],t))return i[o];return null},n.getMode=function(e,i,n){var o=null;if("undefined"===t.typeOf(n)&&(n="browser"),i&&!t.isEmptyObj(e)){if(t.each(i,function(i,n){if(e.hasOwnProperty(n)){var r=e[n](i);if("string"==typeof r&&(r=[r]),o){if(!(o=t.arrayIntersect(o,r)))return o=!1}else o=r}}),o)return-1!==t.inArray(n,o)?n:o[0];if(o===!1)return!1}return n},n.capTrue=function(){return!0},n.capFalse=function(){return!1},n.capTest=function(t){return function(){return!!t}},n}),n(g,[p,s,m],function(t,e,i){return function n(){var n;e.extend(this,{connectRuntime:function(o){function r(e){var a,c;return e.length?(a=e.shift(),(c=i.getConstructor(a))?(n=new c(o),n.bind("Init",function(){n.initialized=!0,setTimeout(function(){n.clients++,s.trigger("RuntimeInit",n)},1)}),n.bind("Error",function(){n.destroy(),r(e)}),n.mode?void n.init():void n.trigger("Error")):void r(e)):(s.trigger("RuntimeError",new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)),void(n=null))}var a,s=this;if("string"===e.typeOf(o)?a=o:"string"===e.typeOf(o.ruid)&&(a=o.ruid),a){if(n=i.getRuntime(a))return n.clients++,n;throw new t.RuntimeError(t.RuntimeError.NOT_INIT_ERR)}r((o.runtime_order||i.order).split(/\s*,\s*/))},getRuntime:function(){return n&&n.uid?n:(n=null,null)},disconnectRuntime:function(){n&&--n.clients<=0&&(n.destroy(),n=null)}})}}),n(v,[s,f,g],function(t,e,i){function n(r,a){function s(e,i,r){var a,s=o[this.uid];return"string"===t.typeOf(s)&&s.length?(a=new n(null,{type:r,size:i-e}),a.detach(s.substr(e,a.size)),a):null}i.call(this),r&&this.connectRuntime(r),a?"string"===t.typeOf(a)&&(a={data:a}):a={},t.extend(this,{uid:a.uid||t.guid("uid_"),ruid:r,size:a.size||0,type:a.type||"",slice:function(t,e,i){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,e,i)},getSource:function(){return o[this.uid]?o[this.uid]:null},detach:function(t){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",o[this.uid]),this.disconnectRuntime(),this.ruid=null),t=t||"";var i=t.match(/^data:([^;]*);base64,/);i&&(this.type=i[1],t=e.atob(t.substring(t.indexOf("base64,")+7))),this.size=t.length,o[this.uid]=t},isDetached:function(){return!this.ruid&&"string"===t.typeOf(o[this.uid])},destroy:function(){this.detach(),delete o[this.uid]}}),a.data?this.detach(a.data):o[this.uid]=a}var o={};return n}),n(_,[s,l,v],function(t,e,i){function n(n,o){var r,a;if(o||(o={}),a=o.type&&""!==o.type?o.type:e.getFileMime(o.name),o.name)r=o.name.replace(/\\/g,"/"),r=r.substr(r.lastIndexOf("/")+1);else{var s=a.split("/")[0];r=t.guid((""!==s?s:"file")+"_"),e.extensions[a]&&(r+="."+e.extensions[a][0])}i.apply(this,arguments),t.extend(this,{type:a||"",name:r||t.guid("file_"),lastModifiedDate:o.lastModifiedDate||(new Date).toLocaleString()})}return n.prototype=i.prototype,n}),n(y,[s,l,d,p,h,c,_,m,g],function(t,e,i,n,o,r,a,s,c){function l(o){var l,d,p,h=this;if(-1!==t.inArray(t.typeOf(o),["string","node"])&&(o={browse_button:o}),d=i.get(o.browse_button),!d)throw new n.DOMException(n.DOMException.NOT_FOUND_ERR);p={accept:[{title:r.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:d.parentNode||document.body},o=t.extend({},p,o),"string"==typeof o.required_caps&&(o.required_caps=s.parseCaps(o.required_caps)),"string"==typeof o.accept&&(o.accept=e.mimes2extList(o.accept)),l=i.get(o.container),l||(l=document.body),"static"===i.getStyle(l,"position")&&(l.style.position="relative"),l=d=null,c.call(h),t.extend(h,{uid:t.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){h.convertEventPropsToHandlers(u),h.bind("RuntimeInit",function(e,n){h.ruid=n.uid,h.shimid=n.shimid,h.bind("Ready",function(){h.trigger("Refresh")},999),h.bind("Change",function(){var e=n.exec.call(h,"FileInput","getFiles");h.files=[],t.each(e,function(t){return 0===t.size||void h.files.push(new a(h.ruid,t))})},999),h.bind("Refresh",function(){var e,r,a,s;a=i.get(o.browse_button),s=i.get(n.shimid),a&&(e=i.getPos(a,i.get(o.container)),r=i.getSize(a),s&&t.extend(s.style,{top:e.y+"px",left:e.x+"px",width:r.w+"px",height:r.h+"px"})),s=a=null}),n.exec.call(h,"FileInput","init",o)}),h.connectRuntime(t.extend({},o,{required_caps:{select_file:!0}}))},disable:function(e){var i=this.getRuntime();i&&i.exec.call(this,"FileInput","disable","undefined"===t.typeOf(e)||e)},refresh:function(){h.trigger("Refresh")},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===t.typeOf(this.files)&&t.each(this.files,function(t){t.destroy()}),this.files=null}})}var u=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return l.prototype=o.instance,l}),n(b,[c,d,p,s,_,g,h,l],function(t,e,i,n,o,r,a,s){function c(i){var a,c=this;"string"==typeof i&&(i={drop_zone:i}),a={accept:[{title:t.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i="object"==typeof i?n.extend({},a,i):a,i.container=e.get(i.drop_zone)||document.body,"static"===e.getStyle(i.container,"position")&&(i.container.style.position="relative"),"string"==typeof i.accept&&(i.accept=s.mimes2extList(i.accept)),r.call(c),n.extend(c,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){c.convertEventPropsToHandlers(l),c.bind("RuntimeInit",function(t,e){c.ruid=e.uid,c.bind("Drop",function(){var t=e.exec.call(c,"FileDrop","getFiles");c.files=[],n.each(t,function(t){c.files.push(new o(c.ruid,t))})},999),e.exec.call(c,"FileDrop","init",i),c.dispatchEvent("ready")}),c.connectRuntime(i)},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var l=["ready","dragenter","dragleave","drop","error"];return c.prototype=a.instance,c}),n(x,[s,g,h],function(t,e,i){function n(){this.uid=t.guid("uid_"),e.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return n.prototype=i.instance,n}),n(w,[s,f,p,h,v,_,x],function(t,e,i,n,o,r,a){function s(){function n(t,n){function u(t){l.readyState=s.DONE,l.error=t,l.trigger("error"),d()}function d(){r.destroy(),r=null,l.trigger("loadend")}function p(e){r.bind("Error",function(t,e){u(e)}),r.bind("Progress",function(t){l.result=e.exec.call(r,"FileReader","getResult"),l.trigger(t)}),r.bind("Load",function(t){l.readyState=s.DONE,l.result=e.exec.call(r,"FileReader","getResult"),l.trigger(t),d()}),e.exec.call(r,"FileReader","read",t,n)}if(r=new a,this.convertEventPropsToHandlers(c),this.readyState===s.LOADING)return u(new i.DOMException(i.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),n instanceof o)if(n.isDetached()){var h=n.getSource();switch(t){case"readAsText":case"readAsBinaryString":this.result=h;break;case"readAsDataURL":this.result="data:"+n.type+";base64,"+e.btoa(h)}this.readyState=s.DONE,this.trigger("load"),d()}else p(r.connectRuntime(n.ruid));else u(new i.DOMException(i.DOMException.NOT_FOUND_ERR))}var r,l=this;t.extend(this,{uid:t.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(t){n.call(this,"readAsBinaryString",t)},readAsDataURL:function(t){n.call(this,"readAsDataURL",t)},readAsText:function(t){n.call(this,"readAsText",t)},abort:function(){this.result=null,-1===t.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),r&&r.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),r&&(r.getRuntime().exec.call(this,"FileReader","destroy"),r.disconnectRuntime()),l=r=null}})}var c=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=n.instance,s}),n(k,[],function(){var t=function(e,i){for(var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=n.length,r={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,c=s.exec(e||"");o--;)c[o]&&(a[n[o]]=c[o]);if(!a.scheme){i&&"string"!=typeof i||(i=t(i||document.location.href)),a.scheme=i.scheme,a.host=i.host,a.port=i.port;var l="";/^[^\/]/.test(a.path)&&(l=i.path,/(\/|\/[^\.]+)$/.test(l)?l+="/":l=l.replace(/\/[^\/]+$/,"/")),a.path=l+(a.path||"")}return a.port||(a.port=r[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},e=function(e){var i={http:80,https:443},n=t(e);return n.scheme+"://"+n.host+(n.port!==i[n.scheme]?":"+n.port:"")+n.path+(n.query?n.query:"")},i=function(e){function i(t){return[t.scheme,t.host,t.port].join("/")}return"string"==typeof e&&(e=t(e)),i(t())===i(e)};return{parseUrl:t,resolveUrl:e,hasSameOrigin:i}}),n(D,[s,g,f],function(t,e,i){return function(){function n(t,e){if(!e.isDetached()){var n=this.connectRuntime(e.ruid).exec.call(this,"FileReaderSync","read",t,e);return this.disconnectRuntime(),n}var o=e.getSource();switch(t){case"readAsBinaryString":return o;case"readAsDataURL":return"data:"+e.type+";base64,"+i.btoa(o);case"readAsText":for(var r="",a=0,s=o.length;s>a;a++)r+=String.fromCharCode(o[a]);return r}}e.call(this),t.extend(this,{uid:t.guid("uid_"),readAsBinaryString:function(t){return n.call(this,"readAsBinaryString",t)},readAsDataURL:function(t){return n.call(this,"readAsDataURL",t)},readAsText:function(t){return n.call(this,"readAsText",t)}})}}),n(E,[p,s,v],function(t,e,i){function n(){var t,n=[];e.extend(this,{append:function(o,r){var a=this,s=e.typeOf(r);r instanceof i?t={name:o,value:r}:"array"===s?(o+="[]",e.each(r,function(t){a.append(o,t)})):"object"===s?e.each(r,function(t,e){a.append(o+"["+e+"]",t)}):"null"===s||"undefined"===s||"number"===s&&isNaN(r)?a.append(o,"false"):n.push({name:o,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return t&&t.value||null},getBlobName:function(){return t&&t.name||null},each:function(i){e.each(n,function(t){i(t.value,t.name)}),t&&i(t.value,t.name)},destroy:function(){t=null,n=[]}})}return n}),n(C,[s,p,h,f,k,m,x,v,D,E,u,l],function(t,e,i,n,o,r,a,s,c,l,u,d){function p(){this.uid=t.guid("uid_")}function h(){function i(t,e){return C.hasOwnProperty(t)?1===arguments.length?u.can("define_property")?C[t]:E[t]:void(u.can("define_property")?C[t]=e:E[t]=e):void 0}function c(e){function n(){k.destroy(),k=null,s.dispatchEvent("loadend"),s=null}function o(o){k.bind("LoadStart",function(t){i("readyState",h.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(t),j&&s.upload.dispatchEvent(t)}),k.bind("Progress",function(t){i("readyState")!==h.LOADING&&(i("readyState",h.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(t)}),k.bind("UploadProgress",function(t){j&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:t.total,loaded:t.loaded})}),k.bind("Load",function(e){i("readyState",h.DONE),i("status",Number(o.exec.call(k,"XMLHttpRequest","getStatus")||0)),i("statusText",f[i("status")]||""),i("response",o.exec.call(k,"XMLHttpRequest","getResponse",i("responseType"))),~t.inArray(i("responseType"),["text",""])?i("responseText",i("response")):"document"===i("responseType")&&i("responseXML",i("response")),F=o.exec.call(k,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),i("status")>0?(j&&s.upload.dispatchEvent(e),s.dispatchEvent(e)):(O=!0,s.dispatchEvent("error")),n()}),k.bind("Abort",function(t){s.dispatchEvent(t),n()}),k.bind("Error",function(t){O=!0,i("readyState",h.DONE),s.dispatchEvent("readystatechange"),q=!0,s.dispatchEvent(t),n()}),o.exec.call(k,"XMLHttpRequest","send",{url:v,method:_,async:T,user:y,password:b,headers:A,mimeType:$,encoding:S,responseType:s.responseType,withCredentials:s.withCredentials,options:P},e)}var s=this;x=(new Date).getTime(),k=new a,"string"==typeof P.required_caps&&(P.required_caps=r.parseCaps(P.required_caps)),P.required_caps=t.extend({},P.required_caps,{return_response_type:s.responseType}),e instanceof l&&(P.required_caps.send_multipart=!0),M||(P.required_caps.do_cors=!0),P.ruid?o(k.connectRuntime(P)):(k.bind("RuntimeInit",function(t,e){o(e)}),k.bind("RuntimeError",function(t,e){s.dispatchEvent("RuntimeError",e)}),k.connectRuntime(P))}function g(){i("responseText",""),i("responseXML",null),i("response",null),i("status",0),i("statusText",""),x=w=null}var v,_,y,b,x,w,k,D,E=this,C={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},T=!0,A={},S=null,$=null,R=!1,I=!1,j=!1,q=!1,O=!1,M=!1,L=null,N=null,P={},F="";t.extend(this,C,{uid:t.guid("uid_"),upload:new p,open:function(r,a,s,c,l){var u;if(!r||!a)throw new e.DOMException(e.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(r)||n.utf8_encode(r)!==r)throw new e.DOMException(e.DOMException.SYNTAX_ERR);if(~t.inArray(r.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(_=r.toUpperCase()),~t.inArray(_,["CONNECT","TRACE","TRACK"]))throw new e.DOMException(e.DOMException.SECURITY_ERR);if(a=n.utf8_encode(a),u=o.parseUrl(a),M=o.hasSameOrigin(u),v=o.resolveUrl(a),(c||l)&&!M)throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);if(y=c||u.user,b=l||u.pass,T=s||!0,T===!1&&(i("timeout")||i("withCredentials")||""!==i("responseType")))throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);R=!T,I=!1,A={},g.call(this),i("readyState",h.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(o,r){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(i("readyState")!==h.OPENED||I)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(o)||n.utf8_encode(o)!==o)throw new e.DOMException(e.DOMException.SYNTAX_ERR);return o=t.trim(o).toLowerCase(),!~t.inArray(o,a)&&!/^(proxy\-|sec\-)/.test(o)&&(A[o]?A[o]+=", "+r:A[o]=r,!0)},getAllResponseHeaders:function(){return F||""},getResponseHeader:function(e){return e=e.toLowerCase(),O||~t.inArray(e,["set-cookie","set-cookie2"])?null:F&&""!==F&&(D||(D={},t.each(F.split(/\r\n/),function(e){var i=e.split(/:\s+/);2===i.length&&(i[0]=t.trim(i[0]),D[i[0].toLowerCase()]={header:i[0],value:t.trim(i[1])})})),D.hasOwnProperty(e))?D[e].header+": "+D[e].value:null},overrideMimeType:function(n){var o,r;if(~t.inArray(i("readyState"),[h.LOADING,h.DONE]))throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(n=t.trim(n.toLowerCase()),/;/.test(n)&&(o=n.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(n=o[1],o[2]&&(r=o[2])),!d.mimes[n])throw new e.DOMException(e.DOMException.SYNTAX_ERR);L=n,N=r},send:function(i,o){if(P="string"===t.typeOf(o)?{ruid:o}:o?o:{},this.convertEventPropsToHandlers(m),this.upload.convertEventPropsToHandlers(m),this.readyState!==h.OPENED||I)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(i instanceof s)P.ruid=i.ruid,$=i.type||"application/octet-stream";else if(i instanceof l){if(i.hasBlob()){var r=i.getBlob();P.ruid=r.ruid,$=r.type||"application/octet-stream"}}else"string"==typeof i&&(S="UTF-8",$="text/plain;charset=UTF-8",i=n.utf8_encode(i));this.withCredentials||(this.withCredentials=P.required_caps&&P.required_caps.send_browser_cookies&&!M),j=!R&&this.upload.hasEventListener(),O=!1,q=!i,R||(I=!0),c.call(this,i)},abort:function(){if(O=!0,R=!1,~t.inArray(i("readyState"),[h.UNSENT,h.OPENED,h.DONE]))i("readyState",h.UNSENT);else{if(i("readyState",h.DONE),I=!1,!k)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);k.getRuntime().exec.call(k,"XMLHttpRequest","abort",q),q=!0}},destroy:function(){k&&("function"===t.typeOf(k.destroy)&&k.destroy(),k=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var f={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=i.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return h.UNSENT=0,h.OPENED=1,h.HEADERS_RECEIVED=2,h.LOADING=3,h.DONE=4,h.prototype=i.instance,h}),n(T,[s,f,g,h],function(t,e,i,n){function o(){function n(){u=d=0,l=this.result=null}function r(e,i){var n=this;c=i,n.bind("TransportingProgress",function(e){d=e.loaded,u>d&&-1===t.inArray(n.state,[o.IDLE,o.DONE])&&a.call(n)},999),n.bind("TransportingComplete",function(){d=u,n.state=o.DONE,l=null,n.result=c.exec.call(n,"Transporter","getAsBlob",e||"")},999),n.state=o.BUSY,n.trigger("TransportingStarted"),a.call(n)}function a(){var t,i=this,n=u-d;p>n&&(p=n),t=e.btoa(l.substr(d,p)),c.exec.call(i,"Transporter","receive",t,u)}var s,c,l,u,d,p;i.call(this),t.extend(this,{uid:t.guid("uid_"),state:o.IDLE,result:null,transport:function(e,i,o){var a=this;if(o=t.extend({chunk_size:204798},o),(s=o.chunk_size%3)&&(o.chunk_size+=3-s),p=o.chunk_size,n.call(this),l=e,u=e.length,"string"===t.typeOf(o)||o.ruid)r.call(a,i,this.connectRuntime(o));else{var c=function(t,e){a.unbind("RuntimeInit",c),r.call(a,i,e)};this.bind("RuntimeInit",c),this.connectRuntime(o)}},abort:function(){var t=this;t.state=o.IDLE,c&&(c.exec.call(t,"Transporter","clear"),t.trigger("TransportingAborted")),n.call(t)},destroy:function(){this.unbindAll(),c=null,this.disconnectRuntime(),n.call(this)}})}return o.IDLE=0,o.BUSY=1,o.DONE=2,o.prototype=n.instance,o}),n(A,[s,d,p,D,C,m,g,T,u,h,v,_,f],function(t,e,i,n,o,r,a,s,c,l,u,d,p){function h(){function n(t){t||(t=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=t.size,this.width=t.width,this.height=t.height,this.type=t.type,this.meta=t.meta,""===this.name&&(this.name=t.name)}function l(e){var n=t.typeOf(e);try{if(e instanceof h){if(!e.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(e instanceof u){if(!~t.inArray(e.type,["image/jpeg","image/png"]))throw new i.ImageError(i.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(-1!==t.inArray(n,["blob","file"]))l.call(this,new d(null,e),arguments[1]);else if("string"===n)/^data:[^;]*;base64,/.test(e)?l.call(this,new u(null,{data:e}),arguments[1]):v.apply(this,arguments);else{if("node"!==n||"img"!==e.nodeName.toLowerCase())throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);l.call(this,e.src,arguments[1])}}catch(o){this.trigger("error",o)}}function m(e,i){var n=this.connectRuntime(e.ruid);this.ruid=n.uid,n.exec.call(this,"Image","loadFromImage",e,"undefined"===t.typeOf(i)||i)}function g(e,i){function n(t){o.ruid=t.uid,t.exec.call(o,"Image","loadFromBlob",e)}var o=this;o.name=e.name||"",e.isDetached()?(this.bind("RuntimeInit",function(t,e){n(e)}),i&&"string"==typeof i.required_caps&&(i.required_caps=r.parseCaps(i.required_caps)),this.connectRuntime(t.extend({required_caps:{access_image_binary:!0,resize_image:!0}},i))):n(this.connectRuntime(e.ruid))}function v(t,e){var i,n=this;i=new o,i.open("get",t),i.responseType="blob",i.onprogress=function(t){n.trigger(t)},i.onload=function(){g.call(n,i.response,!0)},i.onerror=function(t){n.trigger(t)},i.onloadend=function(){i.destroy()},i.bind("RuntimeError",function(t,e){n.trigger("RuntimeError",e)}),i.send(null,e)}a.call(this),t.extend(this,{uid:t.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){n.call(this)},999),this.convertEventPropsToHandlers(f),l.apply(this,arguments)},downsize:function(e,n,o,r){try{if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);(!e&&!n||"undefined"===t.typeOf(o))&&(o=!1),e=e||this.width,n=n||this.height,r="undefined"===t.typeOf(r)||!!r,this.getRuntime().exec.call(this,"Image","downsize",e,n,o,r)}catch(a){this.trigger("error",a)}},crop:function(t,e,i){this.downsize(t,e,!0,i)},getAsCanvas:function(){if(!c.can("create_canvas"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);var t=this.connectRuntime(this.ruid);return t.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(t,e){
if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return t||(t="image/jpeg"),"image/jpeg"!==t||e||(e=90),this.getRuntime().exec.call(this,"Image","getAsBlob",t,e)},getAsDataURL:function(t,e){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",t,e)},getAsBinaryString:function(t,e){var i=this.getAsDataURL(t,e);return p.atob(i.substring(i.indexOf("base64,")+7))},embed:function(n){function o(){if(c.can("create_canvas")){var e=r.getAsCanvas();if(e)return n.appendChild(e),e=null,r.destroy(),void f.trigger("embedded")}var o=r.getAsDataURL(a,l);if(!o)throw new i.ImageError(i.ImageError.WRONG_FORMAT);if(c.can("use_data_uri_of",o.length))n.innerHTML='<img src="'+o+'" width="'+r.width+'" height="'+r.height+'" />',r.destroy(),f.trigger("embedded");else{var u=new s;u.bind("TransportingComplete",function(){d=f.connectRuntime(this.result.ruid),f.bind("Embedded",function(){t.extend(d.getShimContainer().style,{top:"0px",left:"0px",width:r.width+"px",height:r.height+"px"}),d=null},999),d.exec.call(f,"ImageView","display",this.result.uid,g,v),r.destroy()}),u.transport(p.atob(o.substring(o.indexOf("base64,")+7)),a,t.extend({},m,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:n}))}}var r,a,l,u,d,f=this,m=arguments[1]||{},g=this.width,v=this.height;try{if(!(n=e.get(n)))throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>h.MAX_RESIZE_WIDTH||this.height>h.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);if(a=m.type||this.type||"image/jpeg",l=m.quality||90,u="undefined"!==t.typeOf(m.crop)&&m.crop,m.width)g=m.width,v=m.height||g;else{var _=e.getSize(n);_.w&&_.h&&(g=_.w,v=_.h)}return r=new h,r.bind("Resize",function(){o.call(f)}),r.bind("Load",function(){r.downsize(g,v,u,!1)}),r.clone(this,!1),r}catch(y){this.trigger("error",y)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var f=["progress","load","error","resize","embedded"];return h.MAX_RESIZE_WIDTH=6500,h.MAX_RESIZE_HEIGHT=6500,h.prototype=l.instance,h}),n(S,[s,p,m,u],function(t,e,i,n){function o(e){var o=this,s=i.capTest,c=i.capTrue,l=t.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return o.can("access_binary")&&!!a.Image},display_media:s(n.can("create_canvas")||n.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var t=document.createElement("div");return("draggable"in t||"ondragstart"in t&&"ondrop"in t)&&("IE"!==n.browser||n.version>9)}()),filter_by_extension:s(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),return_response_headers:c,return_response_type:function(t){return!("json"!==t||!window.JSON)||n.can("return_response_type",t)},return_status_code:c,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return o.can("access_binary")&&n.can("create_canvas")},select_file:function(){return n.can("use_fileinput")&&window.File},select_folder:function(){return o.can("select_file")&&"Chrome"===n.browser&&n.version>=21},select_multiple:function(){return!(!o.can("select_file")||"Safari"===n.browser&&"Windows"===n.os||"iOS"===n.os&&n.verComp(n.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||o.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return o.can("slice_blob")&&o.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||"IE"===n.browser&&n.version>=10||!!~t.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:c},arguments[2]);i.call(this,e,arguments[1]||r,l),t.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(o),t=o=null}}(this.destroy)}),t.extend(this.getShim(),a)}var r="html5",a={};return i.addConstructor(r,o),a}),n($,[S,v],function(t,e){function i(){function t(t,e,i){var n;if(!window.File.prototype.slice)return(n=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?n.call(t,e,i):null;try{return t.slice(),t.slice(e,i)}catch(o){return t.slice(e,i-e)}}this.slice=function(){return new e(this.getRuntime().uid,t.apply(this,arguments))}}return t.Blob=i}),n(R,[s],function(t){function e(){this.returnValue=!1}function i(){this.cancelBubble=!0}var n={},o="moxie_"+t.guid(),r=function(r,a,s,c){var l,u;a=a.toLowerCase(),r.addEventListener?(l=s,r.addEventListener(a,l,!1)):r.attachEvent&&(l=function(){var t=window.event;t.target||(t.target=t.srcElement),t.preventDefault=e,t.stopPropagation=i,s(t)},r.attachEvent("on"+a,l)),r[o]||(r[o]=t.guid()),n.hasOwnProperty(r[o])||(n[r[o]]={}),u=n[r[o]],u.hasOwnProperty(a)||(u[a]=[]),u[a].push({func:l,orig:s,key:c})},a=function(e,i,r){var a,s;if(i=i.toLowerCase(),e[o]&&n[e[o]]&&n[e[o]][i]){a=n[e[o]][i];for(var c=a.length-1;c>=0&&(a[c].orig!==r&&a[c].key!==r||(e.removeEventListener?e.removeEventListener(i,a[c].func,!1):e.detachEvent&&e.detachEvent("on"+i,a[c].func),a[c].orig=null,a[c].func=null,a.splice(c,1),r===s));c--);if(a.length||delete n[e[o]][i],t.isEmptyObj(n[e[o]])){delete n[e[o]];try{delete e[o]}catch(l){e[o]=s}}}},s=function(e,i){e&&e[o]&&t.each(n[e[o]],function(t,n){a(e,n,i)})};return{addEvent:r,removeEvent:a,removeAllEvents:s}}),n(I,[S,s,d,R,l,u],function(t,e,i,n,o,r){function a(){var t,a=[];e.extend(this,{init:function(s){var c,l,u,d,p,h,f=this,m=f.getRuntime();t=s,a=[],u=t.accept.mimes||o.extList2mimes(t.accept,m.can("filter_by_extension")),l=m.getShimContainer(),l.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(t.multiple&&m.can("select_multiple")?"multiple":"")+(t.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(u?' accept="'+u.join(",")+'"':"")+" />",c=i.get(m.uid),e.extend(c.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=i.get(t.browse_button),m.can("summon_file_dialog")&&("static"===i.getStyle(d,"position")&&(d.style.position="relative"),p=parseInt(i.getStyle(d,"z-index"),10)||1,d.style.zIndex=p,l.style.zIndex=p-1,n.addEvent(d,"click",function(t){var e=i.get(m.uid);e&&!e.disabled&&e.click(),t.preventDefault()},f.uid)),h=m.can("summon_file_dialog")?d:l,n.addEvent(h,"mouseover",function(){f.trigger("mouseenter")},f.uid),n.addEvent(h,"mouseout",function(){f.trigger("mouseleave")},f.uid),n.addEvent(h,"mousedown",function(){f.trigger("mousedown")},f.uid),n.addEvent(i.get(t.container),"mouseup",function(){f.trigger("mouseup")},f.uid),c.onchange=function g(){if(a=[],t.directory?e.each(this.files,function(t){"."!==t.name&&a.push(t)}):a=[].slice.call(this.files),"IE"!==r.browser)this.value="";else{var i=this.cloneNode(!0);this.parentNode.replaceChild(i,this),i.onchange=g}f.trigger("change")},f.trigger({type:"ready",async:!0}),l=null},getFiles:function(){return a},disable:function(t){var e,n=this.getRuntime();(e=i.get(n.uid))&&(e.disabled=!!t)},destroy:function(){var e=this.getRuntime(),o=e.getShim(),r=e.getShimContainer();n.removeAllEvents(r,this.uid),n.removeAllEvents(t&&i.get(t.container),this.uid),n.removeAllEvents(t&&i.get(t.browse_button),this.uid),r&&(r.innerHTML=""),o.removeInstance(this.uid),a=t=r=o=null}})}return t.FileInput=a}),n(j,[S,s,d,R,l],function(t,e,i,n,o){function r(){function t(t){for(var i=[],n=0;n<t.length;n++)[].push.apply(i,t[n].extensions.split(/\s*,\s*/));return-1===e.inArray("*",i)?i:[]}function r(t){var i=o.getFileExtension(t.name);return!i||!p.length||-1!==e.inArray(i,p)}function a(t,i){var n=[];e.each(t,function(t){var e=t.webkitGetAsEntry();if(e)if(e.isFile){var i=t.getAsFile();r(i)&&d.push(i)}else n.push(e)}),n.length?s(n,i):i()}function s(t,i){var n=[];e.each(t,function(t){n.push(function(e){c(t,e)})}),e.inSeries(n,function(){i()})}function c(t,e){t.isFile?t.file(function(t){r(t)&&d.push(t),e()},function(){e()}):t.isDirectory?l(t,e):e()}function l(t,e){function i(t){o.readEntries(function(e){e.length?([].push.apply(n,e),i(t)):t()},t)}var n=[],o=t.createReader();i(function(){s(n,e)})}var u,d=[],p=[];e.extend(this,{init:function(i){var o,s=this;u=i,p=t(u.accept),o=u.container,n.addEvent(o,"dragover",function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="copy"},s.uid),n.addEvent(o,"drop",function(t){t.preventDefault(),t.stopPropagation(),d=[],t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry?a(t.dataTransfer.items,function(){s.trigger("drop")}):(e.each(t.dataTransfer.files,function(t){r(t)&&d.push(t)}),s.trigger("drop"))},s.uid),n.addEvent(o,"dragenter",function(t){t.preventDefault(),t.stopPropagation(),s.trigger("dragenter")},s.uid),n.addEvent(o,"dragleave",function(t){t.preventDefault(),t.stopPropagation(),s.trigger("dragleave")},s.uid)},getFiles:function(){return d},destroy:function(){n.removeAllEvents(u&&i.get(u.container),this.uid),d=p=u=null}})}return t.FileDrop=r}),n(q,[S,f,s],function(t,e,i){function n(){function t(t){return e.atob(t.substring(t.indexOf("base64,")+7))}var n,o=!1;i.extend(this,{read:function(t,e){var r=this;n=new window.FileReader,n.addEventListener("progress",function(t){r.trigger(t)}),n.addEventListener("load",function(t){r.trigger(t)}),n.addEventListener("error",function(t){r.trigger(t,n.error)}),n.addEventListener("loadend",function(){n=null}),"function"===i.typeOf(n[t])?(o=!1,n[t](e.getSource())):"readAsBinaryString"===t&&(o=!0,n.readAsDataURL(e.getSource()))},getResult:function(){return n&&n.result?o?t(n.result):n.result:null},abort:function(){n&&n.abort()},destroy:function(){n=null}})}return t.FileReader=n}),n(O,[S,s,l,k,_,v,E,p,u],function(t,e,i,n,o,r,a,s,c){function l(){function t(t,e){var i,n,o=this;i=e.getBlob().getSource(),n=new window.FileReader,n.onload=function(){e.append(e.getBlobName(),new r(null,{type:i.type,data:n.result})),f.send.call(o,t,e)},n.readAsBinaryString(i)}function l(){return!window.XMLHttpRequest||"IE"===c.browser&&c.version<8?function(){for(var t=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{return new ActiveXObject(t[e])}catch(i){}}():new window.XMLHttpRequest}function u(t){var e=t.responseXML,i=t.responseText;return"IE"===c.browser&&i&&e&&!e.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(t.getResponseHeader("Content-Type"))&&(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(i)),e&&("IE"===c.browser&&0!==e.parseError||!e.documentElement||"parsererror"===e.documentElement.tagName)?null:e}function d(t){var e="----moxieboundary"+(new Date).getTime(),i="--",n="\r\n",o="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return p.setRequestHeader("Content-Type","multipart/form-data; boundary="+e),t.each(function(t,a){o+=t instanceof r?i+e+n+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(t.name||"blob"))+'"'+n+"Content-Type: "+(t.type||"application/octet-stream")+n+n+t.getSource()+n:i+e+n+'Content-Disposition: form-data; name="'+a+'"'+n+n+unescape(encodeURIComponent(t))+n}),o+=i+e+i+n}var p,h,f=this;e.extend(this,{send:function(i,o){var s=this,u="Mozilla"===c.browser&&c.version>=4&&c.version<7,f="Android Browser"===c.browser,m=!1;if(h=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),p=l(),p.open(i.method,i.url,i.async,i.user,i.password),o instanceof r)o.isDetached()&&(m=!0),o=o.getSource();else if(o instanceof a){if(o.hasBlob())if(o.getBlob().isDetached())o=d.call(s,o),m=!0;else if((u||f)&&"blob"===e.typeOf(o.getBlob().getSource())&&window.FileReader)return void t.call(s,i,o);if(o instanceof a){var g=new window.FormData;o.each(function(t,e){t instanceof r?g.append(e,t.getSource()):g.append(e,t)}),o=g}}p.upload?(i.withCredentials&&(p.withCredentials=!0),p.addEventListener("load",function(t){s.trigger(t)}),p.addEventListener("error",function(t){s.trigger(t)}),p.addEventListener("progress",function(t){s.trigger(t)}),p.upload.addEventListener("progress",function(t){s.trigger({type:"UploadProgress",loaded:t.loaded,total:t.total})})):p.onreadystatechange=function(){switch(p.readyState){case 1:break;case 2:break;case 3:var t,e;try{n.hasSameOrigin(i.url)&&(t=p.getResponseHeader("Content-Length")||0),p.responseText&&(e=p.responseText.length)}catch(o){t=e=0}s.trigger({type:"progress",lengthComputable:!!t,total:parseInt(t,10),loaded:e});break;case 4:p.onreadystatechange=function(){},0===p.status?s.trigger("error"):s.trigger("load")}},e.isEmptyObj(i.headers)||e.each(i.headers,function(t,e){p.setRequestHeader(e,t)}),""!==i.responseType&&"responseType"in p&&(p.responseType="json"!==i.responseType||c.can("return_response_type","json")?i.responseType:"text"),m?p.sendAsBinary?p.sendAsBinary(o):function(){for(var t=new Uint8Array(o.length),e=0;e<o.length;e++)t[e]=255&o.charCodeAt(e);p.send(t.buffer)}():p.send(o),s.trigger("loadstart")},getStatus:function(){try{if(p)return p.status}catch(t){}return 0},getResponse:function(t){var e=this.getRuntime();try{switch(t){case"blob":var n=new o(e.uid,p.response),r=p.getResponseHeader("Content-Disposition");if(r){var a=r.match(/filename=([\'\"'])([^\1]+)\1/);a&&(h=a[2])}return n.name=h,n.type||(n.type=i.getFileMime(h)),n;case"json":return c.can("return_response_type","json")?p.response:200===p.status&&window.JSON?JSON.parse(p.responseText):null;case"document":return u(p);default:return""!==p.responseText?p.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return p.getAllResponseHeaders()}catch(t){}return""},abort:function(){p&&p.abort()},destroy:function(){f=h=null}})}return t.XMLHttpRequest=l}),n(M,[],function(){return function(){function t(t,e){var i,n=r?0:-8*(e-1),a=0;for(i=0;e>i;i++)a|=o.charCodeAt(t+i)<<Math.abs(n+8*i);return a}function i(t,e,i){i=3===arguments.length?i:o.length-e-1,o=o.substr(0,e)+t+o.substr(i+e)}function n(t,e,n){var o,a="",s=r?0:-8*(n-1);for(o=0;n>o;o++)a+=String.fromCharCode(255&e>>Math.abs(s+8*o));i(a,t,n)}var o,r=!1;return{II:function(t){return t===e?r:void(r=t)},init:function(t){r=!1,o=t},SEGMENT:function(t,e,n){switch(arguments.length){case 1:return o.substr(t,o.length-t-1);case 2:return o.substr(t,e);case 3:i(n,t,e);break;default:return o}},BYTE:function(e){return t(e,1)},SHORT:function(e){return t(e,2)},LONG:function(i,o){return o===e?t(i,4):void n(i,o,4)},SLONG:function(e){var i=t(e,4);return i>2147483647?i-4294967296:i},STRING:function(e,i){var n="";for(i+=e;i>e;e++)n+=String.fromCharCode(t(e,1));return n}}}}),n(L,[M],function(t){return function e(i){var n,o,r,a=[],s=0;if(n=new t,n.init(i),65496===n.SHORT(0)){for(o=2;o<=i.length;)if(r=n.SHORT(o),r>=65488&&65495>=r)o+=2;else{if(65498===r||65497===r)break;s=n.SHORT(o+2)+2,r>=65505&&65519>=r&&a.push({hex:r,name:"APP"+(15&r),start:o,length:s,segment:n.SEGMENT(o,s)}),o+=s}return n.init(null),{headers:a,restore:function(t){var e,i;for(n.init(t),o=65504==n.SHORT(2)?4+n.SHORT(4):2,i=0,e=a.length;e>i;i++)n.SEGMENT(o,0,a[i].segment),o+=a[i].length;return t=n.SEGMENT(),n.init(null),t},strip:function(t){var i,o,r;for(o=new e(t),i=o.headers,o.purge(),n.init(t),r=i.length;r--;)n.SEGMENT(i[r].start,i[r].length,"");return t=n.SEGMENT(),n.init(null),t},get:function(t){for(var e=[],i=0,n=a.length;n>i;i++)a[i].name===t.toUpperCase()&&e.push(a[i].segment);return e},set:function(t,e){var i,n,o,r=[];for("string"==typeof e?r.push(e):r=e,i=n=0,o=a.length;o>i&&(a[i].name===t.toUpperCase()&&(a[i].segment=r[n],a[i].length=r[n].length,n++),!(n>=r.length));i++);},purge:function(){a=[],n.init(null),n=null}}}}}),n(N,[s,M],function(t,i){return function n(){function n(t,i){var n,o,r,s,c,d,p,h,f=a.SHORT(t),m=[],g={};for(n=0;f>n;n++)if(p=d=t+12*n+2,r=i[a.SHORT(p)],r!==e){switch(s=a.SHORT(p+=2),c=a.LONG(p+=2),p+=4,m=[],s){case 1:case 7:for(c>4&&(p=a.LONG(p)+u.tiffHeader),o=0;c>o;o++)m[o]=a.BYTE(p+o);break;case 2:c>4&&(p=a.LONG(p)+u.tiffHeader),g[r]=a.STRING(p,c-1);continue;case 3:for(c>2&&(p=a.LONG(p)+u.tiffHeader),o=0;c>o;o++)m[o]=a.SHORT(p+2*o);break;case 4:for(c>1&&(p=a.LONG(p)+u.tiffHeader),o=0;c>o;o++)m[o]=a.LONG(p+4*o);break;case 5:for(p=a.LONG(p)+u.tiffHeader,o=0;c>o;o++)m[o]=a.LONG(p+4*o)/a.LONG(p+4*o+4);break;case 9:for(p=a.LONG(p)+u.tiffHeader,o=0;c>o;o++)m[o]=a.SLONG(p+4*o);break;case 10:for(p=a.LONG(p)+u.tiffHeader,o=0;c>o;o++)m[o]=a.SLONG(p+4*o)/a.SLONG(p+4*o+4);break;default:continue}h=1==c?m[0]:m,g[r]=l.hasOwnProperty(r)&&"object"!=typeof h?l[r][h]:h}return g}function o(){var t=u.tiffHeader;return a.II(18761==a.SHORT(t)),42===a.SHORT(t+=2)&&(u.IFD0=u.tiffHeader+a.LONG(t+=2),c=n(u.IFD0,s.tiff),"ExifIFDPointer"in c&&(u.exifIFD=u.tiffHeader+c.ExifIFDPointer,delete c.ExifIFDPointer),"GPSInfoIFDPointer"in c&&(u.gpsIFD=u.tiffHeader+c.GPSInfoIFDPointer,delete c.GPSInfoIFDPointer),!0)}function r(t,e,i){var n,o,r,c=0;if("string"==typeof e){var l=s[t.toLowerCase()];for(var d in l)if(l[d]===e){e=d;break}}n=u[t.toLowerCase()+"IFD"],o=a.SHORT(n);for(var p=0;o>p;p++)if(r=n+12*p+2,a.SHORT(r)==e){c=r+8;break}return!!c&&(a.LONG(c,i),!0)}var a,s,c,l,u={};return a=new i,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},l={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return u={tiffHeader:10},!(t===e||!t.length)&&(a.init(t),65505===a.SHORT(0)&&"EXIF\0"===a.STRING(4,5).toUpperCase()&&o())},TIFF:function(){return c},EXIF:function(){var e;if(e=n(u.exifIFD,s.exif),e.ExifVersion&&"array"===t.typeOf(e.ExifVersion)){for(var i=0,o="";i<e.ExifVersion.length;i++)o+=String.fromCharCode(e.ExifVersion[i]);e.ExifVersion=o}return e},GPS:function(){var e;return e=n(u.gpsIFD,s.gps),e.GPSVersionID&&"array"===t.typeOf(e.GPSVersionID)&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(t,e){return("PixelXDimension"===t||"PixelYDimension"===t)&&r("exif",t,e)},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null),a=c=null,u={}}}}}),n(P,[s,p,L,M,N],function(t,e,i,n,o){function r(r){function a(){for(var t,e,i=0;i<=c.length;){if(t=l.SHORT(i+=2),t>=65472&&65475>=t)return i+=5,{height:l.SHORT(i),width:l.SHORT(i+=2)};e=l.SHORT(i+=2),i+=e-2}return null}function s(){d&&u&&l&&(d.purge(),u.purge(),l.init(null),c=p=u=d=l=null)}var c,l,u,d,p,h;if(c=r,l=new n,l.init(c),65496!==l.SHORT(0))throw new e.ImageError(e.ImageError.WRONG_FORMAT);u=new i(r),d=new o,h=!!d.init(u.get("app1")[0]),p=a.call(this),t.extend(this,{type:"image/jpeg",size:c.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(e,i){return!!h&&("object"===t.typeOf(e)?t.each(e,function(t,e){d.setExif(e,t)}):d.setExif(e,i),void u.set("app1",d.getBinary()))},writeHeaders:function(){return arguments.length?u.restore(arguments[0]):c=u.restore(c)},stripHeaders:function(t){return u.strip(t)},purge:function(){s.call(this)}}),h&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS()})}return r}),n(F,[p,s,M],function(t,e,i){function n(n){function o(){var t,e;return t=a.call(this,8),"IHDR"==t.type?(e=t.start,{width:c.LONG(e),height:c.LONG(e+=4)}):null}function r(){c&&(c.init(null),s=d=l=u=c=null)}function a(t){var e,i,n,o;return e=c.LONG(t),i=c.STRING(t+=4,4),n=t+=4,o=c.LONG(t+e),{length:e,type:i,start:n,CRC:o}}var s,c,l,u,d;s=n,c=new i,c.init(s),function(){var e=0,i=0,n=[35152,20039,3338,6666];for(i=0;i<n.length;i++,e+=2)if(n[i]!=c.SHORT(e))throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),d=o.call(this),e.extend(this,{type:"image/png",size:s.length,width:d.width,height:d.height,purge:function(){r.call(this)}}),r.call(this)}return n}),n(z,[s,p,P,F],function(t,e,i,n){return function(o){var r,a=[i,n];r=function(){for(var t=0;t<a.length;t++)try{return new a[t](o)}catch(i){}throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),t.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(t){return t},stripHeaders:function(t){return t},purge:function(){}}),t.extend(this,r),this.purge=function(){r.purge(),r=null}}}),n(B,[],function(){function t(t,n,o){var r=t.naturalWidth,a=t.naturalHeight,s=o.width,c=o.height,l=o.x||0,u=o.y||0,d=n.getContext("2d");e(t)&&(r/=2,a/=2);var p=1024,h=document.createElement("canvas");h.width=h.height=p;for(var f=h.getContext("2d"),m=i(t,r,a),g=0;a>g;){for(var v=g+p>a?a-g:p,_=0;r>_;){var y=_+p>r?r-_:p;f.clearRect(0,0,p,p),f.drawImage(t,-_,-g);var b=_*s/r+l<<0,x=Math.ceil(y*s/r),w=g*c/a/m+u<<0,k=Math.ceil(v*c/a/m);d.drawImage(h,0,0,y,v,b,w,x,k),_+=p}g+=p}h=f=null}function e(t){var e=t.naturalWidth,i=t.naturalHeight;if(e*i>1048576){var n=document.createElement("canvas");n.width=n.height=1;var o=n.getContext("2d");return o.drawImage(t,-e+1,0),0===o.getImageData(0,0,1,1).data[3]}return!1}function i(t,e,i){var n=document.createElement("canvas");n.width=1,n.height=i;var o=n.getContext("2d");o.drawImage(t,0,0);for(var r=o.getImageData(0,0,1,i).data,a=0,s=i,c=i;c>a;){var l=r[4*(c-1)+3];0===l?s=c:a=c,c=s+a>>1}n=null;var u=c/i;return 0===u?1:u}return{isSubsampled:e,renderTo:t}}),n(U,[S,s,p,f,_,z,B,l,u],function(t,e,i,n,o,r,a,s,c){function l(){function t(){if(!y&&!v)throw new i.ImageError(i.DOMException.INVALID_STATE_ERR);return y||v}function l(t){return n.atob(t.substring(t.indexOf("base64,")+7))}function u(t,e){return"data:"+(e||"")+";base64,"+n.btoa(t)}function d(t){var e=this;v=new Image,v.onerror=function(){g.call(this),e.trigger("error",new i.ImageError(i.ImageError.WRONG_FORMAT))},v.onload=function(){e.trigger("load")},v.src=/^data:[^;]*;base64,/.test(t)?t:u(t,x.type)}function p(t,e){var n,o=this;return window.FileReader?(n=new FileReader,n.onload=function(){e(this.result)},n.onerror=function(){o.trigger("error",new i.FileException(i.FileException.NOT_READABLE_ERR))},void n.readAsDataURL(t)):e(t.getAsDataURL())}function h(i,n,o,r){var a,s,c,l,u,d,p=this,h=0,g=0;if(D=r,d=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==e.inArray(d,[5,6,7,8])){var v=i;i=n,n=v}return c=t(),s=o?Math.max:Math.min,a=s(i/c.width,n/c.height),a>1&&(!o||r)?void this.trigger("Resize"):(y||(y=document.createElement("canvas")),l=Math.round(c.width*a),u=Math.round(c.height*a),o?(y.width=i,y.height=n,l>i&&(h=Math.round((l-i)/2)),u>n&&(g=Math.round((u-n)/2))):(y.width=l,y.height=u),D||m(y.width,y.height,d),f.call(this,c,y,-h,-g,l,u),this.width=y.width,this.height=y.height,k=!0,void p.trigger("Resize"))}function f(t,e,i,n,o,r){if("iOS"===c.OS)a.renderTo(t,e,{width:o,height:r,x:i,y:n});else{var s=e.getContext("2d");s.drawImage(t,i,n,o,r)}}function m(t,e,i){switch(i){case 5:case 6:case 7:case 8:y.width=e,y.height=t;break;default:y.width=t,y.height=e}var n=y.getContext("2d");switch(i){case 2:n.translate(t,0),n.scale(-1,1);break;case 3:n.translate(t,e),n.rotate(Math.PI);break;case 4:n.translate(0,e),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-e);break;case 7:n.rotate(.5*Math.PI),n.translate(t,-e),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-t,0)}}function g(){_&&(_.purge(),_=null),b=v=y=x=null,k=!1}var v,_,y,b,x,w=this,k=!1,D=!0;e.extend(this,{loadFromBlob:function(t){var e=this,n=e.getRuntime(),o=!(arguments.length>1)||arguments[1];if(!n.can("access_binary"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);return x=t,t.isDetached()?(b=t.getSource(),void d.call(this,b)):void p.call(this,t.getSource(),function(t){o&&(b=l(t)),d.call(e,t)})},loadFromImage:function(t,e){this.meta=t.meta,x=new o(null,{name:t.name,size:t.size,type:t.type}),d.call(this,e?b=t.getAsBinaryString():t.getAsDataURL())},getInfo:function(){var e,i=this.getRuntime();return!_&&b&&i.can("access_image_binary")&&(_=new r(b)),e={width:t().width||0,height:t().height||0,type:x.type||s.getFileMime(x.name),size:b&&b.length||x.size||0,name:x.name||"",meta:_&&_.meta||this.meta||{}}},downsize:function(){h.apply(this,arguments)},getAsCanvas:function(){return y&&(y.id=this.uid+"_canvas"),y},getAsBlob:function(t,e){return t!==this.type&&h.call(this,this.width,this.height,!1),new o(null,{name:x.name||"",type:t,data:w.getAsBinaryString.call(this,t,e)})},getAsDataURL:function(t){var e=arguments[1]||90;if(!k)return v.src;if("image/jpeg"!==t)return y.toDataURL("image/png");try{return y.toDataURL("image/jpeg",e/100)}catch(i){return y.toDataURL("image/jpeg")}},getAsBinaryString:function(t,e){if(!k)return b||(b=l(w.getAsDataURL(t,e))),b;if("image/jpeg"!==t)b=l(w.getAsDataURL(t,e));else{var i;e||(e=90);try{i=y.toDataURL("image/jpeg",e/100)}catch(n){i=y.toDataURL("image/jpeg")}b=l(i),_&&(b=_.stripHeaders(b),D&&(_.meta&&_.meta.exif&&_.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),b=_.writeHeaders(b)),_.purge(),_=null)}return k=!1,b},destroy:function(){w=null,g.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return t.Image=l}),n(H,[s,u,d,p,m],function(t,e,i,n,o){function r(){var t;try{t=navigator.plugins["Shockwave Flash"],t=t.description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1])}function a(a){var l,u=this;a=t.extend({swf_url:e.swf_url},a),o.call(this,a,s,{access_binary:function(t){return t&&"browser"===u.mode},access_image_binary:function(t){return t&&"browser"===u.mode},display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===u.mode},resize_image:o.capTrue,return_response_headers:!1,return_response_type:function(e){return!("json"!==e||!window.JSON)||(!t.arrayDiff(e,["","text","document"])||"browser"===u.mode)},return_status_code:function(e){return"browser"===u.mode||!t.arrayDiff(e,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:function(t){return t&&"browser"===u.mode},send_browser_cookies:function(t){return t&&"browser"===u.mode},send_custom_headers:function(t){return t&&"browser"===u.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:function(t){return t&&"browser"===u.mode},summon_file_dialog:!1,upload_filesize:function(e){return t.parseSizeStr(e)<=2097152||"client"===u.mode},use_http_method:function(e){return!t.arrayDiff(e,["GET","POST"])}},{access_binary:function(t){return t?"browser":"client"},access_image_binary:function(t){return t?"browser":"client"},report_upload_progress:function(t){return t?"browser":"client"},return_response_type:function(e){return t.arrayDiff(e,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(e){return t.arrayDiff(e,[200,404])?"browser":["client","browser"]},send_binary_string:function(t){return t?"browser":"client"},send_browser_cookies:function(t){return t?"browser":"client"},send_custom_headers:function(t){return t?"browser":"client"},stream_upload:function(t){return t?"client":"browser"},upload_filesize:function(e){return t.parseSizeStr(e)>=2097152?"client":"browser"}},"client"),r()<10&&(this.mode=!1),t.extend(this,{getShim:function(){return i.get(this.uid)},shimExec:function(t,e){var i=[].slice.call(arguments,2);return u.getShim().exec(this.uid,t,e,i)},init:function(){var i,o,r;r=this.getShimContainer(),t.extend(r.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),i='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+a.swf_url+'" ',"IE"===e.browser&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===e.browser?(o=document.createElement("div"),r.appendChild(o),o.outerHTML=i,o=r=null):r.innerHTML=i,l=setTimeout(function(){u&&!u.initialized&&u.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(t){return function(){t.call(u),clearTimeout(l),a=l=t=u=null}}(this.destroy)},c)}var s="flash",c={};return o.addConstructor(s,a),c}),n(Y,[H,v],function(t,e){var i={slice:function(t,i,n,o){var r=this.getRuntime();return 0>i?i=Math.max(t.size+i,0):i>0&&(i=Math.min(i,t.size)),0>n?n=Math.max(t.size+n,0):n>0&&(n=Math.min(n,t.size)),t=r.shimExec.call(this,"Blob","slice",i,n,o||""),t&&(t=new e(r.uid,t)),t}};return t.Blob=i}),n(G,[H],function(t){var e={init:function(t){this.getRuntime().shimExec.call(this,"FileInput","init",{name:t.name,accept:t.accept,multiple:t.multiple}),this.trigger("ready")}};return t.FileInput=e}),n(V,[H,f],function(t,e){function i(t,i){switch(i){case"readAsText":return e.atob(t,"utf8");case"readAsBinaryString":return e.atob(t);case"readAsDataURL":return t}return null}var n="",o={read:function(t,e){var o=this,r=o.getRuntime();return"readAsDataURL"===t&&(n="data:"+(e.type||"")+";base64,"),o.bind("Progress",function(e,o){o&&(n+=i(o,t))}),r.shimExec.call(this,"FileReader","readAsBase64",e.uid)},getResult:function(){return n},destroy:function(){
n=null}};return t.FileReader=o}),n(W,[H,f],function(t,e){function i(t,i){switch(i){case"readAsText":return e.atob(t,"utf8");case"readAsBinaryString":return e.atob(t);case"readAsDataURL":return t}return null}var n={read:function(t,e){var n,o=this.getRuntime();return(n=o.shimExec.call(this,"FileReaderSync","readAsBase64",e.uid))?("readAsDataURL"===t&&(n="data:"+(e.type||"")+";base64,"+n),i(n,t,e.type)):null}};return t.FileReaderSync=n}),n(K,[H,s,v,_,D,E,T],function(t,e,i,n,o,r,a){var s={send:function(t,n){function o(){t.transport=u.mode,u.shimExec.call(l,"XMLHttpRequest","send",t,n)}function s(t,e){u.shimExec.call(l,"XMLHttpRequest","appendBlob",t,e.uid),n=null,o()}function c(t,e){var i=new a;i.bind("TransportingComplete",function(){e(this.result)}),i.transport(t.getSource(),t.type,{ruid:u.uid})}var l=this,u=l.getRuntime();if(e.isEmptyObj(t.headers)||e.each(t.headers,function(t,e){u.shimExec.call(l,"XMLHttpRequest","setRequestHeader",e,t.toString())}),n instanceof r){var d;if(n.each(function(t,e){t instanceof i?d=e:u.shimExec.call(l,"XMLHttpRequest","append",e,t)}),n.hasBlob()){var p=n.getBlob();p.isDetached()?c(p,function(t){p.destroy(),s(d,t)}):s(d,p)}else n=null,o()}else n instanceof i?n.isDetached()?c(n,function(t){n.destroy(),n=t.uid,o()}):(n=n.uid,o()):o()},getResponse:function(t){var i,r,a=this.getRuntime();if(r=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(r=new n(a.uid,r),"blob"===t)return r;try{if(i=new o,~e.inArray(t,["","text"]))return i.readAsText(r);if("json"===t&&window.JSON)return JSON.parse(i.readAsText(r))}finally{r.destroy()}}return null},abort:function(t){var e=this.getRuntime();e.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return t.XMLHttpRequest=s}),n(X,[H,v],function(t,e){var i={getAsBlob:function(t){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",t);return n?new e(i.uid,n):null}};return t.Transporter=i}),n(J,[H,s,T,v,D],function(t,e,i,n,o){var r={loadFromBlob:function(t){function e(t){o.shimExec.call(n,"Image","loadFromBlob",t.uid),n=o=null}var n=this,o=n.getRuntime();if(t.isDetached()){var r=new i;r.bind("TransportingComplete",function(){e(r.result.getSource())}),r.transport(t.getSource(),t.type,{ruid:o.uid})}else e(t.getSource())},loadFromImage:function(t){var e=this.getRuntime();return e.shimExec.call(this,"Image","loadFromImage",t.uid)},getAsBlob:function(t,e){var i=this.getRuntime(),o=i.shimExec.call(this,"Image","getAsBlob",t,e);return o?new n(i.uid,o):null},getAsDataURL:function(){var t,e=this.getRuntime(),i=e.Image.getAsBlob.apply(this,arguments);return i?(t=new o,t.readAsDataURL(i)):null}};return t.Image=r}),n(Q,[s,u,d,p,m],function(t,e,i,n,o){function r(t){var e,i,n,o,r,a=!1,s=null,c=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(t)&&(a=!0),s=null}catch(l){var u=navigator.plugins["Silverlight Plug-In"];if(u){for(e=u.description,"1.0.30226.2"===e&&(e="2.0.30226.2"),i=e.split(".");i.length>3;)i.pop();for(;i.length<4;)i.push(0);for(n=t.split(".");n.length>4;)n.pop();do o=parseInt(n[c],10),r=parseInt(i[c],10),c++;while(c<n.length&&o===r);r>=o&&!isNaN(o)&&(a=!0)}}}catch(d){a=!1}return a}function a(a){var l,u=this;a=t.extend({xap_url:e.xap_url},a),o.call(this,a,s,{access_binary:o.capTrue,access_image_binary:o.capTrue,display_media:o.capTrue,do_cors:o.capTrue,drag_and_drop:!1,report_upload_progress:o.capTrue,resize_image:o.capTrue,return_response_headers:function(t){return t&&"client"===u.mode},return_response_type:function(t){return"json"!==t||!!window.JSON},return_status_code:function(e){return"client"===u.mode||!t.arrayDiff(e,[200,404])},select_file:o.capTrue,select_multiple:o.capTrue,send_binary_string:o.capTrue,send_browser_cookies:function(t){return t&&"browser"===u.mode},send_custom_headers:function(t){return t&&"client"===u.mode},send_multipart:o.capTrue,slice_blob:o.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:o.capTrue,use_http_method:function(e){return"client"===u.mode||!t.arrayDiff(e,["GET","POST"])}},{return_response_headers:function(t){return t?"client":"browser"},return_status_code:function(e){return t.arrayDiff(e,[200,404])?"client":["client","browser"]},send_browser_cookies:function(t){return t?"browser":"client"},send_custom_headers:function(t){return t?"client":"browser"},use_http_method:function(e){return t.arrayDiff(e,["GET","POST"])?"client":["client","browser"]}}),r("2.0.31005.0")&&"Opera"!==e.browser||(this.mode=!1),t.extend(this,{getShim:function(){return i.get(this.uid).content.Moxie},shimExec:function(t,e){var i=[].slice.call(arguments,2);return u.getShim().exec(this.uid,t,e,i)},init:function(){var t;t=this.getShimContainer(),t.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.global_event_dispatcher+'"/></object>',l=setTimeout(function(){u&&!u.initialized&&u.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},"Windows"!==e.OS?1e4:5e3)},destroy:function(t){return function(){t.call(u),clearTimeout(l),a=l=t=u=null}}(this.destroy)},c)}var s="silverlight",c={};return o.addConstructor(s,a),c}),n(Z,[Q,s,Y],function(t,e,i){return t.Blob=e.extend({},i)}),n(tt,[Q],function(t){var e={init:function(t){function e(t){for(var e="",i=0;i<t.length;i++)e+=(""!==e?"|":"")+t[i].title+" | *."+t[i].extensions.replace(/,/g,";*.");return e}this.getRuntime().shimExec.call(this,"FileInput","init",e(t.accept),t.name,t.multiple),this.trigger("ready")}};return t.FileInput=e}),n(et,[Q,d,R],function(t,e,i){var n={init:function(){var t,n=this,o=n.getRuntime();return t=o.getShimContainer(),i.addEvent(t,"dragover",function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="copy"},n.uid),i.addEvent(t,"dragenter",function(t){t.preventDefault();var i=e.get(o.uid).dragEnter(t);i&&t.stopPropagation()},n.uid),i.addEvent(t,"drop",function(t){t.preventDefault();var i=e.get(o.uid).dragDrop(t);i&&t.stopPropagation()},n.uid),o.shimExec.call(this,"FileDrop","init")}};return t.FileDrop=n}),n(it,[Q,s,V],function(t,e,i){return t.FileReader=e.extend({},i)}),n(nt,[Q,s,W],function(t,e,i){return t.FileReaderSync=e.extend({},i)}),n(ot,[Q,s,K],function(t,e,i){return t.XMLHttpRequest=e.extend({},i)}),n(rt,[Q,s,X],function(t,e,i){return t.Transporter=e.extend({},i)}),n(at,[Q,s,J],function(t,e,i){return t.Image=e.extend({},i,{getInfo:function(){var t=this.getRuntime(),i=["tiff","exif","gps"],n={meta:{}},o=t.shimExec.call(this,"Image","getInfo");return o.meta&&e.each(i,function(t){var e,i,r,a,s=o.meta[t];if(s&&s.keys)for(n.meta[t]={},i=0,r=s.keys.length;r>i;i++)e=s.keys[i],a=s[e],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),n.meta[t][e]=a)}),n.width=parseInt(o.width,10),n.height=parseInt(o.height,10),n.size=parseInt(o.size,10),n.type=o.type,n.name=o.name,n}})}),n(st,[s,p,m,u],function(t,e,i,n){function o(e){var o=this,s=i.capTest,c=i.capTrue;i.call(this,e,r,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(n.can("create_canvas")||n.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),resize_image:function(){return a.Image&&o.can("access_binary")&&n.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(e){return!("json"!==e||!window.JSON)||!!~t.inArray(e,["text","document",""])},return_status_code:function(e){return!t.arrayDiff(e,[200,404])},select_file:function(){return n.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return o.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||!!~t.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:c,use_http_method:function(e){return!t.arrayDiff(e,["GET","POST"])}}),t.extend(this,{init:function(){this.trigger("Init")},destroy:function(t){return function(){t.call(o),t=o=null}}(this.destroy)}),t.extend(this.getShim(),a)}var r="html4",a={};return i.addConstructor(r,o),a}),n(ct,[st,s,d,R,l,u],function(t,e,i,n,o,r){function a(){function t(){var o,u,d,p,h,f,m=this,g=m.getRuntime();f=e.guid("uid_"),o=g.getShimContainer(),a&&(d=i.get(a+"_form"),d&&e.extend(d.style,{top:"100%"})),p=document.createElement("form"),p.setAttribute("id",f+"_form"),p.setAttribute("method","post"),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),e.extend(p.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=document.createElement("input"),h.setAttribute("id",f),h.setAttribute("type","file"),h.setAttribute("name",s.name||"Filedata"),h.setAttribute("accept",l.join(",")),e.extend(h.style,{fontSize:"999px",opacity:0}),p.appendChild(h),o.appendChild(p),e.extend(h.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===r.browser&&r.version<10&&e.extend(h.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),h.onchange=function(){var e;this.value&&(e=this.files?this.files[0]:{name:this.value},c=[e],this.onchange=function(){},t.call(m),m.bind("change",function n(){var t,e=i.get(f),o=i.get(f+"_form");m.unbind("change",n),m.files.length&&e&&o&&(t=m.files[0],e.setAttribute("id",t.uid),o.setAttribute("id",t.uid+"_form"),o.setAttribute("target",t.uid+"_iframe")),e=o=null},998),h=p=null,m.trigger("change"))},g.can("summon_file_dialog")&&(u=i.get(s.browse_button),n.removeEvent(u,"click",m.uid),n.addEvent(u,"click",function(t){h&&!h.disabled&&h.click(),t.preventDefault()},m.uid)),a=f,o=d=u=null}var a,s,c=[],l=[];e.extend(this,{init:function(e){var r,a=this,c=a.getRuntime();s=e,l=e.accept.mimes||o.extList2mimes(e.accept,c.can("filter_by_extension")),r=c.getShimContainer(),function(){var t,o,s;t=i.get(e.browse_button),c.can("summon_file_dialog")&&("static"===i.getStyle(t,"position")&&(t.style.position="relative"),o=parseInt(i.getStyle(t,"z-index"),10)||1,t.style.zIndex=o,r.style.zIndex=o-1),s=c.can("summon_file_dialog")?t:r,n.addEvent(s,"mouseover",function(){a.trigger("mouseenter")},a.uid),n.addEvent(s,"mouseout",function(){a.trigger("mouseleave")},a.uid),n.addEvent(s,"mousedown",function(){a.trigger("mousedown")},a.uid),n.addEvent(i.get(e.container),"mouseup",function(){a.trigger("mouseup")},a.uid),t=null}(),t.call(this),r=null,a.trigger({type:"ready",async:!0})},getFiles:function(){return c},disable:function(t){var e;(e=i.get(a))&&(e.disabled=!!t)},destroy:function(){var t=this.getRuntime(),e=t.getShim(),o=t.getShimContainer();n.removeAllEvents(o,this.uid),n.removeAllEvents(s&&i.get(s.container),this.uid),n.removeAllEvents(s&&i.get(s.browse_button),this.uid),o&&(o.innerHTML=""),e.removeInstance(this.uid),a=c=l=s=o=e=null}})}return t.FileInput=a}),n(lt,[st,q],function(t,e){return t.FileReader=e}),n(ut,[st,s,d,k,p,R,v,E],function(t,e,i,n,o,r,a,s){function c(){function t(t){var e,n,o,a,s=this,c=!1;if(u){if(e=u.id.replace(/_iframe$/,""),n=i.get(e+"_form")){for(o=n.getElementsByTagName("input"),a=o.length;a--;)switch(o[a].getAttribute("type")){case"hidden":o[a].parentNode.removeChild(o[a]);break;case"file":c=!0}o=[],c||n.parentNode.removeChild(n),n=null}setTimeout(function(){r.removeEvent(u,"load",s.uid),u.parentNode&&u.parentNode.removeChild(u);var e=s.getRuntime().getShimContainer();e.children.length||e.parentNode.removeChild(e),e=u=null,t()},1)}}var c,l,u;e.extend(this,{send:function(d,p){function h(){var i=y.getShimContainer()||document.body,o=document.createElement("div");o.innerHTML='<iframe id="'+f+'_iframe" name="'+f+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',u=o.firstChild,i.appendChild(u),r.addEvent(u,"load",function(){var i;try{i=u.contentWindow.document||u.contentDocument||window.frames[u.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(i.title)?c=i.title.replace(/^(\d+).*$/,"$1"):(c=200,l=e.trim(i.body.innerHTML),_.trigger({type:"progress",loaded:l.length,total:l.length}),v&&_.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(o){if(!n.hasSameOrigin(d.url))return void t.call(_,function(){_.trigger("error")});c=404}t.call(_,function(){_.trigger("load")})},_.uid)}var f,m,g,v,_=this,y=_.getRuntime();if(c=l=null,p instanceof s&&p.hasBlob()){if(v=p.getBlob(),f=v.uid,g=i.get(f),m=i.get(f+"_form"),!m)throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}else f=e.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",f+"_form"),m.setAttribute("method",d.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),m.setAttribute("target",f+"_iframe"),y.getShimContainer().appendChild(m);p instanceof s&&p.each(function(t,i){if(t instanceof a)g&&g.setAttribute("name",i);else{var n=document.createElement("input");e.extend(n,{type:"hidden",name:i,value:t}),g?m.insertBefore(n,g):m.appendChild(n)}}),m.setAttribute("action",d.url),h(),m.submit(),_.trigger("loadstart")},getStatus:function(){return c},getResponse:function(t){if("json"===t&&"string"===e.typeOf(l)&&window.JSON)try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(i){return null}return l},abort:function(){var e=this;u&&u.contentWindow&&(u.contentWindow.stop?u.contentWindow.stop():u.contentWindow.document.execCommand?u.contentWindow.document.execCommand("Stop"):u.src="about:blank"),t.call(this,function(){e.dispatchEvent("abort")})}})}return t.XMLHttpRequest=c}),n(dt,[st,U],function(t,e){return t.Image=e}),r([s,c,l,u,d,p,h,f,m,g,v,_,y,b,x,w,k,D,E,C,T,A,R])}(this),function(){"use strict";var t={},e=moxie.core.utils.Basic.inArray;return function i(n){var o,r;for(o in n)r=typeof n[o],"object"!==r||~e(o,["Exceptions","Env","Mime"])?"function"===r&&(t[o]=n[o]):i(n[o])}(window.moxie),t.Env=window.moxie.core.utils.Env,t.Mime=window.moxie.core.utils.Mime,t.Exceptions=window.moxie.core.Exceptions,window.mOxie=t,window.o||(window.o=t),t}(),function(t,e,i){function n(t){function e(t,e,i){var o={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};o[t]?n[o[t]]=e:i||(n[t]=e)}var i=t.required_features,n={};return"string"==typeof i?a.each(i.split(/\s*,\s*/),function(t){e(t,!0)}):"object"==typeof i?a.each(i,function(t,i){e(i,t)}):i===!0&&(t.multipart||(n.send_binary_string=!0),t.chunk_size>0&&(n.slice_blob=!0),t.resize.enabled&&(n.send_binary_string=!0),a.each(t,function(t,i){e(i,!!t,!0)})),n}var o=t.setTimeout,r={},a={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e.mimes,ua:e.ua,typeOf:e.typeOf,extend:e.extend,guid:e.guid,get:function(t){var i,n=[];"array"!==e.typeOf(t)&&(t=[t]);for(var o=t.length;o--;)i=e.get(t[o]),i&&n.push(i);return n.length?n:null},each:e.each,getPos:e.getPos,getSize:e.getSize,xmlEncode:function(t){var e={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},i=/[<>&\"\']/g;return t?(""+t).replace(i,function(t){return e[t]?"&"+e[t]+";":t}):t},toArray:e.toArray,inArray:e.inArray,addI18n:e.addI18n,translate:e.translate,isEmptyObj:e.isEmptyObj,hasClass:e.hasClass,addClass:e.addClass,removeClass:e.removeClass,getStyle:e.getStyle,addEvent:e.addEvent,removeEvent:e.removeEvent,removeAllEvents:e.removeAllEvents,cleanName:function(t){var e,i;for(i=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],e=0;e<i.length;e+=2)t=t.replace(i[e],i[e+1]);return t=t.replace(/\s+/g,"_"),t=t.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(t,e){var i="";return a.each(e,function(t,e){i+=(i?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(t)}),i&&(t+=(t.indexOf("?")>0?"&":"?")+i),t},formatSize:function(t){function e(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}if(t===i||/\D/.test(t))return a.translate("N/A");var n=Math.pow(1024,4);return t>n?e(t/n,1)+" "+a.translate("tb"):t>(n/=1024)?e(t/n,1)+" "+a.translate("gb"):t>(n/=1024)?e(t/n,1)+" "+a.translate("mb"):t>1024?Math.round(t/1024)+" "+a.translate("kb"):t+" "+a.translate("b")},parseSize:e.parseSizeStr,predictRuntime:function(t,i){var n,o;return n=new a.Uploader(t),o=e.Runtime.thatCan(n.getOption().required_features,i||t.runtimes),n.destroy(),o},addFileFilter:function(t,e){r[t]=e}};a.addFileFilter("mime_types",function(t,e,i){t.length&&!t.regexp.test(e.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:e}),i(!1)):i(!0)}),a.addFileFilter("max_file_size",function(t,e,i){var n;t=a.parseSize(t),e.size!==n&&t&&e.size>t?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:e}),i(!1)):i(!0)}),a.addFileFilter("prevent_duplicates",function(t,e,i){if(t)for(var n=this.files.length;n--;)if(e.name===this.files[n].name&&e.size===this.files[n].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:e}),void i(!1);i(!0)}),a.Uploader=function(t){function s(){var t,e,i=0;if(this.state==a.STARTED){for(e=0;e<$.length;e++)t||$[e].status!=a.QUEUED?i++:(t=$[e],this.trigger("BeforeUpload",t)&&(t.status=a.UPLOADING,this.trigger("UploadFile",t)));i==$.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",$))}}function c(t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,l()}function l(){var t,e;for(T.reset(),t=0;t<$.length;t++)e=$[t],e.size!==i?(T.size+=e.origSize,T.loaded+=e.loaded*e.origSize/e.size):T.size=i,e.status==a.DONE?T.uploaded++:e.status==a.FAILED?T.failed++:T.queued++;T.size===i?T.percent=$.length>0?Math.ceil(T.uploaded/$.length*100):0:(T.bytesPerSec=Math.ceil(T.loaded/((+new Date-C||1)/1e3)),T.percent=T.size>0?Math.ceil(T.loaded/T.size*100):0)}function u(){var t=I[0]||j[0];return!!t&&t.getRuntime().uid}function d(t,i){if(t.ruid){var n=e.Runtime.getInfo(t.ruid);if(n)return n.can(i)}return!1}function p(){this.bind("FilesAdded",g),this.bind("CancelUpload",x),this.bind("BeforeUpload",v),this.bind("UploadFile",_),this.bind("UploadProgress",y),this.bind("StateChanged",b),this.bind("QueueChanged",l),this.bind("Error",k),this.bind("FileUploaded",w),this.bind("Destroy",D)}function h(t,i){var n=this,o=0,r=[],s={accept:t.filters.mime_types,runtime_order:t.runtimes,required_caps:t.required_features,preferred_caps:R,swf_url:t.flash_swf_url,xap_url:t.silverlight_xap_url};a.each(t.runtimes.split(/\s*,\s*/),function(e){t[e]&&(s[e]=t[e])}),t.browse_button&&a.each(t.browse_button,function(i){r.push(function(r){var c=new e.FileInput(a.extend({},s,{name:t.file_data_name,multiple:t.multi_selection,container:t.container,browse_button:i}));c.onready=function(){var t=e.Runtime.getInfo(this.ruid);e.extend(n.features,{chunks:t.can("slice_blob"),multipart:t.can("send_multipart"),multi_selection:t.can("select_multiple")}),o++,I.push(this),r()},c.onchange=function(){n.addFile(this.files)},c.bind("mouseenter mouseleave mousedown mouseup",function(n){q||(t.browse_button_hover&&("mouseenter"===n.type?e.addClass(i,t.browse_button_hover):"mouseleave"===n.type&&e.removeClass(i,t.browse_button_hover)),t.browse_button_active&&("mousedown"===n.type?e.addClass(i,t.browse_button_active):"mouseup"===n.type&&e.removeClass(i,t.browse_button_active)))}),c.bind("error runtimeerror",function(){c=null,r()}),c.init()})}),t.drop_element&&a.each(t.drop_element,function(t){r.push(function(i){var r=new e.FileDrop(a.extend({},s,{drop_zone:t}));r.onready=function(){var t=e.Runtime.getInfo(this.ruid);n.features.dragdrop=t.can("drag_and_drop"),o++,j.push(this),i()},r.ondrop=function(){n.addFile(this.files)},r.bind("error runtimeerror",function(){r=null,i()}),r.init()})}),e.inSeries(r,function(){"function"==typeof i&&i(o)})}function f(t,i,n){var o=new e.Image;try{o.onload=function(){o.downsize(i.width,i.height,i.crop,i.preserve_headers)},o.onresize=function(){n(this.getAsBlob(t.type,i.quality)),this.destroy()},o.onerror=function(){n(t)},o.load(t)}catch(r){n(t)}}function m(t,i,o){function r(t,e,i){var n=E[t];switch(t){case"max_file_size":"max_file_size"===t&&(E.max_file_size=E.filters.max_file_size=e);break;case"chunk_size":(e=a.parseSize(e))&&(E[t]=e);break;case"filters":"array"===a.typeOf(e)&&(e={mime_types:e}),i?a.extend(E.filters,e):E.filters=e,e.mime_types&&(E.filters.mime_types.regexp=function(t){var e=[];return a.each(t,function(t){a.each(t.extensions.split(/,/),function(t){/^\s*\*\s*$/.test(t)?e.push("\\.*"):e.push("\\."+t.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+e.join("|")+")$","i")}(E.filters.mime_types));break;case"resize":i?a.extend(E.resize,e,{enabled:!0}):E.resize=e;break;case"prevent_duplicates":E.prevent_duplicates=E.filters.prevent_duplicates=!!e;break;case"browse_button":case"drop_element":e=a.get(e);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":E[t]=e,i||(c=!0);break;default:E[t]=e}i||s.trigger("OptionChanged",t,e,n)}var s=this,c=!1;"object"==typeof t?a.each(t,function(t,e){r(e,t,o)}):r(t,i,o),o?(E.required_features=n(a.extend({},E)),R=n(a.extend({},E,{required_features:!0}))):c&&(s.trigger("Destroy"),h.call(s,E,function(t){t?(s.runtime=e.Runtime.getInfo(u()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function g(t,e){[].push.apply($,e),t.trigger("QueueChanged"),t.refresh()}function v(t,e){if(E.unique_names){var i=e.name.match(/\.([^.]+)$/),n="part";i&&(n=i[1]),e.target_name=e.id+"."+n}}function _(t,i){function n(){u-- >0?o(r,1e3):(i.loaded=h,t.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:i,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}))}function r(){var d,f,m,g;i.status!=a.DONE&&i.status!=a.FAILED&&t.state!=a.STOPPED&&(m={name:i.target_name||i.name},l&&p.chunks&&s.size>l?(g=Math.min(l,s.size-h),d=s.slice(h,h+g)):(g=s.size,d=s),l&&p.chunks&&(t.settings.send_chunk_number?(m.chunk=Math.ceil(h/l),m.chunks=Math.ceil(s.size/l)):(m.offset=h,m.total=s.size)),A=new e.XMLHttpRequest,A.upload&&(A.upload.onprogress=function(e){i.loaded=Math.min(i.size,h+e.loaded),t.trigger("UploadProgress",i)}),A.onload=function(){return A.status>=400?void n():(u=t.settings.max_retries,g<s.size?(d.destroy(),h+=g,i.loaded=Math.min(h,s.size),t.trigger("ChunkUploaded",i,{offset:i.loaded,total:s.size,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}),"Android Browser"===e.Env.browser&&t.trigger("UploadProgress",i)):i.loaded=i.size,d=f=null,!h||h>=s.size?(i.size!=i.origSize&&(s.destroy(),s=null),t.trigger("UploadProgress",i),i.status=a.DONE,t.trigger("FileUploaded",i,{response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()})):o(r,1),void 0)},A.onerror=function(){n()},A.onloadend=function(){this.destroy(),A=null},t.settings.multipart&&p.multipart?(m.name=i.target_name||i.name,A.open("post",c,!0),a.each(t.settings.headers,function(t,e){A.setRequestHeader(e,t)}),f=new e.FormData,a.each(a.extend(m,t.settings.multipart_params),function(t,e){f.append(e,t)}),f.append(t.settings.file_data_name,d),A.send(f,{runtime_order:t.settings.runtimes,required_caps:t.settings.required_features,preferred_caps:R,swf_url:t.settings.flash_swf_url,xap_url:t.settings.silverlight_xap_url})):(c=a.buildUrl(t.settings.url,a.extend(m,t.settings.multipart_params)),A.open("post",c,!0),A.setRequestHeader("Content-Type","application/octet-stream"),a.each(t.settings.headers,function(t,e){A.setRequestHeader(e,t)}),A.send(d,{runtime_order:t.settings.runtimes,required_caps:t.settings.required_features,preferred_caps:R,swf_url:t.settings.flash_swf_url,xap_url:t.settings.silverlight_xap_url})))}var s,c=t.settings.url,l=t.settings.chunk_size,u=t.settings.max_retries,p=t.features,h=0;i.loaded&&(h=i.loaded=l*Math.floor(i.loaded/l)),s=i.getSource(),t.settings.resize.enabled&&d(s,"send_binary_string")&&~e.inArray(s.type,["image/jpeg","image/png"])?f.call(this,s,t.settings.resize,function(t){s=t,i.size=t.size,r()}):r()}function y(t,e){c(e)}function b(t){if(t.state==a.STARTED)C=+new Date;else if(t.state==a.STOPPED)for(var e=t.files.length-1;e>=0;e--)t.files[e].status==a.UPLOADING&&(t.files[e].status=a.QUEUED,l())}function x(){A&&A.abort()}function w(t){l(),o(function(){s.call(t)},1)}function k(t,e){e.file&&(e.file.status=a.FAILED,c(e.file),t.state==a.STARTED&&(t.trigger("CancelUpload"),o(function(){s.call(t)},1)))}function D(t){t.stop(),a.each($,function(t){t.destroy()}),$=[],I.length&&(a.each(I,function(t){t.destroy()}),I=[]),j.length&&(a.each(j,function(t){t.destroy()}),j=[]),R={},q=!1,C=A=null,T.reset()}var E,C,T,A,S=a.guid(),$=[],R={},I=[],j=[],q=!1;E={runtimes:e.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_chunk_number:!0},m.call(this,t,null,!0),T=new a.QueueProgress,a.extend(this,{id:S,uid:S,state:a.STOPPED,features:{},runtime:null,files:$,settings:E,total:T,init:function(){var t=this;return"function"==typeof E.preinit?E.preinit(t):a.each(E.preinit,function(e,i){t.bind(i,e)}),E.browse_button&&E.url?(p.call(this),void h.call(this,E,function(i){"function"==typeof E.init?E.init(t):a.each(E.init,function(e,i){t.bind(i,e)}),i?(t.runtime=e.Runtime.getInfo(u()).type,t.trigger("Init",{runtime:t.runtime}),t.trigger("PostInit")):t.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})})):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(t,e){m.call(this,t,e,!this.runtime)},getOption:function(t){return t?E[t]:E},refresh:function(){I.length&&a.each(I,function(t){t.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){q=arguments[0]===i||arguments[0],I.length&&a.each(I,function(t){t.disable(q)}),this.trigger("DisableBrowse",q)},getFile:function(t){var e;for(e=$.length-1;e>=0;e--)if($[e].id===t)return $[e]},addFile:function(t,i){function n(t,i){var n=[];e.each(l.settings.filters,function(e,i){r[i]&&n.push(function(n){r[i].call(l,e,t,function(t){n(!t)})})}),e.inSeries(n,i)}function s(t){var r=e.typeOf(t);if(t instanceof e.File){if(!t.ruid&&!t.isDetached()){if(!c)return!1;t.ruid=c,t.connectRuntime(c)}s(new a.File(t))}else t instanceof e.Blob?(s(t.getSource()),t.destroy()):t instanceof a.File?(i&&(t.name=i),d.push(function(e){n(t,function(i){i||(p.push(t),l.trigger("FileFiltered",t)),o(e,1)})})):e.inArray(r,["file","blob"])!==-1?s(new e.File(null,t)):"node"===r&&"filelist"===e.typeOf(t.files)?e.each(t.files,s):"array"===r&&(i=null,e.each(t,s))}var c,l=this,d=[],p=[];c=u(),s(t),d.length&&e.inSeries(d,function(){p.length&&l.trigger("FilesAdded",p)})},removeFile:function(t){for(var e="string"==typeof t?t:t.id,i=$.length-1;i>=0;i--)if($[i].id===e)return this.splice(i,1)[0]},splice:function(t,e){var n=$.splice(t===i?0:t,e===i?$.length:e),o=!1;return this.state==a.STARTED&&(o=!0,this.stop()),this.trigger("FilesRemoved",n),a.each(n,function(t){t.destroy()}),this.trigger("QueueChanged"),this.refresh(),o&&this.start(),n},bind:function(t,e,i){var n=this;a.Uploader.prototype.bind.call(this,t,function(){var t=[].slice.call(arguments);return t.splice(0,1,n),e.apply(this,t)},0,i)},destroy:function(){this.trigger("Destroy"),E=T=null,this.unbindAll()}})},a.Uploader.prototype=e.EventTarget.instance,a.File=function(){function t(t){a.extend(this,{id:a.guid(),name:t.name||t.fileName,type:t.type||"",size:t.size||t.fileSize,origSize:t.size||t.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:t.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var t=this.getSource().getSource();return e.inArray(e.typeOf(t),["blob","file"])!==-1?t:null},getSource:function(){return i[this.id]?i[this.id]:null},destroy:function(){var t=this.getSource();t&&(t.destroy(),delete i[this.id])}}),i[this.id]=t}var i={};return t}(),a.QueueProgress=function(){var t=this;t.size=0,t.loaded=0,t.uploaded=0,t.failed=0,t.queued=0,t.percent=0,t.bytesPerSec=0,t.reset=function(){t.size=t.loaded=t.uploaded=t.failed=t.queued=t.percent=t.bytesPerSec=0}},t.plupload=a}(window,mOxie),define("common/basic/js/plupload/plupload.full.min",function(){});var Qiniu=new QiniuJsSDK;define("common/basic/js/qiniu",function(){}),define("common/ui/upload/upload",["common/basic/js/plupload/plupload.full.min","common/basic/js/qiniu"],function(){function t(t){this.upopt={runtimes:"html5,flash,html4",browse_button:"",container:"",drop_element:"",max_file_size:"100mb",flash_swf_url:"/qcross/static/models/basic/js/plupload/Moxie.swf",dragdrop:!0,chunk_size:"4mb",qyer_token_url:"/qcross/www/api.php?action=getAlbumToken",uptoken:"",domain:"http://imgupload.qiniudn.com/",auto_start:!0,resize:{quality:90},init:{FilesAdded:function(t,e){},BeforeUpload:function(t,e){},UploadProgress:function(t,e){},UploadComplete:function(){},FileUploaded:function(t,e,i){},Key:function(t,e){var i=[];return i.push(window.QYER.uid),i.push((new Date).getTime()),i.push(parseInt(1e4*Math.random())),key=i.join(""),e.key=key,key},Error:function(t,e,i){var n="";if(e)switch(e.code){case-100:n="Silverlight加载失败";break;case-300:case-400:n="无法打开文件";break;case-600:n="图片必须小于"+t.getOption("max_file_size");break;case-601:n="文件扩展名不正确";break;default:n="未知错误"}t.trigger("UploadError",e,n)}}},this.init(t)}return t.prototype={init:function(t){$.extend(!0,this.upopt,t||{}),this.container="string"==typeof this.upopt.container?$("#"+this.upopt.container):this.upopt.container,this._getUpToken()},_getUpToken:function(){var t=this;$.getJSON(t.upopt.qyer_token_url,function(e){t.upopt.token_format&&(e=t.upopt.token_format(e)),t.uuid=e.data.uuid,t.upopt.uptoken=e.data.tk,t.upopt.domain=e.data.domain,t.uploader=Qiniu.uploader(t.upopt),$(t).trigger("uploadready")})}},t}),define("common/component/footprint/js/sourceType",[],function(){var t={"C-des-leftTopBtn":10,"C-des-beenTo":11,"C-des-bottomInput":12,"C-des-batchComment":{visited:13,unvisited:14,search:16},"C-des-batchCommentSearch":16,"C-profile-cityFootMarkDone":17,"C-profile-allFootmarkRecommend":21,"C-profile-allBeenBatchComment":{visited:22,unvisited:28},"C-profile-allBeenBatchCommentSearch":26,"C-profile-batchComment":{visited:23,unvisited:24,search:26},"C-profile-batchCommentSearch":26,"C-poi-create":20,"C-M-poiDetail":51,"C-M-poiDetailDock":52,"C-M-IWantToComment":53,"C-other-extract":2,"C-other-translate":1};return t}),define("common/ui/textArea/textArea",[],function(){function t(t){this.$obj=t.$obj,this.timer=null,this.option=t.option,this.init()}var e=jQuery,i=[".qui-textArea {zoom: 1; }",".qui-textArea .red { color: red; }",".qui-textArea textarea,",".qui-textArea input { word-break:break-all; transition: height 0.2s; -webkit-transition: height 0.2s; -moz-transition: height 0.2s; -ms-transition: height 0.2s; box-sizing: border-box; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; -ms-box-sizing: border-box; }",".qui-textArea .autoHeight { overflow: hidden; }"].join("");
window.qyerUtil.insertStyle(i),t.prototype={$obj:null,$textarea:null,$cloneTextarea:null,initHeight:null,maxHeight:null,timer:null,option:null,init:function(){this.$textarea=this.$obj.find("textarea").size()?this.$obj.find("textarea"):this.$obj.find("input"),this.$obj.attr("data-width")&&(this.$textarea.css("width",this.$obj.attr("data-width")),this.initHeight=this.$obj.attr("data-height")||this.$textarea.outerHeight()),this.$obj.attr("data-height")&&(this.$textarea.css("height",this.$obj.attr("data-height")),this.initWidth=this.$obj.attr("data-width")||this.$textarea.outerWidth()),this.option&&this.option.autoIncreaseHeight===!0&&(this.$cloneTextarea=this.createClone(this.$textarea)),this.$obj.show(),this.updateUI(),this.bindEvent()},createClone:function(t){if(t){var e=this.$textarea.clone(!0);return e.css({position:"absolute",left:"-9999em",overflow:"auto"}),e.insertAfter(t),e}},bindEvent:function(){var t=this;this.$obj.keyup(function(e){t.registEvent()})},registEvent:function(){var t=this;window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){t.updateUI(!0)},100)},updateUI:function(t){var i=this.$textarea,n=this.$cloneTextarea,o=this.$obj.find(".max"),r=this.$obj.find(".min"),a=this.$obj.find(".current"),s=(this.$obj.find(".exceed"),this.option.max),c=this.option.min,l=i.val().length;if(n){var u,d;n[0].value=i.val(),u=parseInt(n[0].scrollHeight,10),d=e.isNumeric(this.$obj.attr("data-max-height"))?this.$obj.attr("data-max-height"):99999,u>this.initHeight?(i.addClass("autoHeight"),u>=d&&(u=d,i.removeClass("autoHeight"))):u=this.initHeight,i.css("height",u),u=d=null}s==-1?l<c?(a.addClass("red"),0==l&&a.removeClass("red")):a.removeClass("red"):l<c||l>s?(a.addClass("red"),0==l&&a.removeClass("red")):a.removeClass("red"),a.html(l),o.html(s),r.html(c),$aTextArea=n=o=a=$left=s=c=l=left=null},isValidate:function(){var t=this.$obj.find("textarea").val().length;return this.option.max==-1?t>=this.option.min:t>=this.option.min&&t<=this.option.max},getContent:function(){return this.$obj.find("textarea")[0]},setValue:function(t){this.$textarea.val(t),this.$cloneTextarea.val(t),this.updateUI(!0)},getTextArea:function(){return this.$obj.find("textarea")[0]},unload:function(){this.$cloneTextarea.remove()},reset:function(){this.$textarea.val(""),this.$cloneTextarea.val(""),this.$obj.find(".current").html(0)}},e.fn.extend({qyerTextArea:function(i){var n,o;if(n={isValidate:function(t){return t.data("_qyerTextArea").isValidate()},getValue:function(t){return t.data("_qyerTextArea").getTextArea().value},unload:function(t){t.data("_qyerTextArea").unload()},reset:function(t){t.data("_qyerTextArea").setValue("")},setValue:function(t,e){t.data("_qyerTextArea").setValue(e)}},o=e.type(i),"object"==o||"undefined"==o)e.each(this,function(n,o){var r,a;r=e(o),a=e.extend({},i),a.max="undefined"!=typeof a.max?a.max:-1,a.min="undefined"!=typeof a.min?a.min:0,a.width=1==e.isNumeric(r.attr("data-width"))?r.attr("data-width"):null,a.height=1==e.isNumeric(r.attr("data-height"))?r.attr("data-height"):null,r.data("_qyerTextArea")||r.data("_qyerTextArea",new t({$obj:r,option:a})),r=a=null});else if("string"==o){var r,a,s=[];if(a=arguments,e.each(this,function(t,o){if(r=e(o),n[i]){var c=qyerUtil.sliceArguments(a,1);c.unshift(r),s.push(n[i].apply(r,c)),c=null}}),r=a=null,s.length)return 1==s.length?s[0]:s}return n=o=null,this}})}),define("common/basic/js/require-css!common/ui/inputValidation/inputValidation",[],function(){}),define("common/ui/inputValidation/inputValidation",["css!common/ui/inputValidation/inputValidation"],function(){function t(t,i){this.$obj=e(t),this.option=i,this.init()}var e=jQuery;t.prototype={$obj:null,$textDiv:null,option:null,init:function(){var t=this;this.setDefault(),this.option.blurAutoCheck!==!1&&this.$obj.blur(function(){t.check()}),this.$obj.focus(function(){t.clearTip()})},setDefault:function(){switch(this.option.defaultType){case"mail":this.option.exp=/^([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.-]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,6}$/,this.option.text=this.option.text||"邮箱地址格式错误";break;case"phone":this.option.exp=/^1[3|4|5|7|8][0-9]\d{4,8}$/,this.option.text=this.option.text||"手机号码格式错误";break;case"identityID":this.option.exp=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,this.option.text=this.option.text||"身份证号码格式错误";break;case"async":var t=this;this.option.exp=function(){return t.$obj.addClass("ui3_input_icon_loading"),t.$obj.removeClass("ui3_input_icon_error ui3_input_icon_ok"),t.option.asyncCheck(t.$obj.val(),function(e){setTimeout(function(){t.$obj.removeClass("ui3_input_icon_loading"),e?(t.option.text=e,t.addTip(),t.$obj.addClass("ui3_input_icon_error")):t.$obj.addClass("ui3_input_icon_ok")},10)}),!0}}},check:function(){var t=!1;switch(e.type(this.option.exp)){case"regexp":this.option.exp.lastIndex=0,t=this.option.exp.test(this.$obj.val());break;case"function":t=this.option.exp(this.$obj.val())}return this[t?"clearTip":"addTip"](),t},clearTip:function(){this.$obj.removeClass("qui-errorip ui3_input_icon_error"),this.$textDiv&&(this.$textDiv.remove(),this.$textDiv=null)},addTip:function(){this.$obj.addClass("qui-errorip"),this.$obj.hasClass("ui3_input")&&this.$obj.addClass("ui3_input_icon_error"),this.$textDiv&&this.$textDiv.remove();var t="qui-errorip-textDiv"+(this.option.style||"");this.$textDiv=e('<div class="'+t+'"><div class="tip"> <p class="a1"></p> <p class="a2"></p> </div> <div class="text">'+this.option.text+"</div> </div>");var i=this.$obj[this.option.parent?"position":"offset"]();if(1==this.option.style){this.$textDiv.appendTo(this.option.parent||document.body);var n=e(this.option.parent||document.body).outerWidth();n-=i.left,n-=this.$obj.outerWidth(),n=n-this.$textDiv.outerWidth()/2+16,this.$textDiv.css({right:n,top:i.top-25})}else this.$textDiv.css({left:i.left+10,top:i.top+this.$obj.outerHeight()-1}),this.$textDiv.appendTo(this.option.parent||document.body)},clear:function(){this.clearTip()}},e.fn.extend({qyerInputValidation:function(i){var n,o=!1,r=this;return e.each(this,function(){n=e(this),n.data("__errorTip__")?"clear"==i?(o=r,n.data("__errorTip__").clear()):o=n.data("__errorTip__").check():n.data("__errorTip__",new t(this,i))}),r=null,i?this:o}})}),define("common/basic/js/require-css!common/component/poiComment/poiComment",[],function(){}),define("common/component/poiComment/poiComment",["common/ui/popup/popup","common/ui/upload/upload","common/component/footprint/js/sourceType","common/ui/textArea/textArea","common/ui/inputValidation/inputValidation","css!common/component/poiComment/poiComment.css"],function(t,e,i){var n={settings:{saveDataSetting:{data:{}},onShow:!1,onHide:!1,onSucceed:null,onCancel:null}};return n.inition=function(t){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();$.extend(this.settings,t);return this.settings.ajaxArgu?(this.getData(this.settings,this.createDOM),!1):void(this.settings.data&&this.createDOM(this.settings.data,this.settings))},n.getData=function(t,e){var t=t,i=this;$.ajax(t.ajaxArgu).done(function(n){i.settings.saveDataSetting.data.starLevel&&parseInt(i.settings.saveDataSetting.data.starLevel,10)>0?n.data.starLevel=parseInt(i.settings.saveDataSetting.data.starLevel,10):n.data.starLevel=n.data.starLevel,e.call(i,n.data,t)}).fail(function(t){})},n.createDOM=function(e,i){var e=e,i=i,o=e.imgUrl||"http://common2.qyerstatic.com/place/common/component/poiComment/images/poi_200_133.png",r=e.poiLink||"javascript:void(0)",a=e.cnName||e.enName,s=e.enName&&e.cnName?e.enName:"",c=e.starLevel||0,l=e.comment||"",u=$("<div/>",{"class":"qui-siglComment"}),d=$("<a/>",{href:r,"class":"siglComment-title"}).appendTo(u);$("<img/>",{src:o,width:80,height:80}).appendTo(d);var p=$("<div/>",{"class":"siglComment-info"}).appendTo(u);$('<p class="siglComment-cn"><a href="'+r+'">'+a+"</a></p>").appendTo(p),$('<p class="siglComment-en"><a href="'+r+'">'+s+"</a></p>").appendTo(p);for(var h=$("<div/>",{"class":"siglComment-stars",starlevel:c}).appendTo(p),f=0;f<5;f++)$('<span class="star"></span>').appendTo(h);$('<em class="level">点击星星为它评分</em>').appendTo(h);var m=$("<div/>",{"class":"siglComment-detail","data-width":"638","data-height":"104"}).appendTo(u);$("<textarea/>",{"class":"ui3_textarea",placeholder:"这里有哪些亮点？哪些方面还不够好？大家都期待着你的点评"}).val(l).appendTo(m),$('<div class="siglComment-camera" id="swf_upload_container_c"><label id="uploader">分享照片</label>有图有真相的点评最受欢迎！</div>').appendTo(m),$('<ul class="siglComment-photolist" style="display:none" id="siglComment-photolist"><li class="add" id="swf_upload_container1"><span id="siglCommentPhotoUp"></span></li></ul>').appendTo(m),$('<div class="tips"><span class="current"></span> / <span class="min"></span> ~ <span class="max"></span></div>').appendTo(m);var g=t.show({title:" ",contentHTML:u,width:690,okText:"发布",onAfterHide:function(){i.onHide&&i.onHide.call(g)},onCancel:function(){i.onCancel&&i.onCancel.call(g)},onOK:function(){var e=$(g.getContent()),n=e.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation(),o=e.find(".siglComment-stars").attr("starlevel");if(!(o>0))return requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"点击星星为它评分",type:"warning"})}),!1;if(n){t.setOption({showLoadBtn:!0,showOKBtn:!1});({starlevel:o,comment:e.find(".siglComment-detail").find(".ui3_textarea").val()});return i.saveDataSetting.data.starlevel=o,i.saveDataSetting.data.comment=e.find(".siglComment-detail").find(".ui3_textarea").val(),i.saveDataSetting.data.imgs=$.map($("#siglComment-photolist li[tid]"),function(t){return $(t).attr("tid")}).join(","),$.ajax(i.saveDataSetting).done(function(t){i.onSucceed&&i.onSucceed.call(g,t),g.hide()}).fail(function(e){i.onFail&&i.onFail.call(g,e),t.setOption({showLoadBtn:!1,showOKBtn:!0})}),!1}return!1},onBeforeHide:function(){var t=$(g.getContent());t.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation("clear")}});n.popup=g,n.bindEvent.call(g.getContent()),i.onShow&&i.onShow.call(g)},n.bindEvent=function(){var t=$(this);t.find(".siglComment-detail").qyerTextArea({max:2e3,min:30,autoIncreaseHeight:!0}),t.find(".siglComment-detail").find(".ui3_textarea").qyerInputValidation({blurAutoCheck:!1,text:"点评不少于30字，不超过2000字",exp:/^(\s|\S){30,2000}$/im});var e=t.find(".siglComment-stars"),i=["很差","差","一般","好","很好"],n=e.attr("starlevel");e.find(".star").removeClass("star-on"),e.find(".level").html("点击星星为它评分"),n>0&&(e.find(".star:lt("+n+")").addClass("star-on"),e.find(".level").html(i[parseInt(n,10)-1])),e.off("mouseleave").on("mouseleave",function(){$(this).find(".star").removeClass("star-on"),e.find(".level").html("点击星星为它评分");var t=e.attr("starlevel");t>0&&($(this).find(".star:lt("+t+")").addClass("star-on"),e.find(".level").html(i[parseInt(t,10)-1]))}),e.find(".star").each(function(t){var n=t;$(this).hover(function(){e.find(".star").addClass("star-on"),e.find(".star:gt("+n+")").removeClass("star-on"),e.find(".level").html(i[n])}).click(function(){e.attr("starlevel",n+1)})}),$("#swf_upload_container_c label,#siglCommentPhotoUp").off("click").on("click",function(){require(["common/component/uploadPopup/uploadPopup"],function(t){var e=new t({max:20,items:[{model:"local",opt:{headOpt:{models:["list","create"]}}},{model:"myphoto",opt:{headOpt:{models:["list"]}}}]});e.show(),$(e).on("fireuploadimage",function(t,i){if(e.hide(),"string"==typeof i)var i=JSON.parse(i);var n=$("#siglComment-photolist"),o=n.css("display","block");$.each(i,function(t,e){var i=$('<li tid="'+e.id+'">\t\t\t\t\t\t\t<img src="'+e.url+'/80"/>\t\t\t\t\t\t\t<span class="close">\t\t\t\t\t\t\t</span>\t\t\t\t\t\t</li>').insertBefore(o.find(".add"));i.find(".close").click(function(t){t.stopPropagation(),$(this).parent().remove()})})})})})},n.show=function(t){n.inition({ajaxArgu:{data:{poiid:t.poiid},url:"/api.php?action=popupPoiComment",type:"post",dataType:"json"},flash_swf_url:"/qcross/static/models/basic/js/plupload/Moxie.swf",saveDataSetting:{url:"/qcross/place/index.php?action=savePoiComment",type:"post",dataType:"json",data:{poiid:t.poiid,source_type:i[t.source_type],starLevel:t.starLevel}},onShow:t.onShow||t.onshow||!1,onHide:t.onHide||t.onhide||!1,onSucceed:t.onSuccess||t.onsuccess||t.onSucceed||t.onsucceed||!1,onCancel:t.oncancel||t.oncancel||!1})},n.hide=function(){n.settings.onCancel&&n.settings.onCancel.call(n.popup),t.hide()},n}),define("common/basic/js/require-css!common/widget/userbehavior/userbehavior",[],function(){}),define("common/widget/userbehavior/widget-userbehavior",["common/widget/widget","common/widget/userbehavior/config","common/service/userbehavior/userbehavior-service","common/widget/userbehavior/liketip","project/js/batch_add_footprint","common/component/poiComment/poiComment","css!common/widget/userbehavior/userbehavior.css"],function(t,e,i,n,o,r){return t.createClass({init:function(t,e){this.callSuper.apply(this,arguments),this.params=t,"number"==typeof t.type?this.type=this.place["name"+t.type]:"string"==typeof t.type?this.type=t.type:this.type=this.place.name1,this.id=t.id,this.getDom()},toggleLoading:function(t){this.$el[t?t:"toggleClass"]("place-ubloading")},events:[["click","handle",">ul>li"],["click","submenu",">ul>li a"]],getDom:function(){this.toggleLoading("addClass"),qyerUtil.isLogin()?this.getBaseData():this.setDom(e.getDom(this.type,this.id))},getBaseData:function(){var t=this;i.getBehaviorInfo({tp:t.type,id:t.id},$.proxy(t.getBaseDataSuccess,t),$.proxy(t.getBaseDataError,t))},getBaseDataSuccess:function(t){var i=this,n=t.data.result;i.setDom(e.getDom(i.type,i.id,{planto:n.planto,beento:n.beento,lived:n.lived}))},getBaseDataError:function(t){this.$el.hide()},setDom:function(t){this.$dom=$(t),this.$el.append(this.$dom),this.toggleLoading("removeClass"),this.params.exClass&&this.$dom.addClass(this.params.exClass),new n},preventUnnecessary:function(t,e){return e===!0?void $(t).attr("data-on","no"):"yes"==$(t).attr("data-on")||($(t).attr("data-on","yes"),!1)},handle:function(t){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var e=this,n=$(t.currentTarget);switch(n.attr("data-type")){case e.planto:case e.beento:case e.lived:if(e.preventUnnecessary(t.currentTarget))return!1;var o=n.attr("data-type"),r={type:e.reversePlace[e.type],id:e.id,oper:o};r[o]=n.attr("data-status")-0?0:1,i.feeling(r,$.proxy(function(e){this.handleSuccess(t.currentTarget,e)},this),$.proxy(function(e){this.handleError(t.currentTarget,e)},this))}},handleSuccess:function(t,i){var n=$(t),o=this,r=n.attr("data-status")-0,a=n.attr("data-type");switch(n.attr("data-status",r?0:1).attr("data-bn-ipg",e[a]["data-bn-ipg"]({type:o.type,id:o.id,status:r})).toggleClass("selected").find("span.fonts").text(e[a][r?"text":"sText"]),o.preventUnnecessary(t,!0),a){case o.beento:"country"!=o.type&&"city"!=o.type||r?"poi"!=o.type||r||o.writePoiComment():o.execAddToPlan(i.data.poi_not_count,i.data.isaddimpress);break;case o.lived:"country"!=o.type&&"city"!=o.type||r||require(["common/component/shareExp/shareExp"],function(t){t.show({id:o.id,type:o.type})})}},handleError:function(t,e){var i=this;this.preventUnnecessary(t,!0),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg||i.errorTip,type:"warning"})})},execAddToPlan:function(t,e){var i=PLACE.TYPE,n=PLACE.PID;o(n,i,t,e)},writePoiComment:function(){var t=this;return!(!PLACE||!PLACE.CITYID)&&void r.show({poiid:t.id,source_type:"C-des-beento",onsucceed:function(t){requirejs(["common/component/switchRoute/switchRoute"],function(t){t.show({onOKFn:function(){requirejs(["common/component/footprint/js/comment"],function(t){t.commShow({city_id:PLACE.CITYID,source_type:"C-des-leftTopBtn"})})},onCancelFn:function(){window.location.reload()}})})}})},batchPoiComment:function(){requirejs(["common/component/footprint/js/comment"],function(t){t.commShow({city_id:PLACE.PID,source_type:"C-des-batchComment"})})},submenu:function(t){if(!qyerUtil.isLogin())return qyerUtil.doLogin(),!1;var e=$(t.currentTarget),i=this;if(!e.hasClass("js-cancelFootprint")){qyerUtil.doTrackCode(e.attr("data-bn-ipg"));var n=e.attr("href");return e.hasClass("js-poiComment")?"poi"==i.type?i.writePoiComment():i.batchPoiComment():"string"==typeof n&&"javascript:void(0)"!=n&&(window.document.location.href=n),t.stopPropagation(),!1}}},{ATTRS:{planto:"planto",beento:"beento",lived:"lived",addToPlan:"addToPlan",place:{name4:"country",name1:"city",name2:"poi"},reversePlace:{poi:2,country:4,city:1},errorTip:"操作失败,请刷新页面重试"}})}),define("project/js/qyguide",[],function(){var t=$("#qyGuide"),e=t.find(".plcQYGuidePage em");require(["project/js/slider"],function(i){i({prev:t.find(".prev"),next:t.find(".next"),content:t.find(".plcQYGuideContent"),beforeAnimate:function(t){e.text(++t)}})}),t.on("click",".download a",function(t){var e=$(this).parents("li").attr("data-id");require(["project/js/qyguide_download"],function(t){t(e)})}),$(".js-guideBatchDown").on("click",function(){requirejs(["common/component/guideBatchdownload/guideBatchdownload"],function(t){t.show({id:PLACE.PID,type:PLACE.TYPE})})})}),define("project/js/tab",[],function(){function t(t){this._tab=t.tab,this._content=t.content,this._onChanged=t.onChanged,this._eventType=t.eventType||"click"}function e(e){var i=new t(e);return i.init(),i}return t.prototype.change=function(t){var e=this._tab.find("li").eq(t),i=this._content.eq(t);e.addClass("current").siblings("li").removeClass("current"),this._content.hide(),i.show(),"function"==typeof this._onChanged&&this._onChanged(t,e[0],i[0])},t.prototype.init=function(){var t=this;this._tab.on(this._eventType,"li",function(){var e=$(this).index();t.change(e)}),this.change(0)},e}),define("project/js/slide",[],function(){function t(t){this._prev=t.prev,this._next=t.next,this._content=t.content,this._step=t.step||3,this._currentIndex=0,this._length=0,this._list=$(),this._liWidth=t.liWidth||335}function e(e){var i=new t(e);return i.init(),i}return t.prototype.doPrev=function(){this._currentIndex-this._step<0?this._currentIndex=0:this._currentIndex-=this._step,this._next.removeClass("disabled"),this.animate(this._currentIndex),0==this._currentIndex&&this._prev.addClass("disabled")},t.prototype.doNext=function(){this._currentIndex+this._step+this._step>this._length-1?this._currentIndex=this._length-this._step:this._currentIndex+=this._step;var t=this._currentIndex+this._step,e=this._list.find("li:lt("+t+")");e.each(function(t,e){var i=$(this).find("img[data-original]");i.each(function(t,e){var i=$(this).attr("src"),n=$(this).attr("data-original");i!==n&&$(this).attr("src",n)})}),this._prev.removeClass("disabled"),this.animate(this._currentIndex),this._currentIndex+this._step==this._length&&this._next.addClass("disabled")},t.prototype.animate=function(t){this._list.stop(!0).animate({left:-(t*this._liWidth)},500)},t.prototype.init=function(){var t=this;this._list=this._content.find("ul"),this._length=this._list.find("li").length,this._list.css("width",this._liWidth*this._length),this._length<=this._step||(this._prev.addClass("disabled"),this._prev.on("click",function(e){e.preventDefault(),t.doPrev()}),this._next.on("click",function(e){e.preventDefault(),t.doNext()}))},e}),define("project/js/biz",[],function(){function t(t){if(!(page_count<2)){var i=view_width*page_count;s.width(i),e(),a.hover(function(){window.clearTimeout(timer)},function(){n(page)}),r()}}function e(){for(var t=[],e=0;e<page_count;e++)t.push("<span></span>");l.append(t),l.find("span").eq(0).addClass("current"),l.on("click","span",function(){var t=$(this).index();page=t,i(t),n(t)})}function i(t){l.find("span").eq(t).addClass("current").siblings("span").removeClass("current")}function n(t){window.clearTimeout(timer);var e=view_width*t;s.stop(!0,!0).animate({left:-e},400,function(){r()})}function o(){page++,page>page_count-1&&(page=0)}function r(){timer=window.setTimeout(function(){o(),n(page),i(page)},5e3)}var a=$("#hotelScrollBox"),s=a.find("ul"),c=s.find("li"),l=a.next(".pages"),u=c.length,d=c.eq(0).outerWidth();view_width=4*d,page_count=u/4,page=0,timer=null,t()}),define("common/basic/js/require-css!common/ui/tip/tip",[],function(){}),define("common/ui/tip/tip",["css!common/ui/tip/tip.css"],function(){function t(t){n.html(t.text||"&nbsp;"),i[0].className="qui-tip-box","error"==t.type?i.addClass("qui-tip-box-error"):"warning"==t.type&&i.addClass("qui-tip-box-warning")}var e,i,n,o=jQuery;!function(){var t=['<div class="qui-tip" style="display:none;" >','<div class="qui-tip-box">','<span class="qui-tip-text fontYaHei">这里是提示文本</span>',"</div>","</div>"].join("");e=o(t),n=e.find(".qui-tip-text"),i=e.find(".qui-tip-box"),e.appendTo(document.body)}();var r={_timer:null,tip:function(i){return t(i),e.slideDown(200),window.clearTimeout(this._timer),this._timer=setTimeout(function(){e.slideUp(200)},i.time||3e3),this}};return r}),define("common/component/copyPlan/copyPlan",["common/ui/popup/popup","common/ui/tip/tip"],function(t,e){var i=jQuery,n={copyPlan:function(t){t.posturl="/ajax.php?action=copyplan",qyerUtil.doAjax(t)},getToken:function(t){t.posturl="/ajax.php?action=getplantoken",qyerUtil.doAjax(t)}},o={show:function(o){function r(){var r=o.planid;t.show({title:"给行程起个名字吧",width:460,contentHTML:'<div><input class="ui3_input js_planname" placeholder="请输入行程名称" style="width:400px;"/></div>',onOK:function(){var s=i(t.getContent()).find(".js_planname").val();return(s=i.trim(s))?s.length>18?(e.tip({text:"标题最多18个汉字",type:"warning"}),!1):(n.copyPlan({data:{planid:r,title:s,token:a},onSuccess:function(i){e.tip({text:"行程复制成功",type:"ok"}),t.hide(),o.isJump===!0&&qyerUtil.openUrl(i.data.url),o.onSuccess&&o.onSuccess(i.data),r=s=null},onError:function(i){e.tip({text:i.data.msg,type:"error"}),t.setOption({showLoadBtn:!1,showOKBtn:!0})}}),t.setOption({showLoadBtn:!0,showOKBtn:!1}),!1):(e.tip({text:"请输入行程名称",type:"warning"}),!1)}})}var a;qyerUtil.isLogin()?r():n.getToken({onSuccess:function(t){a=t.data,r()},onError:function(t){e.tip({text:t.data.msg,type:"error"})}})}};return o}),define("project/js/discuss",[],function(){function t(t,e,i,n){var o="/city.php?action=ajaxtravel";"recommend"==$("#plcTravelSort").find(".current").attr("data-type")&&(o="/city.php?action=ajaxrecommendthreads");var i=i||"hot";t.addClass("plcListLoading"),$.getJSON(o,{page:e,type:PLACE.TYPE,pid:PLACE.PID,sort:i},function(e){t.removeClass("plcListLoading");var i=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");i.list.length>0?r.hide():r.show();var a=$("#travelTmpl").html(),s=juicer(a,i);t.html(s),o.html(i.pagehtml),"function"==typeof n&&n()})}function e(t,e,i){var n="/city.php?action=ajaxask";t.addClass("plcListLoading"),$.getJSON(n,{page:e,type:PLACE.TYPE,pid:PLACE.PID},function(e){t.removeClass("plcListLoading");var n=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");n.list.length>0?r.hide():r.show();var a=$("#askTmpl").html(),s=juicer(a,n);t.html(s),o.html(n.pagehtml),"function"==typeof i&&i()})}function i(t,e,i){var n="/city.php?action=ajaxpartner";t.addClass("plcListLoading"),$.getJSON(n,{page:e,type:PLACE.TYPE,pid:PLACE.PID},function(e){t.removeClass("plcListLoading");var n=e.data,o=t.siblings(".plcDiscussPage"),r=t.siblings(".plcDiscussContentEmpty");n.list.length>0?r.hide():r.show();var a=$("#partnerTmpl").html(),s=juicer(a,n);t.html(s),o.html(n.pagehtml),"function"==typeof i&&i()})}function n(t,e,i,n){var o="/city.php?action=ajaxcomment";return i=!!i,i&&!qyerUtil.isLogin()?void qyerUtil.doLogin():(t.addClass("plcListLoading"),void $.getJSON(o,{page:e,type:PLACE.TYPE,pid:PLACE.PID,friendFirst:i},function(e){t.removeClass("plcListLoading");var o=e.data,r=t.siblings(".plcDiscussPage"),a=t.siblings(".plcDiscussContentEmpty");a.hide(),0==o.list.length&&(i?a.filter("[data-type=friend]").show():a.filter("[data-type=all]").show());var s=$("#commentTmpl").html(),c=juicer(s,o);t.html(c),r.html(o.pagehtml),"function"==typeof n&&n(),requirejs(["common/ui/textArea/textArea"],function(){t.find(".qui-textArea").qyerTextArea({max:140,min:10})})}))}function o(){var t=$(".plcDiscussMain").offset().top;t-=50,$("body,html").animate({scrollTop:t})}require(["project/js/tab"],function(o){o({tab:$(".plcDiscussTags"),content:$(".plcDiscussContent"),onChanged:function(o,r,a){var s=$(a).children("ul"),c=s.text();if(""==$.trim(c)){var l=$(r).attr("data-type");switch(l){case"ask":e(s,1);break;case"travel":t(s,1);break;case"partner":i(s,1);break;case"comment":$("#commentListFriendPrior")[0].checked=!1,n(s,1)}}}})}),$("#plcTravelLists").on("click",".ui_page a",function(){var e=$(this).attr("data-page"),i=$(".plcTravelList"),n=$("#plcTravelSort .current").attr("data-type");t(i,e,n,function(){o()})}),$("#plcAskLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),i=$(".plcAskList");e(i,t,function(){o()})}),$("#plcPartnerLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),e=$(".plcPartnerList");i(e,t,function(){o()})}),$("#plcCommentLists").on("click",".ui_page a",function(){var t=$(this).attr("data-page"),e=$(".plcCommentList"),i=$("#commentListFriendPrior").is(":checked");n(e,t,i,function(){o()})}),$("#plcTravelSort").on("click","span",function(){if(!$(this).hasClass("current")){$(this).addClass("current").siblings("span").removeClass("current");var e=$(this).attr("data-type"),i=$(".plcTravelList");t(i,1,e)}}),$("#commentListFriendPrior").on("change",function(){var t=$(this)[0].checked,e=$(".plcCommentList");n(e,1,t)}),$(".plcCommentList").on("click",".praise",function(){var t=this,e="/api.php?action=useful",i=$(this).parents("li[data-id]").attr("data-id");return qyerUtil.isLogin()?void $.post(e,{type:2,pid:i},function(e){if(0==e.error_code){var i=$(t).text();i=parseInt(i,10),$(t).text(++i),$(t).removeClass("praise").addClass("praised"),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg_impel})})}else $(t).removeClass("praise").addClass("praised"),requirejs(["common/ui/tip/tip"],function(t){t.tip({text:e.data.msg,type:"warning"})})},"json"):void qyerUtil.doLogin()}),$(".plcCommentList").on("click",".plcCommentUserCnts .replyBtn",function(){var t=$(this).parents(".plcCommentUserCnts").next(".plcCommentUserReplys");t.is(":hidden")?t.slideDown(function(){var t=$(this).parents("li[data-id]"),e=t.find(".title a:eq(0)").text(),i="回复 @"+e+"：";$(this).find("textarea").focus().val(i)}):t.slideUp()}),$(".plcCommentList").on("click",".plcCommentUserReplys .replyBtn",function(){var t=$(this).parent().parent("li[data-id]"),e=t.parents(".plcCommentUserReplys").find("textarea"),i=t.find(".title a:eq(0)").text(),n="回复 @"+i+"：";e.focus().val(n)}),$(".plcCommentList").on("click",".qui-textArea :button",function(){var t=$(this).parents(".qui-textArea"),e=t.children("textarea");if($li=$(this).parents("li[data-id]"),cid=$li.attr("data-id"),$replyList=$li.find(".msglist"),!qyerUtil.isLogin())return void qyerUtil.doLogin();var i=t.qyerTextArea("isValidate");if(!i)return void requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"你输入的字数不符合要求",type:"error"})});var n="/api.php?action=replycomment";$.post(n,{cid:cid,type:2,reply:e.val()},function(t){if(0!=t.error_code)return void requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"回复错误",type:"error"})});var e=t.data,i=$("#replyTmpl").html(),n=juicer(i,e);$replyList.prepend(n);var o=$li.find(".replyBtn"),r=o.find("span"),a=parseInt(r.text());a++,r.text(a)},"json")})}),define("project/js/followuser",[],function(){function t(t,e){var i="/ajax.php?action=addfriend";return qyerUtil.isLogin()?void $.post(i,{fuid:t},function(t){0==t.error_code?"function"==typeof e&&e():requirejs(["common/ui/tip/tip"],function(e){e.tip({text:t.data.msg,type:"warning"})})},"json"):void qyerUtil.doLogin()}return t}),define("common/component/shareExp/shareExp",["common/ui/popup/popup","common/ui/tip/tip","common/ui/textArea/textArea"],function(t,e){function i(t){this.option={id:0,type:"city",title:"&nbsp;",pText:"一个瞬间？一个贴士？有什么想和大家分享的就说说吧",getExpUrl:"/country.php?action=showimpress",shareExpUrl:"/country.php?action=impress",textareaVal:"",onSuccess:function(){},onHide:function(){}},n.extend(this.option,t),this.init()}var n=jQuery;i.prototype={init:function(){this.getMyExp()},getExp:function(t){t.posturl=this.option.getExpUrl,qyerUtil.doAjax(t)},shareExp:function(t){t.posturl=this.option.shareExpUrl,qyerUtil.doAjax(t)},getMyExp:function(){var t=this;this.getExp({data:{id:t.option.id,type:t.option.type},onSuccess:function(e){t.option.textareaVal=e.data.text,"&nbsp;"==t.option.title&&(t.option.title="说说我的"+e.data.placeName),t.showExpPop()},onError:function(t){t.__server_error__?e.tip({text:"服务器连接错误，请稍后再试",type:"error"}):e.tip({text:t.data.msg,type:"error"})}})},showExpPop:function(){var i=this;t.show({title:i.option.title,width:440,contentHTML:['<div style="position:relative;">',"<p>"+i.option.pText+"</p>",'<div id="shareExpUnit" class="qui-textArea" data-width="400" data-height="120" style="margin-top:10px;">','<textarea id="shareExpTextarea" placeholder="不超过120个汉字" class="ui2_textarea" style="width:400px;height:120px;border:1px solid #cccccc;padding:5px;">'+i.option.textareaVal+"</textarea>",'<div class="tips" style="position:absolute;bottom:-20px;">','<span class="current"></span>/<span class="max"></span>',"</div>","</div>","</div>"].join(""),okText:"发表",onShow:function(){n("#shareExpUnit").qyerTextArea({max:120})},onOK:function(){var o=n("#shareExpUnit").qyerTextArea("isValidate");return o?i.shareExp({data:{id:i.option.id,type:i.option.type,text:n("#shareExpTextarea").val()},onSuccess:function(o){e.tip({text:o.data.msg}),t.hide(),n.isFunction(i.option.onSuccess)&&window.setTimeout(function(){i.option.onSuccess.call(i)},300)},onError:function(t){t.__server_error__?e.tip({text:"服务器连接错误，请稍后再试",type:"error"}):e.tip({text:t.data.msg,type:"error"})}}):e.tip({text:"输入文字超出限制",type:"error"}),!1},onCancel:function(){n.isFunction(i.option.onHide)&&i.option.onHide.call(i)}})}};var o={show:function(t){if(!qyerUtil.isLogin())return void qyerUtil.doLogin();new i(t)}};return o}),define("common/basic/js/require-css!common/ui/inputAutocomplete/inputAutocomplete",[],function(){}),define("common/ui/inputAutocomplete/inputAutocomplete",["css!common/ui/inputAutocomplete/inputAutocomplete.css"],function(){function t(t){this.$obj=t.$obj,this.timer=null,this.isSearching=!1,this.autoSelect=!1,this.$contentDiv=null,this.option=t.option,t.option.parent&&(this.$parent=e(t.option.parent)),this.init()}var e=jQuery;t.prototype={$obj:null,timer:null,option:null,isSearching:!1,autoSelect:!1,$contentDiv:null,$parent:null,init:function(){this.createDomNode(),this.bindEvent()},createDomNode:function(){var t=['<div class="qui-inputAutocomplete" style="display:none;">','<ul class="qui-inputAutocomplete-ul" >','<li class="disableDefalut">loading ... </li>',"</ul>","</div>"].join("");this.$contentDiv=e(t);var i={width:this.$obj.outerWidth()};if(!this.$parent){var n=this.$obj.offset();i.top=n.top+this.$obj.outerHeight(),i.left=n.left,n=null}this.$contentDiv.css(i),this.$contentDiv.appendTo(this.$parent||document.body),t=i=null},_blurTimer:null,bindEvent:function(){var t=this;this.$obj.keyup(function(i){if(e.inArray(i.keyCode,[37,39])==-1)return 9==i.keyCode?(t.$contentDiv.hide(),void(t.option.onVoid&&t.option.onVoid(t.$obj[0]))):void(e.inArray(i.keyCode,[38,40,13])!=-1?t.updateUI(i.keyCode):e.trim(t.$obj.val())||t.option.isAllowEmptySeach?t.registSearch():(t.$contentDiv.hide(),t.option.onVoid&&t.option.onVoid(t.$obj[0])))}).blur(function(){t._blurTimer=window.setTimeout(function(){t.$contentDiv.is(":hidden")||t.option.isBlurClose!==!1&&t.$contentDiv.hide()},300)}),this.option.isFocusedSeach&&this.$obj.focus(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&t.registSearch()}),this.$contentDiv.delegate(".qui-inputAutocomplete-ul li","click",function(i){return i.target.className.indexOf("disableDefalut")!=-1?(i.stopPropagation(),void window.clearTimeout(t._blurTimer)):void(this.className.indexOf("disableDefalut")==-1&&(t.$obj.val(e(this).text()),t.$contentDiv.hide(),t.option.onSelect&&(t.option.onSelect.call(t.$obj[0],this),t.$contentDiv.html(""))))})},registSearch:function(){var t=this;this.isSearching=!1,
window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&(t.isSearching=!0,t.showContentDiv(),t.option.onSearch.call(t.$obj[0]))},300)},showContentDiv:function(){var t=this;this.$contentDiv.is(":hidden")&&(this.$contentDiv.show(),e(document).one("click",function(e){t.option.isBlurClose!==!1&&t.$contentDiv.hide()}))},updateUI:function(t){function i(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e+1),t.length||(t=o.find("li:eq(0)"))):t=o.find("li:eq(0)"),t.attr("data-select","true"),t=null}function n(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e-1),t.length||(t=o.find("li:eq("+(r-1)+")"))):t=o.find("li:eq("+(r-1)+")"),t.attr("data-select","true"),t=null}if(!this.$contentDiv.is(":hidden")){var o=this.$contentDiv.find(".qui-inputAutocomplete-ul"),r=o.find("li:not(.disableDefalut)").size();if(r&&(e.inArray(t,[38,40])!=-1&&(40==t?i():n()),this.option.enterSelect!==!1&&13==t)){var a=o.find("li[data-select=true]");a.length?(this.$obj.val(a.text()),this.option.onSelect&&(this.option.onSelect.call(this.$obj[0],a[0],!0),this.$contentDiv.html("")),this.$contentDiv.hide()):this.option.isBlurClose!==!1&&this.$contentDiv.hide()}}},pushHTML:function(t){var e={width:this.$obj.outerWidth()};if(!this.$parent){var i=this.$obj.offset();e.top=i.top+this.$obj.outerHeight(),e.left=i.left,i=null}this.$contentDiv.css(e).html(t).show(),this.isSearching=!1,e=null;var n=this.$contentDiv.find(".qui-inputAutocomplete-ul > li:not(.disableDefalut)");n.length&&this.autoSelect!==!1&&n.eq(0).attr("data-select","true"),n=null},isShow:function(){return!this.$contentDiv.is(":hidden")},hide:function(){return this.$contentDiv.hide()},destroy:function(){this.$contentDiv.remove()}},e.fn.extend({qyerAutocomplete:function(i){var n,o,r=arguments;return e.each(this,function(a,s){n=e(s),"object"==e.type(i)?n.data("_autocomplete",new t({$obj:n,option:i})):"pushHTML"==i?n.data("_autocomplete").pushHTML(r[1]):"getContent"==i?o=n.data("_autocomplete").$contentDiv:"isShow"==i?o=n.data("_autocomplete").isShow():"hide"==i?n.data("_autocomplete").hide():"destroy"==i&&(n.data("_autocomplete").destroy(),n.data("_autocomplete",null))}),n=r=null,"undefined"==typeof o?this:o}})}),define("common/basic/js/require-css!common/component/openAsk/openAsk",[],function(){}),define("common/component/openAsk/openAsk",["common/ui/popup/popup","common/ui/tip/tip","common/ui/textArea/textArea","common/ui/inputAutocomplete/inputAutocomplete","common/ui/inputValidation/inputValidation","css!common/component/openAsk/openAsk.css"],function(t,e){function i(t){n.extend(this.option,this.defaultOption),this.option=t,this.init()}if("undefined"!=typeof jQuery){var n=jQuery,o=function(t){var e=[{from:11,name:"place_profile",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/(profile|citytransport|when-to-go|cost|information|advice|ctytransport|ncost|pracinfo|nadvice|whentogo|carrental|ctyprofile|nvisa|transportation)/},{from:12,name:"place_travelnote",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+\/travel-notes/},{from:13,name:"place_city",reg:/^http(s)?:\/\/place\.qyer\.com\/[^\/]+/},{from:14,name:"bbs_forum",reg:/^http(s)?:\/\/bbs\.qyer\.com\/forum-[^\/]+/},{from:15,name:"bbs_index",reg:/^http(s)?:\/\/bbs\.qyer\.com\/?\??/},{from:16,name:"ask_tags",reg:/^http(s)?:\/\/ask\.qyer\.com\/tags/},{from:17,name:"ask_detail",reg:/^http(s)?:\/\/ask\.qyer\.com\/question\/\d+/},{from:18,name:"ask_search",reg:/^http(s)?:\/\/ask\.qyer\.com\/search/},{from:19,name:"ask_index",reg:/^http(s)?:\/\/ask\.qyer\.com\/?\??/},{from:20,name:"search_ask",reg:/^http(s)?:\/\/search\.qyer\.com\/ask/},{from:21,name:"ucenter_ask",reg:/^http(s)?:\/\/www\.qyer\.com\/u\/\d+\/ask/}],i=function(){for(var t,i=window.location.href,n=0,o=e.length;n<o;n+=1){var r=e[n];if(r.reg.test(i)){t=r.from;break}}return t||0};return t||i()};n.ajaxSetup({traditional:!0}),i.prototype={option:null,popup:null,tags:[],forums:{},defaultOption:{fid:0,from:0},getFNameByID:function(t){var e=this.forums,i=[];for(var n in e)i=i.concat(e[n]);for(var o=0;o<i.length;o++)if(i[o].id==t)return i[o].name},API:{baseURL:/^bbs\.qyer\.com/.test(location.host)?"/qyerajax.php":"/ajax.php",getTagByString:function(t){t.posturl=this.baseURL+"?action=maketag&ispopup=1&returnjson=1",window.qyerUtil.doAjax(t)},getTagByTag:function(t){t.posturl=this.baseURL+"?action=TopicMenu",window.qyerUtil.doAjax(t)},submitForm_openAsk:function(t){t.posturl="/qcross/ask/json/askpopup",window.qyerUtil.doAjax(t)}},init:function(){this.initFrame()},checkOpenAskForm:function(){var i=n(t.getContent()),r=i.find("input[name='js_question_title']"),a=i.find("input[name='js_ask_fid']"),s={error:!1,data:{}};if(0==r.qyerInputValidation())return s.error=!0,s;if(this.tags.length<1)return e.tip({text:"没有标签的问题，石沉大海，无人回答哦",type:"error"}),s.error=!0,s;if(s.error===!1){s.data={title:i.find("input[name='js_question_title']").val(),content:i.find("textarea[name='js_ask_content']").val(),"tag[]":[],fid:i.find("input[name='js_ask_fid']").val(),from:o()};for(var c=0,l=this.tags.length;c<l;c++)s.data["tag[]"].push(this.tags[c])}return i=r=$tag=a=null,s},_bindEvt:function(){var i=n(t.getContent()),o=i.find(".js-dropmenu"),r=i.find(".js-dropmenu-popup"),a=i.find("input[name='js_ask_fid']"),s=this;i.off("click.popup").on("click.popup",".js-btn-submit-openAsk",function(){var i=s.checkOpenAskForm(),o=n(this);o.hasClass("ui_button_load")||i&&i.error===!1&&(s.setBtnStatus(o,1),opt={data:i.data,onSuccess:function(i){("undefined"==typeof s.option.onSuccess||"function"==typeof s.option.onSuccess&&s.option.onSuccess(i.data)!==!1)&&o.next().attr("target",s.option.target||"_self").attr("href",i.data.jumpurl)[0].click(),s.setBtnStatus(o,0),t.hide(),e.tip({text:"提问成功！经验+1"})},onError:function(t){s.option&&s.option.onError&&"function"==n.type(s.option.onError)&&s.option.onError(),s.setBtnStatus(o,0),e.tip({text:t.__server_error__?"服务器响应失败，请重试":t.data.msg,type:"error"})}},s.API.submitForm_openAsk(opt))}).on("click",".js-btn-cancel-openAsk",function(){t.hide()}).on("click",".js-dropmenu",function(){r.toggleClass("hide"),o.toggleClass("open")}).on("click",".js-dropmenu-popup .item a",function(){var t=n(this);o.toggleClass("open").find("em").text(t.text()),r.toggleClass("hide"),a.val(t.attr("data-id"))}).on("blur",'input[name="js_question_title"]',function(){s.searchTag(n(this).val())}).on("click",".js-btn-tag-close",function(){s.removeATag(n(this).parent())})},setBtnStatus:function(t,e){0===e?t.removeClass("ui_button_load ui_button_disabled").addClass("ui_button"):t.removeClass("ui_button").addClass("ui_button_load")},getForumSublistHTML:function(t,e){var i=18,e=e||1,o=i*(e-1),r=i*e-1,a="";return n.each(this.forums[t],function(t,e){var i="";if(t>=o&&t<=r){var i='<dd class="js-bbs"><a data-id="'+e.id+'" href="javascript:void(0);">'+e.name+"</a></dd>";a+=i}}),a},getTpl:function(){var t=['<h2 class="openAsk-askTitle fontYaHei p20 mt20">提问</h2>','<div class="qui-textArea openAsk-title p20" data-width="720" data-height="32">','<input placeholder="输入完整清晰的问题" class="ui2_textarea bs" name="js_question_title"/>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字',"</div>","</div>",'<h2 class="openAsk-contentTitle fontYaHei p20">详细内容<em class="fz12">(可选)</em></h2>','<div class="qui-textArea openAsk-content clearfix p20" data-width="720"  data-height="128">','<textarea placeholder="在这里添加详细内容" class="ui2_textarea bs" name="js_ask_content"></textarea>','<div class="tips">','<span class="current"></span>/<span class="max"></span>字</div>',"</div>",'<dl class="tags bs p20">','<dt class="tag-title vm">标签：</dt>','<p class="tag-input-ribbon vm">','<input type="text" value="" placeholder="添加标签" class="tag-input js-tag-input" />',"</p>","</dl>",'<div class="ask-bottom-box p20 bs">','<div class="publish-box js-dropmenu">','<em class="publish-title">选择同时发布的论坛版面</em><span class="publish-arrow"></span>',"</div>\t\t\t",'<input type="button" class="ui_button fr js-btn-submit-openAsk" value="提问"/>',"<a></a>",'<input type="button" style="margin-right:10px;" class="ui_button_cancel fr mr10 js-btn-cancel-openAsk" value="取消" />','<div class="js-dropmenu-popup bbs-container hide">','<div class="item">',"<dl>","<dt>穷游兴趣小组</dt>",this.getForumSublistHTML("穷游兴趣小组"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游欧洲</dt>",this.getForumSublistHTML("穷游欧洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游亚洲</dt>",this.getForumSublistHTML("穷游亚洲",1),"</dl>","</div>",'<div class="item">',"<dl>",this.getForumSublistHTML("穷游亚洲",2),"</dl>","</div>",'<div class="item">',"<dl>","<dt>穷游美洲</dt>",this.getForumSublistHTML("穷游美洲"),"</dl>","<dl>","<dt>穷游大洋洲</dt>",this.getForumSublistHTML("穷游大洋洲"),"</dl>","<dl>","<dt>穷游非洲</dt>",this.getForumSublistHTML("穷游非洲"),"</dl>","</div>",'<div class="item">',"<dl>","<dt>线上线下</dt>",this.getForumSublistHTML("线上线下"),"</dl>","<dl>","<dt>后院</dt>",this.getForumSublistHTML("后院"),"</dl>","</div>","</div>","</div>",'<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="tag[]" />','<input type="hidden" name="js_ask_fid" />','<input type="hidden" name="js_ask_oper" />','<input type="hidden" name="js_ask_from" />'].join("");return t},initFrame:function(){var e=this;t.show({contentHTML:'<div style="padding:100px; text-align:center;">loading</div>',width:760,title:"提问",exClassName:"qui-openAskContainer",showTitle:!1,showOKBtn:!1,showCancelBtn:!1,onShow:function(){var i="/qcross/bbs/thread.php?action=getForums";n.get(i,function(i){var n;0==i.error_code?(e.forums=i.data,n=e.getTpl(),t.setContent(n),e._initComponent(),e._bindEvt()):t.hide()},"json")}})},encode:function(t){var e="";return 0==t.length?"":(e=t.replace(/&/g,"&gt;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br>"))},_initComponent:function(){var e=this,i=n(t.getContent()),o=i.find(".js-tag-input"),r=i.find(".openAsk-title");i.find("input[name='js_ask_fid']").val(e.option.fid),i.find(".publish-title").html(e.getFNameByID(e.option.fid)),i.find("input[name='js_ask_from']").val(e.option.from),i.find("input[name='js_ask_oper']").val(1),i.find(".openAsk-title").qyerTextArea({min:1,max:50}).end().find(".openAsk-content").qyerTextArea({max:1e3}).end().find("input[name='js_question_title']").qyerInputValidation({parent:r[0],text:"至少写够1个字，最多不超过50字",exp:function(t){return/^.{1,50}$/.test(t)}}).end().find(".js-tag-input").qyerAutocomplete({parent:o.parent()[0],onSearch:function(){function t(t){var e,i=[],n=t.data.item,o=n.length;if(o<1)i.push('<div class="qui-inputAutocomplete-noResult">没有找到任何结果</div>');else{for(e=0;e<o;e++)i.push("<li data-tag="+n[e]+"><em>"+n[e]+"</em></li>");i.unshift('<ul class="qui-inputAutocomplete-ul js-inputAutoComplete">'),i.push("</ul>")}return i.join("")}var i=o.val(),r={data:{keyword:i},onSuccess:function(e){if(e&&e.data&&"array"==n.type(e.data.item))try{o.qyerAutocomplete("pushHTML",t(e))}catch(i){}},onError:function(e){o.qyerAutocomplete("pushHTML",t(e))}};e.API.getTagByTag(r)},onSelect:function(t){e.addATag(t.getAttribute("data-tag")),o.val("")}})},searchTag:function(t){if(t){var e=this,i={data:{title:t},onSuccess:function(t){var i,n,o=t.data;if(o)for(n=0,i=t.data.length;n<i;n++)e.addATag(o[n])},onError:function(t){}};this.API.getTagByString(i)}},addATag:function(e){var i=n(t.getContent()).find(".tag-input-ribbon");this.tagIndexOfTags(e,this.tags)<0&&this.tags.length<5&&n.trim(e).length>0&&(n('<dd class="tag-item vm" title="'+e+'"><span class="tag">'+this.encode(e)+'</span><span class="btn-tag-close js-btn-tag-close"></span></dd>').insertBefore(i),this.tags.push(e),5==this.tags.length&&i.hide()),i=null},removeATag:function(t){var e=t.find(".tag").text(),i=this.tagIndexOfTags(e,this.tags);t.animate({marginTop:-40,opacity:0},200,function(){t.siblings(".tag-input-ribbon").show().end().remove()}),this.tags.splice(i,1),e=i=null},tagIndexOfTags:function(t,e){var i,n;for(i=0,n=e.length;i<n;i++)if(t===e[i])return i;return-1}};var r={qyerOpenAsk:function(t){window.qyerUtil.isLogin()?new i(t||{}):window.qyerUtil.doLogin()}};return r}}),define("common/basic/js/require-css!common/component/mguideManagePlatform/mguideManagePlatform",[],function(){}),define("common/component/mguideManagePlatform/mguideManagePlatform",["common/ui/tip/tip","common/ui/popup/popup","css!common/component/mguideManagePlatform/mguideManagePlatform.css"],function(t,e){function i(t){var e=this;this.defaults={data:{index:1,title:"可以俯瞰巴黎城市的观景点介绍",author:"蝎之传说",id:"123",from:1},exClass:"",tpl:['<li class="mguideManageList fontYaHei" tid="__&id&__">','<span class="index ___&getClass&_">__&index&__</span>','<span class="title ___&getClass&_">__&title&__</span>','<span class="author">__&author&__</span>','<span class="remove"><a href="javascript:void(0)">移除运营位</a></span>',"</li>"].join(""),fnArray:{getClass:function(){var t=e.defaults.data;return t?1==t.from?"":"blue":""}}},this.defaults=$.extend(this.defaults,t||{})}function n(n){var a=function(){var t=window.location.href,e=t.match(/com\/[\w\-]+(\/(\w+)?\/?)?/),i="";return i=e[2]?e[2]:"default"}(),s={type:n&&n.type?n.type:PLACE.TYPE,pid:n&&n.pid?n.pid:PLACE.PID,classname:n&&n.classname?n.classname:a},c={onSuccess:function(o){if(!o.data.list||0==o.data.list.length)return void t.tip({text:"没有数据",type:"warning"});var a='<ul id="mguideManagePlatform">',c=o.data.list;$.each(c,function(t){var e=new i({data:c[t]});a+=e.getDom()}),a+="</ul>",e.show({contentHTML:a,onOK:function(){n&&n.onOK&&$.isFunction(n.onOK)&&n.onOK()},onCancel:function(){n&&n.onOK&&$.isFunction(n.onOK)&&n.onCancel()},title:"管理微锦囊运营位",width:700,showCancelBtn:!1}),$("#mguideManagePlatform").on("click",".remove",function(){var t=$(this),e=$(this).parents("li").attr("tid");r({id:e,type:s.type,pid:s.pid,classname:s.classname,callback:function(){t.parents("li").remove(),$("#mguideManagePlatform").find("li").each(function(t){var e=parseInt(t,10)+1;$(this).find(".index").html(e)})}})})},onError:function(e){t.tip({text:"请求错误",type:"warning"})}},l={data:s,onSuccess:c.onSuccess,onError:c.onError,url:o.getMguideList};n&&n.testData&&(l.testData=n.testData),qyerUtil.doAjax(l)}var o={removemguide:"/mguide.php?action=removeFromWhite",getMguideList:"/mguide.php?action=getBusinessList"};i.prototype.getDom=function(){var t=this;if(t.defaults.data){var e=t.defaults.tpl.replace(/___&[\w]{1,15}&_/g,function(e){var i=/___&([\w]{1,})&_/.exec(e)[1];return t.defaults.fnArray[i]?t.defaults.fnArray[i].call(t):""});e=e.replace(/__&[\w]{1,15}&__/g,function(e){var i=/__&([\w]{1,})&__/.exec(e)[1];return t.defaults.data[i]})}return t.dom=e,t.dom},i.prototype.setData=function(t){var e=this;e.defaults.data=t,e.getDom()},i.prototype.getData=function(){return me.defaults.data||""};var r=function(e){if(!e.id)return void t.tip({text:"缺少微锦囊ID",type:"warning"});if(""==$.trim(e.classname)){var i=window.location.href,n=i.match(/com\/[\w\-]+(\/(\w+)?\/?)?/),r="";r=n[2]?n[2]:"default",e.classname=r}qyerUtil.doAjax({data:{id:e.id,pid:e.pid||PLACE.PID,type:e.type||PLACE.TYPE,classname:e.classname},url:o.removemguide,testData:e.testData,onSuccess:function(i){t.tip({text:i.data.msg,type:i.data.icon||""}),$.isFunction(e.callback)&&e.callback.call(this,i)},onError:function(e){t.tip({text:"移除失败",type:"error"})}})},a={show:function(t){return qyerUtil.isLogin()?void n(t):void qyerUtil.doLogin()}};return a}),$(function(){function t(){require(["common/widget/userbehavior/widget-userbehavior"],function(t){new t({$el:$("#js-plcFootPrint"),type:1,id:PLACE.PID,exClass:"place-exClass"})})}$(".topTrackCode").on("click",function(){var t=$(this),e=t.hasClass("selected");qyerUtil.doTrackCode(t.attr("data-ipg-"+(e?"delete":"add")))}),$(".plcContainer:odd").addClass("odd"),$("img.lazy").lazyload({effect:"fadeIn"}),require(["project/js/slider"],function(t){var e=$("#focusPhoto");t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcFocusPhotoList")}),e.find(".photoAdmin").click(function(){requirejs(["common/component/manageCover/manageCover"],function(t){t.show({pid:PLACE.PID,type:PLACE.TYPE})})})}),window.__userStatusCallBack?(window.__userStatusCallBack_old=window.__userStatusCallBack,window.__userStatusCallBack=function(e){window.__userStatusCallBack_old.call(window,e),t.call(window,e)}):window.__userStatusCallBack=function(e){t.call(window,e)};var e={a:"scrollBox",b:"scrollBoxV4_0",c:"scrollBoxV5_0",d:"nativePeopleBox"};if($(".scrollBox,.scrollBoxV4_0,.scrollBoxV5_0,.nativePeopleBox").each(function(){var t=this;$(".change",t).bind("click",function(){if($(t).hasClass("loading"))return!1;$(t).addClass("loading");var i="http://place.qyer.com/city.php",n=t.getAttribute("data-group"),o=t.getAttribute("data-type"),r={action:"hotelchange",cityid:PLACE.PID,group:n,type:o,timer:(new Date).getTime()};$.getJSON(i,r,function(i){$(t).removeClass("loading scrollBoxV4_0 scrollBoxV5_0 scrollBox"),i.data.hotel_type&&$(t).addClass(e[i.data.hotel_type]),0==i.error_code&&($(t).find("ul").html(i.data.hotel_html),t.setAttribute("data-group",parseInt(n)+1))})})}),require(["project/js/slider"],function(t){var e=$("#expScrollModule"),i=3e3*e.find(".plcShareExpList li").eq(0).find(".text").length;t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcShareExpList"),autoPlay:!0,showTime:i})}),require(["project/js/qyguide"]),$(".plcHotCityContent").length>0&&require(["project/js/slider"],function(t){var e=$(".plcHotCityContent");t({prev:e.find(".prev"),next:e.find(".next"),content:e.find(".plcHotCityLists"),loop:!1,onAnimate:function(t,e){if(0!=t){var i=$(e).find("img[data-original]");i.each(function(t,e){var i=$(this).attr("src"),n=$(this).attr("data-original");i!==n&&$(this).attr("src",n)})}}})}),require(["project/js/tab"],function(t){t({eventType:"mouseenter",tab:$(".plcHotPlaceTags"),content:$(".plcHotPlaceContent"),onChanged:function(t,e,i){if(0!=t){var n=$(i).find("img[data-original]");n.each(function(t,e){var i=$(this).attr("src"),n=$(this).attr("data-original");i!==n&&$(this).attr("src",n)})}}})}),require(["project/js/slide"],function(t){t({content:$("#mguideLists"),prev:$("#mguidePagePrev"),next:$("#mguidePageNext")})}),require(["project/js/biz"]),require(["project/js/tab"],function(t){t({eventType:"mouseenter",tab:$(".plcRouteTags"),content:$(".plcRouteContent"),onChanged:function(t,e,i){if(0!=t){var n=$(i).find("img[data-original]");n.each(function(t,e){var i=$(this).attr("src"),n=$(this).attr("data-original");i!==n&&$(this).attr("src",n)})}}})}),require(["project/js/tab"],function(t){function e(t){$("#bigBtn_1,#bigBtn_2").hide(),t<3?$("#bigBtn_1").show():$("#bigBtn_2").show()}var i=t({eventType:"mouseenter",tab:$(".plcHotelTags"),content:$(".plcHotelContent"),onChanged:function(t){e(t)}}),n=Math.floor(10*Math.random())%$(".plcHotelTags li").length;i.change(n),e(n)}),$(".plcRouteContent .copyPlanBtn").on("click",function(){var t=$(this),e=t.parents(".plcRouteContent").attr("data-id");require(["common/component/copyPlan/copyPlan"],function(t){t.show({planid:e,isJump:!0})})}),require(["project/js/discuss"]),$(".plcDiscussRankuser .follow a").on("click",function(){var t=$(this).parent(),e=t.attr("data-id");require(["project/js/followuser"],function(i){i(e,function(){t.empty().text("已关注")})})}),$(".js-shareExpBtn").on("click",function(){var t=PLACE.PID,e=PLACE.TYPE;require(["common/component/shareExp/shareExp"],function(i){i.show({id:t,type:e})})}),$(".js-askBtn").on("click",function(){requirejs(["common/component/openAsk/openAsk"],function(t){t.qyerOpenAsk({onSuccess:function(){return!1}})})}),$("#plcMguideManage").length>0&&$("#plcMguideManage").on("click",function(){require(["common/component/mguideManagePlatform/mguideManagePlatform"],function(t){t.show()})}),"area"==PLACE.TYPE){var i=$("div.plcMenuBarHolder ul.plcMenuBarList").find("li");if(i.length<=5){i.css({width:Math.floor(780/i.length)});var n=$(".plcMenuBarLay");n.find(".layTitle").css("width",Math.floor(780/i.length)),$(".plcMenuBarLay").each(function(t,e){if($(e).addClass("smallMenuBarLay"),$(e).hasClass("poiDrop")){$(e).css({width:Math.floor(780/i.length)+3})}})}}}),define("project/js/area",function(){}),function(t){var e=document,i="appendChild",n="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][i](o),o[n]?o[n].cssText=t:o[i](e.createTextNode(t))}(".qui-popup{\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    background-image:url(http://common2.qyerstatic.com/place/common/basic/images/bg_255_255_255_0.7.png);\n    z-index: 1000;\n    overflow-y: auto;\n    opacity: 0;\n}\n.qui-popup > div{\n    display: table;\n    height: 100%;\n    margin: 0 auto;\n}\n.qui-popup-dt{\n    display: table-cell;\n    vertical-align:middle;\n}\n.qui-popup-box{\n    margin: 0 auto;\n    background-color: #fff;\n    position: relative;\n    -webkit-box-shadow: 0 0 6px #aaa;\n    -moz-box-shadow: 0 0 6px #aaa;\n    box-shadow: 0 0 6px #aaa;\n    border: solid 1px #ccc;\n    \n    opacity: 0;\n}\n.qui-popup-box-title{\n    height: 60px;\n    line-height: 60px;\n    font-size: 18px;\n    font-weight: bold;\n    padding-left: 20px;\n}\n.qui-popup-box-content{\n    -webkit-box-sizing: border-box; \n    -moz-box-sizing: border-box;  \n    box-sizing: border-box; \n    padding: 0 20px;\n}\n.qui-popup-box-content >iframe{\n    width: 100%;\n    border: none;\n}\n.qui-popup-box-bottom{\n    text-align: right;\n    height: 70px;\n    line-height: 70px;\n    padding-right: 20px;\n}\n.qui-popup-closeIcon{\n    position: absolute;\n    right: 10px;\n    top: 10px;  \n    cursor: pointer;\n    background-image: url(\"http://common2.qyerstatic.com/place/common/ui/popup/ico.png\");\n    height: 32px;\n    width: 32px;\n    background-repeat: no-repeat;\n    background-position:0 0;\n    border-radius: 5px;\n}\n.qui-popup-closeIcon:hover{\n    background-position: 0px -38px;\n}\n.qui-popup-cancelBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-okBtn{\n    vertical-align: middle;\n    margin-left:10px;\n}\n.qui-popup-loadingBtn{\n    vertical-align: middle;\n    display: none;\n    margin-left:10px;\n}.qui-errorip{\n    border: 1px solid #d0312b !important; \n}\n.qui-errorip-textDiv{border:solid 1px #d0312b; background-color: #ffcccd; color:#88777c; position: absolute; z-index: 2000; }\n.qui-errorip-textDiv > .tip{display: block; position: absolute; left: 5px; top: 0; }\n.qui-errorip-textDiv > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv > .tip > .a1{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #CB0013; }\n.qui-errorip-textDiv > .tip > .a2{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #FFCCCD; }\n.qui-errorip-textDiv > .text{padding: 0 5px; }\n.qui-errorip-textDiv1 {border:solid 1px #ebb75a; background-color: #fff894; color:#222222; position: absolute; z-index: 2000;border-radius: 3px; }\n.qui-errorip-textDiv1 > .tip{display: block; position: absolute; left: 50%; bottom: -5px;margin-left: -5px; }\n.qui-errorip-textDiv1 > .tip > p{position:absolute; width:0; height:0; }\n.qui-errorip-textDiv1 > .tip > .a1{top:-4px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #ebb75a; }\n.qui-errorip-textDiv1 > .tip > .a2{top:-5px; left:0; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #fff894; }\n.qui-errorip-textDiv1 > .text{max-width: 300px; overflow: hidden; padding: 0 8px; text-overflow: ellipsis; white-space: nowrap;}\n.qui-siglComment{clear:both;margin-top:-40px;}\n.siglComment-title{width:80px;height:80px;float:left;}\n.siglComment-title img{width:80px;height:80px;}\n.siglComment-info{margin-left:90px;height:80px;margin-right:50px;}\n.siglComment-cn{font-size:18px;font-family:\"microsoft YAHEI\";display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n.siglComment-cn a{color:#636363;}\n.siglComment-en{font-size:14px;display:block;height:20px;padding-bottom:10px;}\n.siglComment-en a{color:#959595;}\n.siglComment-stars{height:22px;}\n.siglComment-stars .star{cursor:pointer;padding-right:5px;width:22px;height:22px;float:left;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon_star.png);background-repeat:no-repeat;background-position:-27px center;}\n.siglComment-stars .level{float:left;margin-left:20px;margin-top:5px;color:#959595;}\n.siglComment-stars .star-on{background-position:left center;}\n.siglComment-detail{overflow:hidden;clear:both;margin-top:15px;}\n.siglComment-detail .ui3_textarea{width:638px;height:104px;min-height:104px;padding:2px 5px 0px;display: block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;z-index: 10;position: relative;overflow: hidden;}\t\n.qui-siglComment .red{color:#f00;}  \n.siglComment-camera{height:30px;color:#959595;border:solid 1px #c0c0c0;margin-top:-1px;line-height:32px;overflow:hidden;}  \n.siglComment-camera input[type=file]{display:none;}\n.siglComment-camera label{background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/camera.png);background-repeat:no-repeat;background-position:left center;padding-left:20px;color:#0072bc;margin:0px 10px;cursor:pointer;}\n.siglComment-camera label:hover{text-decoration:underline;}\n.siglComment-camera~ .tips{margin-top:5px;}\n.siglComment-photolist{overflow: hidden;}\n.siglComment-photolist li{float:left;position: relative;width:80px;height:80px;padding:10px 0 10px 10px;float:left;overflow: hidden;}\n.siglComment-photolist li img{width:80px;height:80px;}\n.siglComment-photolist li .close{cursor:pointer;position:absolute;right:-1px;top:9px;background-image:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/close.png);background-repeat:no-repeat;background-position:left top;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist li .close:hover{background-position:left bottom;width:20px;height:20px;border:solid 1px transparent;}\n.siglComment-photolist .add{background:url(http://common2.qyerstatic.com/place/common/component/poiComment/images/icon-add.png) no-repeat 10px 10px;cursor: pointer;position: relative;}\n#siglCommentPhotoUp{display: inline-block;width: 100%;height: 100%;}  \n#siglCommentPhotoUp .moxie-shim-html5{left:0px!important;top:0px!important;}\n.uploadpopup .p10{padding: 10px;}\n.uploadpopup .mr10{margin-right: 10px;}@charset \"utf-8\";\n@charset \"utf-8\";\n@font-face {\n    font-family: 'Place';\n    src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot'); \n    src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.eot') format('embedded-opentype'), \n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.woff') format('woff'), \n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.ttf') format('truetype'),\n    url('http://static.qyer.com/models/basic/font/iconfont_place/place_iconfont.svg') format('svg'); \n}\n@font-face {font-family: \"exPlace\";\n  src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot');\n  src: url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.eot') format('embedded-opentype'), \n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.woff') format('woff'), \n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.ttf') format('truetype'),\n  url('http://static.qyer.com/models/basic/font/iconfont_place/place_exIconfont.svg') format('svg'); \n}\n@charset 'utf-8';\n.poiRedPoint{\n\tborder: solid 2px #fff;\n\tbackground: #ff6763;\n\tborder-radius: 50%;\n\twidth: 12px;\n\theight: 12px;\n\tdisplay: none;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\tmargin-left: 9px;\n\tz-index: 15;\n}\n.poiLikeTip{\n\twidth: 300px;\n\theight: 122px;\n\tposition: absolute;\n\tleft: 50%;\n\tmargin-left: -150px;\n\ttop: 43px;\n\tz-index: 16;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeTip.png) no-repeat left top;\n\tbackground-size: 300px 122px;\n\tcolor: #444!important;\n\tdisplay: none;\n}\n.poiLikeTip .close{\n\tposition: absolute;\n\tz-index:1;\n\tfont-size:20px;\n\tright: 5px;\n\ttop:10px;\n\theight: 26px;\n\tline-height: 24px;\n\twidth: 26px;\n\tcolor: #c0c0c0;\n\tbackground-image: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeClose.png);background-repeat: no-repeat;\n\tbackground-position: 3px 0px; \n\tbackground-size: 50px 25px;\n\tcursor: pointer;\n}\n.poiLikeTip .close:hover{\n\tbackground-position: -25px 0px;\n\tcolor: #fff;\n}\n.poiLikeTip .neverShow{\n\tposition: absolute;\n\tleft: 10px;\n\tbottom: 10px;\n\tcolor: #959595;\n}\n.poiLikeTip .neverShow:hover{\n\tcolor: #3f9f5f;\n}\n.poiLikeTip .text{\n\theight: 18px;\n\tline-height: 18px;\n\tcolor: #636363;\n\ttext-align: left;\n\tfont-size: 14px;\n\tpadding-left: 10px;\n\ttext-indent: 0px;\n}\n.poiLikeTip .t1{\n\tmargin-top: 16px;\n}\n.poiLikeTip em{\n\tfont-style: normal;\n\tfont-size: 16px;\n\tfont-weight: bold;\n}\n.poiLikeSmallTip{\n\twidth: 234px;\n\theight: 32px;\n\tdisplay: none;\n\tbackground: url(http://common2.qyerstatic.com/place/project/images/poi/poiLikeSmallTip.png) no-repeat left top;\n\tbackground-size: 234px 32px;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 43px;\n\tmargin-left: -117px;\n\tline-height: 36px;\n\tcolor: #959595!important;\n}\n.place-userbehavior .planto:hover .poiLikeHoverShow{\n\tdisplay: block;\n\tz-index: 5;\n}\n.poiLikeShow{\n\tdisplay: block!important;\n}\n.place-userbehavior .selected .poiLikeShow,\n.place-userbehavior .selected .poiLikeHoverShow{\n\tdisplay: none!important;\n}\n.place-ubloading{\n\tposition: relative;\n\tmin-height: 70px;\n}\n.place-ubloading:before{\n\tcontent: '';\n\tposition: absolute;\n\tleft: 0;\n\twidth: 100%;\n\theight: 70px;\n\ttop: 0;\n\tz-index: 10;\n\tbackground: rgba(255, 255, 255, 0.6) url(http://static.qyer.com/models/common/images/wait_16_2.gif) no-repeat center center;\n}\n.place-userbehavior{\n\theight: 84px;\n\tdisplay: table;\n\twidth: 100%;\n\tbox-sizing: border-box;\n}\n.place-userbehavior > li{\n\tcursor: pointer;\n\tdisplay: table-cell;\n\tposition: relative;\n\ttext-align: center;\n\theight: 84px;\n\tz-index: 1;\n}\n.place-userbehavior > li:before,\n.place-userbehavior > li:after{\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 0;\n\twidth: 40px;\n\theight: 40px;\n\tmargin-left: -20px;\n\tcontent: '';\n}\n.place-userbehavior > li:before{\n\tfont-family: 'Place'!important;\n\tfont-size: 24px;\n\tcolor: #fff;\n\tfont-style:normal;\n  \t-webkit-font-smoothing: antialiased;\n  \t-webkit-text-stroke-width: 0.2px;\n  \t-moz-osx-font-smoothing: grayscale;\n  \ttext-align: center;\n  \tline-height: 40px;\n  \tz-index: 12;\n}\n.place-userbehavior .planto:before{\n\tcontent: '\\e639';\n}\n.place-userbehavior .beento:before{\n\tcontent: '\\e63b';\n}\n.place-userbehavior .lived:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e890';\n}\n.place-userbehavior .addToPlan:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e893';\n}\n.place-userbehavior > li:after{\n\tbackground-color: rgb(67, 158, 97);\n\tborder-radius: 50%;\n\tz-index: 7;\n}\n.place-userbehavior > li:hover{\n\tcolor: rgb(20, 120, 80);\n}\n.place-userbehavior > li:hover:after{\n\tbackground-color: rgb(95, 172, 121);\n}\n.place-userbehavior > li.selected:after{\n\tbackground-color: rgb(236, 236, 236);\n}\n.place-userbehavior > li.selected:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e892';\n\tcolor: rgb(95, 172, 121);\n\tfont-weight: bold;\n}\n.place-userbehavior > li.selected:hover:before{\n\tfont-family: 'exPlace'!important;\n\tcontent: '\\e891';\n\tfont-weight: bold;\n}\n.place-userbehavior .fonts{\n\tfont-size:16px;\n\tposition: absolute;\n\twidth: 75px;\n\tmargin-left: -37px;\n\ttop: 50px;\n\tz-index: 4;\n}\n.place-userbehavior .beento ul li,\n.place-userbehavior .beento ul{\n\tdisplay: none;\n}\n.place-userbehavior .beento.selected ul{\n\tposition: absolute;\n\tborder: solid 4px #ececec;\n\twidth: 0;\n\theight: 0;\n\tborder-top:solid 4px transparent;\n\tborder-left:solid 4px transparent;\n\ttop:100%;\n\tleft: 100%;\n\tmargin: -15px 0 0 -10px;\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul li{\n\tdisplay: block;\n}\n.place-userbehavior .beento.selected:hover ul{\n\twidth: 100px;\n\tleft: 50%;\n\ttop: -7px;\n\tmargin:0 0 0 -50px;\n\tpadding-top: 87px;\n\tdisplay: block;\n\tborder: 1px solid #d7d7d7;\n\tbox-shadow: 0 0 4px rgba(0,0,0,0.15);\n\tbackground-color: #fff;\n\theight: auto;\n}\n.place-userbehavior .beento li{\n\tline-height: 32px;\n\tborder-top: #ececec solid 1px;\n\tmargin: 0 10px;\n\ttext-align: left;\n\ttext-indent: 3px;\n}\n.place-userbehavior .beento li a{\n\tcolor: #959595;\n\tdisplay: block;\n}\n.place-userbehavior .beento li a:hover{\n\tcolor: #0073b6;\n\ttext-decoration: none;\n}\n.place-userbehavior li.addToPlan:hover{\n\tcolor: #0073b6;\n}\n.place-userbehavior li.addToPlan:after{\n\tbackground-color: rgb(37, 150, 218);\n}\n.place-userbehavior li.addToPlan:hover:after{\n\tbackground-color: rgb(65, 166, 244);\n}\n.plcFootprint{\n\tpadding-top: 20px;\n\theight: 84px;\n}\n.plcZIndex{\n\tz-index: 2!important;\n}\n.place-exClass{\n\tposition: relative;\n}\n.place-exClass .beento.selected:hover ul{\n\tpadding-top: 101px!important;\n\ttop: -21px;\n}\n.place-exClass .beento.selected:hover li{\n\tdisplay: block;\n}\n.qui-tip{\n\tposition: fixed;\n\ttop: 100px;\n\tleft: 0;\n\twidth: 100%;\n\ttext-align: center;\n\tdisplay: none;\n\tz-index: 1100;\n}\n.qui-tip-box{\n\tdisplay: inline-block;\n\tmin-width:120px;\n\tmax-width:390px;\n\tpadding:20px 30px;\n\tbackground-color:#fff;\n\tbox-shadow: 0 2px 7px rgba(0,0,0,0.25);\n\tborder: solid 1px #c0c0c0;\n\ttext-align:left;\n\tfont-size: 18px;\n\tline-height: 32px;\n}\n.qui-tip-text { display:block; position:relative; padding-left:34px;}\n.qui-tip-text:before { content:''; position:absolute; left:0; top:4px; width:24px; height:24px; background:#fff url(http://common2.qyerstatic.com/place/common/ui/tip/icons2.png) no-repeat;}\n.qui-tip-box-error .qui-tip-text:before { background-position:0 -80px;}\n.qui-tip-box-warning .qui-tip-text:before { background-position:0 -40px;}.qui-inputAutocomplete{\n\tposition: absolute;\n\tz-index: 1100;\n\tbackground-color: #fff;\n\tborder: solid 1px #eee;\n}\n.qui-inputAutocomplete-ul{\n}\n.qui-inputAutocomplete-ul li{\n\theight: 32px;\n\tline-height: 32px;\n\tborder-bottom: solid 1px #eee;\n    background-color: #fff;\n    cursor: pointer;\n    word-break: keep-all;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n.qui-inputAutocomplete-ul li:hover,\n.qui-inputAutocomplete-ul li[data-select=true]{\n\tbackground-color: #e0f1de;\n}\n.qui-inputAutocomplete-ul li.disableDefalut{\n    background-color: #fff !important;\n    cursor: default;\n}\n.qui-inputAutocomplete-noResult{\n\tcolor:red;\n}\n.qyer_inputAutocomplete_name { padding:0 5px 0 10px;}\n.qyer_inputAutocomplete_name .current { color:#077345;}\n.qyer_inputAutocomplete_en { padding-right:10px; font-family:Tahoma, Geneva, sans-serif;}\n.qyer_inputAutocomplete_found { color:#959595; padding-right:10px;}\n.qyer_inputAutocomplete_creat { padding:10px;}.qui-openAskContainer .fz12{font-size:12px;}\n.qui-openAskContainer .vm{vertical-align: middle;}\n.qui-openAskContainer .bs{box-sizing:border-box; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; -ms-box-sizing:border-box;}\n.qui-openAskContainer .p20{padding:0 20px;}\n.qui-openAskContainer .mt20{margin-top:20px;}\n.qui-openAskContainer .qui-popup-box-content{padding:0px;}\n.qui-openAskContainer .qui-popup-box-bottom{display:none;}\n.qui-openAskContainer .hide{display:none;}\n.qui-openAskContainer .disableDefalut{display:none;}\n.qui-openAskContainer .qui-textArea{display:block; margin-top:10px;}\n.qui-openAskContainer  .qui-textArea  textarea,\n.qui-openAskContainer  .qui-textArea  input{width:100%; height:100%; font-size:14px; }\n.qui-openAskContainer  .qui-textArea  textarea{line-height:1.5;}\n.qui-openAskContainer  .qui-textArea  input{line-height:1;}\n.qui-openAskContainer  .qui-textArea  .tips{margin-top:6px; font-size:12px; color:rgb(149,149,149);}\n.qui-openAskContainer  .openAsk-askTitle{font-size:18px; line-height:20px; }\n.qui-openAskContainer  .openAsk-title { height:32px;}\n.qui-openAskContainer  .openAsk-content {height:128px;}\n.qui-openAskContainer  .openAsk-contentTitle{font-size:14px; line-height:16px; margin-top:40px;}\n.qui-openAskContainer  .tags{height:48px; margin-top:60px; border-top:1px solid rgb(195,195,195); border-bottom:1px solid rgb(195,195,195); background:rgb(224,241,223); position:relative; z-index:101; font-size:0; }\n.qui-openAskContainer  .tags  .tag-title,\n.qui-openAskContainer  .tags  .tag-item,\n.qui-openAskContainer  .tags  .tag,\n.qui-openAskContainer  .tags  .btn-tag-close,\n.qui-openAskContainer  .tags  .tag-input-ribbon{display:inline-block;}\n.qui-openAskContainer  .tags  .tag-title{height:48px; line-height:48px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-item {float: none; margin-right:10px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-item  .tag{float:left; padding:0 5px 0 12px; line-height:24px; background:url(http://static.qyer.com/images/bbs/two/tag_bg.png) no-repeat; color:#FFF; max-width:85px; overflow:hidden; text-overflow:ellipsis; white-space: nowrap;}\n.qui-openAskContainer  .tags  .tag-item  .btn-tag-close{float:left; width:22px; height:24px; background:url(http://static.qyer.com/images/bbs/two/tag_bg.png) no-repeat left -30px; cursor:pointer;}\n.qui-openAskContainer  .tags  .tag-item  .btn-tag-close:hover{background-position:left -60px;}\n.qui-openAskContainer  .tags  .tag-input-ribbon em{padding:0 6px; font-size:12px;}\n.qui-openAskContainer  .tags  .tag-input-ribbon input{width:120px; height:22px; padding:0 6px; font-size:12px; box-sizing:border-box; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; -ms-box-sizing:border-box; line-height:1;}\n.qui-openAskContainer  .ask-bottom-box{position:relative; padding:20px; height:70px;}\n.qui-openAskContainer  .ask-bottom-box .publish-box{position:relative; float:left; border:1px solid rgb(192,192,192); padding:0 50px 0 10px; line-height:22px; cursor:pointer;}\n.qui-openAskContainer  .ask-bottom-box .publish-box:hover{border:1px solid #999;}\n.qui-openAskContainer  .ask-bottom-box .publish-box  .publish-arrow{position:absolute; right:10px; top:9px; width:0; height:0; overflow: hidden; border:4px solid rgba(0,0,0,0); border-top-color:rgb(149,149,149); border-bottom-width:0; cursor:pointer;}\n.qui-openAskContainer  .ask-bottom-box .publish-box.open .publish-arrow{border:4px solid rgba(0,0,0,0); border-bottom-color:rgb(149,149,149); border-top-width:0;}\n.qui-openAskContainer .bbs-container{position:absolute; top:-357px; white-space: nowrap; font-size:0; z-index:2001; border:1px solid rgb(192,192,192); background-color:#FFF; padding:10px 30px 10px 10px; overflow:hidden;}\n.qui-openAskContainer .bbs-container .item{display:inline-block; vertical-align:top; padding-left:30px; margin-bottom:-30px; font-size:12px;}\n.qui-openAskContainer .bbs-container .item:first-child{padding-left:0;}\n.qui-openAskContainer .bbs-container dl{margin-bottom:30px;}\n.qui-openAskContainer .bbs-container dt{font-weight:700; margin-bottom:6px; line-height:14px;}\n.qui-openAskContainer .bbs-container a{display:block; line-height:24px; padding:0 6px; color:rgb(99,99,99);}\n.qui-openAskContainer .bbs-container a:hover{background-color:#ececec;color:#0073b6;text-decoration:none;}\n.qui-inputAutocomplete .qui-inputAutocomplete-noResult{padding-left:6px;border:1px solid #d7d7d7;line-height:22px;color:#959595;font-size:12px;}\n@charset \"utf-8\";\n#mguideManagePlatform{overflow: hidden;}\n#mguideManagePlatform .mguideManageList{height: 22px;line-height: 22px;font-size: 14px;overflow: hidden;}\n#mguideManagePlatform .index{font-weight: bold;width: 50px;text-align:center;float: left}\n#mguideManagePlatform .title{float:left;width: 400px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;}\n#mguideManagePlatform .author{float:left;width:100px;overflow: hidden;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;}\n#mguideManagePlatform .remove{float:left;width: 75px;float: left;}\n#mguideManagePlatform .blue{color:rgb(0,128,0);}"),
$(document).ready(function(){function t(t){var e=document.cookie;return"string"==typeof t?(document.cookie=t,document.cookie):"string"==typeof e&&e}function e(){if($(".qui-popup-logindialog").length>0)return!1;var e=t();if(e){for(var i=e.split(";"),n=i.length,o=0,r=!0;o<n;o++)if("isDoLogin"==$.trim(i[o].split("=")[0])){r=!1;break}if(r){qyerUtil.doLogin({databnipg:"autopopup"});var a=new Date;a.setTime(a.getTime()+864e5),t("isDoLogin=828;expires="+a.toGMTString()+";path=/")}}else qyerUtil.doLogin({databnipg:"autopopup"})}$("<style>.qyer_layer_fix{display:none!important}</style>").appendTo("body"),setTimeout(e,1e4)}),$("body").off("click","._addToLikeList").on("click","._addToLikeList",function(t){function e(t,e,i){var n=$.extend({oper:"planto",type:2,id:null,status:1},t);n[n.oper]=n.status,delete n.status,qyerUtil.doAjax({url:"/api.php?action=feeling",data:n,onSuccess:function(t){$.isFunction(e)&&e.call(this,t)},onError:function(t){i(),requirejs(["common/ui/tip/tip"],function(e){e.tip({text:t.data.msg,type:"error"})})}})}function i(){var t={liking:"plcAddToLikeList",liked:"plcCancelToLikeList"},i=["liked","liking"],o=n.attr("data-status")-0;e({id:n.attr("data-pid"),type:n.attr("data-type"),status:o},function(e){if(n.removeClass("_disabled"),0==e.error_code&&1==e.data.result){n.removeClass(t[i[o]]).addClass(t[i[1-o]]),n.attr("data-status",1-o);var r=$("table");$("table").length>0&&r.find("a[data-id="+n.attr("data-pid")+"]").attr("data-status",1-o).text(o?"取消想去":"加入想去"),$("body").trigger("addToLikeListEvent")}else requirejs(["common/ui/tip/tip"],function(t){t.tip({text:"操作失败"})})},function(){n.removeClass("_disabled")})}if(t.stopPropagation(),t.preventDefault(),!qyerUtil.isLogin())return!($(".qui-popup-logindialog").length>0&&"block"==$(".qui-popup-logindialog").css("display"))&&void qyerUtil.doLogin();var n=$(this);return!n.hasClass("_disabled")&&(n.addClass("_disabled"),qyerUtil.doTrackCode(n.attr("data-ipg-"+(1==n.attr("data-status")?"add":"delete"))),i(),!1)}),$(function(){function t(t){this.str=['<div id="plcHotelBox">','<ul id="plcHotelTips">','<li class="fontYaHei">','<span class="round"><img src="http://static.qyer.com/models/project/place/images/icon-hotelList1.png"/></span>',"<em>多数订单可免费取消</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="http://static.qyer.com/models/project/place/images/icon-hotelList2.png"/></span>',"<em>预订无需注册，下单即时确认</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="http://static.qyer.com/models/project/place/images/icon-hotelList3.png"/></span>',"<em>保证无手续费  保证最优惠房价</em>","</li>",'<li class="fontYaHei">','<span class="round"><img src="http://static.qyer.com/models/project/place/images/icon-hotelList4.png"/></span>',"<em>24/7全天中文客服支持</em>","</li>","</ul>","</div>"].join(""),this["class"]="ct",$.extend(this,t||{})}t.prototype={hideBox:function(){this.$dom.hide()},showBox:function(t,e){this.$dom.css(t).removeClass("ct cb").addClass(e).show()},init:function(){this.$dom=$(this.str),0!=this.tar.length&&(this.hideBox(),$(this.$dom).appendTo("body"))}};var e=new t({tar:$("#plcHotelTar")});e.init(),e.timer=!1,$("#plcHotelTar").on({mouseenter:function(){e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){var t=$(window).scrollTop(),i=$("#plcHotelTar");if(0!=i.length){var n=i.offset(),o=i.width(),r=i.height(),a=322,s=280;e.showBox({top:t-0+$(window).height()>=n.top-0+r+s+20?n.top-0+r+20:n.top-0-s-10,left:n.left-a/2+o/2},t-0+$(window).height()>=n.top-0+r+s+20?"ct":"cb")}},400)},mouseleave:function(){e.timer&&clearTimeout(e.timer),e.hideBox()}})}),!function(){function t(t){return t.replace(y,"").replace(b,",").replace(x,"").replace(w,"").replace(k,"").split(D)}function e(t){return"'"+t.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function i(i,n){function o(t){return p+=t.split(/\n/).length-1,u&&(t=t.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),t&&(t=_[1]+e(t)+_[2]+"\n"),t}function r(e){var i=p;if(l?e=l(e,n):a&&(e=e.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===e.indexOf("=")){var o=d&&!/^=[=#]/.test(e);if(e=e.replace(/^=[=#]?|[\s;]*$/g,""),o){var r=e.replace(/\s*\([^\)]+\)/,"");h[r]||/^(include|print)$/.test(r)||(e="$escape("+e+")")}else e="$string("+e+")";e=_[1]+e+_[2]}return a&&(e="$line="+i+";"+e),v(t(e),function(t){if(t&&!m[t]){var e;e="print"===t?b:"include"===t?x:h[t]?"$utils."+t:f[t]?"$helpers."+t:"$data."+t,w+=t+"="+e+",",m[t]=!0}}),e+"\n"}var a=n.debug,s=n.openTag,c=n.closeTag,l=n.parser,u=n.compress,d=n.escape,p=1,m={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},g="".trim,_=g?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=g?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+y+"}",x="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(a?"$line=0,":""),k=_[0],D="return new String("+_[3]+");";v(i.split(s),function(t){t=t.split(c);var e=t[0],i=t[1];1===t.length?k+=o(e):(k+=r(e),i&&(k+=o(i)))});var E=w+k+D;a&&(E="try{"+E+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+e(i)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var C=new Function("$data","$filename",E);return C.prototype=h,C}catch(T){throw T.temp="function anonymous($data,$filename) {"+E+"}",T}}var n=function(t,e){return"string"==typeof e?g(e,{filename:t}):a(t,e)};n.version="3.0.0",n.config=function(t,e){o[t]=e};var o=n.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},r=n.cache={};n.render=function(t,e){return g(t,e)};var a=n.renderFile=function(t,e){var i=n.get(t)||m({filename:t,name:"Render Error",message:"Template not found"});return e?i(e):i};n.get=function(t){var e;if(r[t])e=r[t];else if("object"==typeof document){var i=document.getElementById(t);if(i){var n=(i.value||i.innerHTML).replace(/^\s*|\s*$/g,"");e=g(n,{filename:t})}}return e};var s=function(t,e){return"string"!=typeof t&&(e=typeof t,"number"===e?t+="":t="function"===e?s(t.call(t)):""),t},c={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},l=function(t){return c[t]},u=function(t){return s(t).replace(/&(?![\w#]+;)|[<>"']/g,l)},d=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},p=function(t,e){var i,n;if(d(t))for(i=0,n=t.length;n>i;i++)e.call(t,t[i],i,t);else for(i in t)e.call(t,t[i],i)},h=n.utils={$helpers:{},$include:a,$string:s,$escape:u,$each:p};n.helper=function(t,e){f[t]=e};var f=n.helpers=h.$helpers;n.onerror=function(t){var e="Template Error\n\n";for(var i in t)e+="<"+i+">\n"+t[i]+"\n\n";"object"==typeof console&&console.error(e)};var m=function(t){return n.onerror(t),function(){return"{Template Error}"}},g=n.compile=function(t,e){function n(i){try{return new c(i,s)+""}catch(n){return e.debug?m(n)():(e.debug=!0,g(t,e)(i))}}e=e||{};for(var a in o)void 0===e[a]&&(e[a]=o[a]);var s=e.filename;try{var c=i(t,e)}catch(l){return l.filename=s||"anonymous",l.name="Syntax Error",m(l)}return n.prototype=c.prototype,n.toString=function(){return c.toString()},s&&e.cache&&(r[s]=n),n},v=h.$each,_="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,x=new RegExp(["\\b"+_.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,k=/^,+|,+$/g,D=/^$|,+/;o.openTag="{{",o.closeTag="}}";var E=function(t,e){var i=e.split(":"),n=i.shift(),o=i.join(":")||"";return o&&(o=", "+o),"$helpers."+n+"("+t+o+")"};o.parser=function(t){t=t.replace(/^\s/,"");var e=t.split(" "),i=e.shift(),o=e.join(" ");switch(i){case"if":t="if("+o+"){";break;case"else":e="if"===e.shift()?" if("+e.join(" ")+")":"",t="}else"+e+"{";break;case"/if":t="}";break;case"each":var r=e[0]||"$data",a=e[1]||"as",s=e[2]||"$value",c=e[3]||"$index",l=s+","+c;"as"!==a&&(r="[]"),t="$each("+r+",function("+l+"){";break;case"/each":t="});";break;case"echo":t="print("+o+");";break;case"print":case"include":t=i+"("+e.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(o)){var u=!0;0===t.indexOf("#")&&(t=t.substr(1),u=!1);for(var d=0,p=t.split("|"),h=p.length,f=p[d++];h>d;d++)f=E(f,p[d]);t=(u?"=":"=#")+f}else t=n.helpers[i]?"=#"+i+"("+e.join(",")+");":"="+t}return t},this.template=n}(),define("project/js/search/apiModel",[],function(){var t={getCity:function(t){return t.__qFED__={id:"939bbe68-82df-dd38-c4e2-7df09e3ad0ca",dataIndex:0,randomData:!0},t.posturl="/ajax.php?action=ajaxcity",t.type="get",window.qyerUtil.doAjax(t)},getPlace:function(t){return t.__qFED__={id:"426b6a51-154d-1fc2-3bd9-8bd9f27188fa",dataIndex:2,randomData:!1},t.posturl="/ajax.php?action=ajaxhotelsearch",t.type="get",window.qyerUtil.doAjax(t)}};return t}),define("project/js/search/tmplModel",[],function(){function t(){}return template.helper("renderLinkTitle",function(t){var e="";switch(t){case"sight":e="热门景点";break;case"hotel":e="酒店";break;case"other":e="其他";break;case"traffic":e="交通";break;default:e="其他"}return e}),t.prototype={render:function(t,e){var i=template.compile(this.segments[t]());return i(e)},segments:{loadingTPL:function(){var t='<div style="margin:100px auto; text-align:center;"><img src="http://static.qyer.com/static/hotel/new/hotel_list/images/loading.gif"></div>';return t},initCityLink:function(){var t=['<div class="city-wrapper">','<div class="continent-container">','<table class="continent-table">',"<tr>",'<td class="continent active" data-continent-name="hot"><span class="continent-name">热门</span></td>','<td class="continent" data-continent-name="asia"><span class="continent-name">亚洲</span></td>','<td class="continent" data-continent-name="europe"><span class="continent-name">欧洲</span></td>','<td class="continent" data-continent-name="africa"><span class="continent-name">非洲</span></td>','<td class="continent" data-continent-name="north_america"><span class="continent-name">北美洲</span></td>','<td class="continent" data-continent-name="south_america"><span class="continent-name">南美洲</span></td>','<td class="continent" data-continent-name="oceania"><span class="continent-name">大洋洲</span></td>',"</tr>","</table>","{{each list as continent}}","{{each continent as value key}}",'<div class="city-list qui-inputAutocomplete-ul clearfix {{if key=="hot"}}active{{/if}}" data-continent-name="{{key}}">',"{{each continent[key] as city}}",'<li class="city" data-id="{{city.id}}" data-value="{{city.cn_name||city_en_name}}"><a class="city-name" href="javascript:void(0);">{{city.cn_name||city_en_name}}</a></li>',"{{/each}}","</div>","{{/each}}","{{/each}}","</div>","</div>"].join("");return t},assoCityLink:function(){var t=['<div class="link-wrapper qui-inputAutocomplete-ul">',"{{if list && list.length}}",'<div class="link-type fontYaHei">城市</div>','<ul class="link-list-wrapper">',"{{each list as link}}",'<li class="link-city" data-id="{{link.id}}" data-value="{{link.cn_name}}" title="{{link.cn_name}}" {{if link.url}} data-url="{{link.url}}"{{/if}}{{if link.curCity}} data-type="{{link.curCity}}"{{/if}}>',"{{if link.high_light}}","{{if link.high_light.cn_name }}",'<span class="qyer_inputAutocomplete_name">{{#link.high_light.cn_name}}</span>',"{{/if}}","{{if link.high_light.en_name }}",'<span class="qyer_inputAutocomplete_en">{{#link.high_light.en_name}}</span>',"{{/if}}","{{else}}","{{if link.cn_name}}",'<span class="qyer_inputAutocomplete_name">{{#link.cn_name}}</span>',"{{/if}}","{{if link.en_name}}",'<span class="qyer_inputAutocomplete_en">{{#link.en_name}}</span>',"{{/if}}","{{/if}}","</li>","{{/each}}","</ul>","{{/if}}","</div>"].join("");return t},initLink:function(){var t=['<div class="hot-link-wrapper">',"{{each list as link linkType}}",'{{if ((linkType=="sight"||linkType=="traffic")&&list[linkType].length>0)}}','<div class="hot-link-type fontYaHei">{{linkType | renderLinkTitle}}</div>','<ul class="hot-link-list-wrapper qui-inputAutocomplete-ul clearfix">',"{{each list[linkType] as link}}",'<li class="hot-place" data-type="{{link.spx_type}}" data-id="{{link.id}}" data-value="{{link.cn_name}}" title="{{link.cn_name}}">','<span class="qyer_inputAutocomplete_name"><em class="current">{{link.cn_name}}</em></span>',"</li>","{{/each}}","</ul>","{{/if}}","{{/each}}","</div>"].join("");return t},assoLink:function(){var t=['<div class="link-wrapper  qui-inputAutocomplete-ul">',"{{if list.hotel && list.hotel.length }}",'<div class="link-type fontYaHei">酒店</div>','<ul class="link-list-wrapper">',"{{each list.hotel as link}}",'<li class="link-place" data-type="{{link.spx_type}}" data-id="{{link.id}}" data-value="{{if link.cn_name}}{{link.cn_name}}{{else}}{{link.en_name}}{{/if}}" title="{{if link.cn_name}}{{link.cn_name}}{{else}}{{link.en_name}}{{/if}}">',"{{if link.high_light[1] }}",'<span class="qyer_inputAutocomplete_name">{{#link.high_light[1]}}</span>',"{{/if}}","{{if link.high_light[0] }}",'<span class="qyer_inputAutocomplete_en">{{#link.high_light[0]}}</span>',"{{/if}}","</li>","{{/each}}","</ul>","{{/if}}","{{if list.sight && list.sight.length }}",'<div class="link-type fontYaHei">景点</div>','<ul class="link-list-wrapper">',"{{each list.sight as link}}",'<li class="link-place" data-type="{{link.spx_type}}" data-id="{{link.id}}" data-value="{{link.cn_name}}" title="{{link.cn_name}}">',"{{if link.high_light[1] }}",'<span class="qyer_inputAutocomplete_name">{{#link.high_light[1]}}</span>',"{{/if}}","{{if link.high_light[0] }}",'<span class="qyer_inputAutocomplete_en">{{#link.high_light[0]}}</span>',"{{/if}}","</li>","{{/each}}","</ul>","{{/if}}","{{if list.traffic && list.traffic.length }}",'<div class="link-type fontYaHei">交通</div>','<ul class="link-list-wrapper">',"{{each list.traffic as link}}",'<li class="link-place" data-type="{{link.spx_type}}" data-id="{{link.id}}" data-value="{{link.cn_name}}" title="{{link.cn_name}}">',"{{if link.high_light[1] }}",'<span class="qyer_inputAutocomplete_name">{{#link.high_light[1]}}</span>',"{{/if}}","{{if link.high_light[0] }}",'<span class="qyer_inputAutocomplete_en">{{#link.high_light[0]}}</span>',"{{/if}}","</li>","{{/each}}","</ul>","{{/if}}","{{if list.other && list.other.length }}",'<div class="link-type fontYaHei">其他</div>','<ul class="link-list-wrapper">',"{{each list.other as link}}",'<li class="link-place" data-type="{{link.spx_type}}" data-id="{{link.id}}" data-value="{{link.cn_name}}" title="{{link.cn_name}}">',"{{if link.high_light[1] }}",'<span class="qyer_inputAutocomplete_name">{{#link.high_light[1]}}</span>',"{{/if}}","{{if link.high_light[0] }}",'<span class="qyer_inputAutocomplete_en">{{#link.high_light[0]}}</span>',"{{/if}}","</li>","{{/each}}","</ul>","{{/if}}","</div>"].join("");return t},filter:function(){var t='<span class="tags" data-type="{{type}}" data-value="{{value}}"><strong>{{text}}</strong><a href="javascript:void(0);" class="js-del-tag"></a></span>';return t},noHotel:function(){var t=['<div class="none-box">','<i class="none-icon"></i>','<p class="none-text">','<span class="title fontYaHei">没有找到与条件相关的酒店</span><br/>','<span class="subtitle fontYaHei">建议：更换搜索条件重新查询</span>',"</p>","</div>"].join("");return t},recommendHotel:function(){return'<p class="recommend-item-text fontYaHei">推荐以下<em>{{total}}</em>家酒店供你参考</p>'}}},new t}),define("common/basic/js/normalize",[],function(){function t(t,i,o){if(t.match(s)||t.match(a))return t;t=r(t);var c=o.match(a),l=i.match(a);return!l||c&&c[1]==l[1]&&c[2]==l[2]?n(e(t,i),o):e(t,i)}function e(t,e){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(s)||t.match(a))return t;var i=e.split("/"),n=t.split("/");for(i.pop();curPart=n.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function n(t,e){var n=e.split("/");for(n.pop(),e=n.join("/")+"/",i=0;e.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),t=t.substr(i+1),n=e.split("/");var o=t.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,r=function(t){return t.replace(o,"$1/")},a=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,c=function(e,i,n){i=r(i),n=r(n);for(var o,a,e,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(e);){a=o[3]||o[2]||o[5]||o[6]||o[4];var c;c=t(a,i,n);var l=o[5]||o[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+c+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(c.length-a.length)}return e};return c.convertURIBase=t,c.absoluteURI=e,c.relativeURI=n,c}),define("common/basic/js/require-css",[],function(){if("undefined"==typeof window)return{load:function(t,e,i){i()}};var t=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,i=!1,n=!0;e[1]||e[7]?i=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?n=!1:e[4]&&(i=parseInt(e[4])<18);var o={};o.pluginBuilder="./css-builder";var r,a,s,c=function(){r=document.createElement("style"),t.appendChild(r),a=r.styleSheet||r.sheet},l=0,u=[],d=function(t){a.addImport(t),r.onload=function(){p()},l++,31==l&&(c(),l=0)},p=function(){s();var t=u.shift();return t?(s=t[1],void d(t[0])):void(s=null)},h=function(t,e){if(a&&a.addImport||c(),a&&a.addImport)s?u.push([t,e]):(d(t),s=e);else{r.textContent='@import "'+t+'";';var i=setInterval(function(){try{r.sheet.cssRules,clearInterval(i),e()}catch(t){}},10)}},f=function(e,i){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",n)o.onload=function(){o.onload=function(){},setTimeout(i,7)};else var r=setInterval(function(){for(var t=0;t<document.styleSheets.length;t++){var e=document.styleSheets[t];if(e.href==o.href)return clearInterval(r),i()}},10);o.href=e,t.appendChild(o)};return o.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},o.load=function(t,e,n,o){(i?h:f)(e.toUrl(t+".css"),n)},o}),define("common/basic/js/require-css!common/ui/inputAutocomplete/inputAutocomplete",[],function(){}),define("common/ui/inputAutocomplete/inputAutocomplete",["css!common/ui/inputAutocomplete/inputAutocomplete.css"],function(){function t(t){this.$obj=t.$obj,this.timer=null,this.isSearching=!1,this.autoSelect=!1,this.$contentDiv=null,this.option=t.option,t.option.parent&&(this.$parent=e(t.option.parent)),this.init()}var e=jQuery;t.prototype={$obj:null,timer:null,option:null,isSearching:!1,autoSelect:!1,$contentDiv:null,$parent:null,init:function(){this.createDomNode(),this.bindEvent()},createDomNode:function(){var t=['<div class="qui-inputAutocomplete" style="display:none;">','<ul class="qui-inputAutocomplete-ul" >','<li class="disableDefalut">loading ... </li>',"</ul>","</div>"].join("");this.$contentDiv=e(t);var i={width:this.$obj.outerWidth()};if(!this.$parent){var n=this.$obj.offset();i.top=n.top+this.$obj.outerHeight(),i.left=n.left,n=null}this.$contentDiv.css(i),this.$contentDiv.appendTo(this.$parent||document.body),t=i=null},_blurTimer:null,bindEvent:function(){var t=this;this.$obj.keyup(function(i){if(e.inArray(i.keyCode,[37,39])==-1)return 9==i.keyCode?(t.$contentDiv.hide(),void(t.option.onVoid&&t.option.onVoid(t.$obj[0]))):void(e.inArray(i.keyCode,[38,40,13])!=-1?t.updateUI(i.keyCode):e.trim(t.$obj.val())||t.option.isAllowEmptySeach?t.registSearch():(t.$contentDiv.hide(),t.option.onVoid&&t.option.onVoid(t.$obj[0])))}).blur(function(){t._blurTimer=window.setTimeout(function(){t.$contentDiv.is(":hidden")||t.option.isBlurClose!==!1&&t.$contentDiv.hide()},300)}),this.option.isFocusedSeach&&this.$obj.focus(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&t.registSearch()}),this.$contentDiv.delegate(".qui-inputAutocomplete-ul li","click",function(i){return i.target.className.indexOf("disableDefalut")!=-1?(i.stopPropagation(),void window.clearTimeout(t._blurTimer)):void(this.className.indexOf("disableDefalut")==-1&&(t.$obj.val(e(this).text()),t.$contentDiv.hide(),t.option.onSelect&&(t.option.onSelect.call(t.$obj[0],this),t.$contentDiv.html(""))))})},registSearch:function(){var t=this;this.isSearching=!1,window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){(e.trim(t.$obj.val())||t.option.isAllowEmptySeach)&&(t.isSearching=!0,t.showContentDiv(),t.option.onSearch.call(t.$obj[0]))},300)},showContentDiv:function(){var t=this;this.$contentDiv.is(":hidden")&&(this.$contentDiv.show(),e(document).one("click",function(e){t.option.isBlurClose!==!1&&t.$contentDiv.hide()}))},updateUI:function(t){function i(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e+1),t.length||(t=o.find("li:eq(0)"))):t=o.find("li:eq(0)"),t.attr("data-select","true"),t=null}function n(){var t=o.find("li[data-select=true]"),e=o.find("li").index(t);t.attr("data-select",""),t.length?(t=o.find("li:not(.disableDefalut)").eq(e-1),t.length||(t=o.find("li:eq("+(r-1)+")"))):t=o.find("li:eq("+(r-1)+")"),t.attr("data-select","true"),t=null}if(!this.$contentDiv.is(":hidden")){var o=this.$contentDiv.find(".qui-inputAutocomplete-ul"),r=o.find("li:not(.disableDefalut)").size();if(r&&(e.inArray(t,[38,40])!=-1&&(40==t?i():n()),this.option.enterSelect!==!1&&13==t)){var a=o.find("li[data-select=true]");a.length?(this.$obj.val(a.text()),this.option.onSelect&&(this.option.onSelect.call(this.$obj[0],a[0],!0),this.$contentDiv.html("")),this.$contentDiv.hide()):this.option.isBlurClose!==!1&&this.$contentDiv.hide()}}},pushHTML:function(t){var e={width:this.$obj.outerWidth()};if(!this.$parent){var i=this.$obj.offset();e.top=i.top+this.$obj.outerHeight(),e.left=i.left,i=null}this.$contentDiv.css(e).html(t).show(),this.isSearching=!1,e=null;var n=this.$contentDiv.find(".qui-inputAutocomplete-ul > li:not(.disableDefalut)");n.length&&this.autoSelect!==!1&&n.eq(0).attr("data-select","true"),n=null},isShow:function(){return!this.$contentDiv.is(":hidden")},hide:function(){return this.$contentDiv.hide()},destroy:function(){this.$contentDiv.remove()}},e.fn.extend({qyerAutocomplete:function(i){var n,o,r=arguments;return e.each(this,function(a,s){n=e(s),"object"==e.type(i)?n.data("_autocomplete",new t({$obj:n,option:i})):"pushHTML"==i?n.data("_autocomplete").pushHTML(r[1]):"getContent"==i?o=n.data("_autocomplete").$contentDiv:"isShow"==i?o=n.data("_autocomplete").isShow():"hide"==i?n.data("_autocomplete").hide():"destroy"==i&&(n.data("_autocomplete").destroy(),n.data("_autocomplete",null))}),n=r=null,"undefined"==typeof o?this:o}})}),define("project/js/search/link",["project/js/search/apiModel","project/js/search/tmplModel","common/ui/inputAutocomplete/inputAutocomplete"],function(t,e){function i(i){if(i&&i.el){var o=$(i.el),r=(i.data.city_data,[]);o.qyerAutocomplete({isAllowEmptySeach:!0,isFocusedSeach:!0,autoSelect:!1,exClassName:"link-city",onSearch:function(){var a=o.val();if(!a||a.length<1){var s=e.render("initCityLink",{list:i.data.list});o.qyerAutocomplete("pushHTML",s),$(document).on("mouseenter",".continent",function(t){var e=$(this),i=e.attr("data-continent-name"),n=e.parents(".continent-table").siblings(".city-list[data-continent-name="+i+"]").show();$(".city-list").not(n).hide(),e.addClass("active").siblings().removeClass("active")})}else{var c={data:{keyword:o.val()},onSuccess:function(t){if(t&&t.data){var i=e.render("assoCityLink",{list:t.data});o.qyerAutocomplete("pushHTML",i),r=t.data}},onError:function(t){}};n&&n.abort(),n=t.getCity(c)}},onSelect:function(t){var e=$(t);o.prop("value",e.attr("data-value")).attr("data-cityid",e.attr("data-id"))}})}}var n,o={linkCity:i};return o}),define("project/js/search/proxy",["project/js/search/apiModel","project/js/search/link","project/js/search/tmplModel"],function(t,e,i){function n(){this.$proxy=$({}),this._curPage=1,this.page=null,this._searchData={},this.ajax=null,this.getRealTimePriceAjax=null,this.bindEvt()}var o=(window.__globalData__.hotel_data.count,$(".js-tag-list"),$(".js-mainSearch")),r=$(".js-orderby"),a=($(".js-when-poi-hotel"),$(".js-arealist")),s=(a.find(".js-area-box"),$(".js-hotel-list"),$(".load-realtime"),$("#js-hotelListMap"),$(".js-page-container"),$("#nameClear")),c=$(".js-city");return n.prototype={initLinkCity:function(t){e.linkCity({el:".js-pop-city",data:t})},clearMainSearch:function(){o.find(".js-pop-place").val(""),s.click()},mainSearch:function(t){var e=o.find(".js-pop-city"),i=e.attr("data-cityid"),n=$.trim(e.val()),r=o.find(".js-pop-place"),a=r.attr("data-id"),s=r.attr("data-type"),c=$.trim(r.val()),l=o.find(".time[data-type='checkin']").val(),u=o.find(".time[data-type='checkout']").val();return!e.size()||n&&n.length?void(i&&window.open("http://place.qyer.com/?action=jumpsearch&jump=country&check_list=1"+(n?"&cityname="+n:"")+(i?"&cityid="+i:"")+(c?"&keyword="+c:"")+(s?"&spx_type="+s:"")+(a?"&spx_id="+a:"")+"&from="+l+"&to="+u)):void e.addClass("error")},resetSearch:function(t){this.clearTag(),this._searchData=Filter.init(t),r.find(".selected").removeClass("selected"),r.find(".titles span").html("综合排序")},renderTitle:function(t){c.find(".sub-title").html(t.keyword||t.area_name?"--"+(t.keyword?t.spx_type?"<em>"+t.keyword+"</em>附近":"‘<em>"+t.keyword+"</em>’相关":t.area_name)+"酒店预订":"")},triggerHandler:function(t,e){return this.$proxy.triggerHandler(t,e),this},bindEvt:function(){for(var t=this,e="renderTitle,mainSearch,updateHotelBrowsed,initFilter,updateFilter,removeFilter,clearTag,updateHotelResult,initLinkPlace,initLinkCity,renderHotelPage,placeSidebar,clearMainSearch".split(","),i=0,n=e.length;i<n;i++){var o=e[i];this.$proxy.on(o,function(e,i){t[e.type](i)})}}},new n}),function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(r.inline?e.parent()[0]:r.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))})}function o(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}t.extend(t.ui,{datepicker:{version:"1.10.3"}});var r,a="datepicker";t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return o(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,o,r;n=e.nodeName.toLowerCase(),o="div"===n||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),r=this._newInst(t(e),o),r.settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,r):o&&this._inlineDatepicker(e,r)},_newInst:function(e,i){var o=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:o,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,a,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,o,r,a=this._get(i,"appendText"),s=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[s?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),("focus"===n||"both"===n)&&e.focus(this._showDatepicker),("button"===n||"both"===n)&&(o=this._get(i,"buttonText"),r=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:r,alt:o,title:o}):t("<button type='button'></button>").addClass(this._triggerClass).html(r?t("<img/>").attr({src:r,alt:o,title:o}):o)),e[s?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,o,r=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,n=0,o=0;t.length>o;o++)t[o].length>i&&(i=t[o].length,n=o);return n},r.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),t.input.attr("size",this._formatDate(t,r).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,a,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,r,s){var c,l,u,d,p,h=this._dialogInst;return h||(this.uuid+=1,c="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+c+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),
h=this._dialogInst=this._newInst(this._dialogInput,!1),h.settings={},t.data(this._dialogInput[0],a,h)),o(h.settings,r||{}),i=i&&i.constructor===Date?this._formatDate(h,i):i,this._dialogInput.val(i),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(l=document.documentElement.clientWidth,u=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,p=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,u/2-150+p]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],a,h),this},_destroyDatepicker:function(e){var i,n=t(e),o=t.data(e,a);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,a),"input"===i?(o.append.remove(),o.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,n,o=t(e),r=t.data(e,a);o.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,r.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,o=t(e),r=t.data(e,a);o.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,r.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,a)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,n,r){var a,s,c,l,u=this._getInst(i);return 2===arguments.length&&"string"==typeof n?"defaults"===n?t.extend({},t.datepicker._defaults):u?"all"===n?t.extend({},u.settings):this._get(u,n):null:(a=n||{},"string"==typeof n&&(a={},a[n]=r),u&&(this._curInst===u&&this._hideDatepicker(),s=this._getDateDatepicker(i,!0),c=this._getMinMaxDate(u,"min"),l=this._getMinMaxDate(u,"max"),o(u.settings,a),null!==c&&a.dateFormat!==e&&a.minDate===e&&(u.settings.minDate=this._formatDate(u,c)),null!==l&&a.dateFormat!==e&&a.maxDate===e&&(u.settings.maxDate=this._formatDate(u,l)),"disabled"in a&&(a.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),u),this._autoSize(u),this._setDate(u,s),this._updateAlternate(u),this._updateDatepicker(u)),e)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,o,r=t.datepicker._getInst(e.target),a=!0,s=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return o=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",r.dpDiv),o[0]&&t.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,o[0]),i=t.datepicker._get(r,"onSelect"),i?(n=t.datepicker._formatDate(r),i.apply(r.input?r.input[0]:null,[n,r])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,s?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,s?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(i){var n,o,r=t.datepicker._getInst(i.target);return t.datepicker._get(r,"constrainInput")?(n=t.datepicker._possibleChars(t.datepicker._get(r,"dateFormat")),o=String.fromCharCode(null==i.charCode?i.keyCode:i.charCode),i.ctrlKey||i.metaKey||" ">o||!n||n.indexOf(o)>-1):e},_doKeyUp:function(e){var i,n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n)),i&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(o){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,r,a,s,c,l;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,"beforeShow"),r=n?n.apply(e,[e,i]):{},r!==!1&&(o(i.settings,r),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),a=!1,t(e).parents().each(function(){return a|="fixed"===t(this).css("position"),!a}),s={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),s=t.datepicker._checkOffset(i,s,a),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":a?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"}),i.inline||(c=t.datepicker._get(i,"showAnim"),l=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[c]?i.dpDiv.show(c,t.datepicker._get(i,"showOptions"),l):i.dpDiv[c||"show"](c?l:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,r=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,n=this._getNumberOfMonths(e),o=n[1],a=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&e.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",a*o+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var o=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,c=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?o-a:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+s?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+o>c&&c>o?Math.abs(i.left+o-c):0),i.top-=Math.min(i.top,i.top+r>l&&l>r?Math.abs(r+s):0),i},_findPos:function(e){for(var i,n=this._getInst(e),o=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[o?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,o,r,s=this._curInst;!s||e&&s!==t.data(e,a)||this._datepickerShowing&&(i=this._get(s,"showAnim"),n=this._get(s,"duration"),o=function(){t.datepicker._tidyDialog(s)},t.effects&&(t.effects.effect[i]||t.effects[i])?s.dpDiv.hide(i,t.datepicker._get(s,"showOptions"),n,o):s.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,o),i||o(),this._datepickerShowing=!1,r=this._get(s,"onClose"),r&&r.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var o=t(e),r=this._getInst(o[0]);this._isDisabledDatepicker(o[0])||(this._adjustInstDate(r,i+("M"===n?this._get(r,"showCurrentAtPos"):0),n),this._updateDatepicker(r))},_gotoToday:function(e){var i,n=t(e),o=this._getInst(n[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(i=new Date,o.selectedDay=i.getDate(),o.drawMonth=o.selectedMonth=i.getMonth(),o.drawYear=o.selectedYear=i.getFullYear()),this._notifyChange(o),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var o=t(e),r=this._getInst(o[0]);r["selected"+("M"===n?"Month":"Year")]=r["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(o)},_selectDay:function(e,i,n,o){var r,a=t(e);t(o).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(r=this._getInst(a[0]),r.selectedDay=r.currentDay=t("a",o).html(),r.selectedMonth=r.currentMonth=i,r.selectedYear=r.currentYear=n,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,o=t(e),r=this._getInst(o[0]);i=null!=i?i:this._formatDate(r),r.input&&r.input.val(i),this._updateAlternate(r),n=this._get(r,"onSelect"),n?n.apply(r.input?r.input[0]:null,[i,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,o,r=this._get(e,"altField");r&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),o=this.formatDate(i,n,this._getFormatConfig(e)),t(r).each(function(){t(this).val(o)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,n,o){if(null==i||null==n)throw"Invalid arguments";if(n="object"==typeof n?""+n:n+"",""===n)return null;var r,a,s,c,l=0,u=(o?o.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof u?u:(new Date).getFullYear()%100+parseInt(u,10),p=(o?o.dayNamesShort:null)||this._defaults.dayNamesShort,h=(o?o.dayNames:null)||this._defaults.dayNames,f=(o?o.monthNamesShort:null)||this._defaults.monthNamesShort,m=(o?o.monthNames:null)||this._defaults.monthNames,g=-1,v=-1,_=-1,y=-1,b=!1,x=function(t){var e=i.length>r+1&&i.charAt(r+1)===t;return e&&r++,e},w=function(t){var e=x(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,o=RegExp("^\\d{1,"+i+"}"),r=n.substring(l).match(o);if(!r)throw"Missing number at position "+l;return l+=r[0].length,parseInt(r[0],10)},k=function(i,o,r){var a=-1,s=t.map(x(i)?r:o,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(s,function(t,i){var o=i[1];return n.substr(l,o.length).toLowerCase()===o.toLowerCase()?(a=i[0],l+=o.length,!1):e}),-1!==a)return a+1;throw"Unknown name at position "+l},D=function(){if(n.charAt(l)!==i.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;i.length>r;r++)if(b)"'"!==i.charAt(r)||x("'")?D():b=!1;else switch(i.charAt(r)){case"d":_=w("d");break;case"D":k("D",p,h);break;case"o":y=w("o");break;case"m":v=w("m");break;case"M":v=k("M",f,m);break;case"y":g=w("y");break;case"@":c=new Date(w("@")),g=c.getFullYear(),v=c.getMonth()+1,_=c.getDate();break;case"!":c=new Date((w("!")-this._ticksTo1970)/1e4),g=c.getFullYear(),v=c.getMonth()+1,_=c.getDate();break;case"'":x("'")?D():b=!0;break;default:D()}if(n.length>l&&(s=n.substr(l),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=g?0:-100)),y>-1)for(v=1,_=y;a=this._getDaysInMonth(g,v-1),!(a>=_);)v++,_-=a;if(c=this._daylightSavingAdjust(new Date(g,v-1,_)),c.getFullYear()!==g||c.getMonth()+1!==v||c.getDate()!==_)throw"Invalid date";return c},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var n,o=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,r=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,c=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},l=function(t,e,i){var n=""+e;if(c(t))for(;i>n.length;)n="0"+n;return n},u=function(t,e,i,n){return c(t)?n[e]:i[e]},d="",p=!1;if(e)for(n=0;t.length>n;n++)if(p)"'"!==t.charAt(n)||c("'")?d+=t.charAt(n):p=!1;else switch(t.charAt(n)){case"d":d+=l("d",e.getDate(),2);break;case"D":d+=u("D",e.getDay(),o,r);break;case"o":d+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",e.getMonth()+1,2);break;case"M":d+=u("M",e.getMonth(),a,s);break;case"y":d+=c("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=1e4*e.getTime()+this._ticksTo1970;break;case"'":c("'")?d+="'":p=!0;break;default:d+=t.charAt(n)}return d},_possibleChars:function(t){var e,i="",n=!1,o=function(i){var n=t.length>e+1&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;t.length>e;e++)if(n)"'"!==t.charAt(e)||o("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":o("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,o=this._getDefaultDate(t),r=o,a=this._getFormatConfig(t);try{r=this.parseDate(i,n,a)||o}catch(s){n=e?"":n}t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),t.currentDay=n?r.getDate():0,t.currentMonth=n?r.getMonth():0,t.currentYear=n?r.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var o=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},r=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(n){}for(var o=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,r=o.getFullYear(),a=o.getMonth(),s=o.getDate(),c=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=c.exec(i);l;){switch(l[2]||"d"){case"d":case"D":s+=parseInt(l[1],10);break;case"w":case"W":s+=7*parseInt(l[1],10);break;case"m":case"M":a+=parseInt(l[1],10),s=Math.min(s,t.datepicker._getDaysInMonth(r,a));break;case"y":case"Y":r+=parseInt(l[1],10),s=Math.min(s,t.datepicker._getDaysInMonth(r,a))}l=c.exec(i)}return new Date(r,a,s)},a=null==i||""===i?n:"string"==typeof i?r(i):"number"==typeof i?isNaN(i)?n:o(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?n:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,o=t.selectedMonth,r=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),o===t.selectedMonth&&r===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,o,r,a,s,c,l,u,d,p,h,f,m,g,v,_,y,b,x,w,k,D,E,C,T,A,S,$,R,I,j,q,O,M,L,N,P,F=new Date,z=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),B=this._get(t,"isRTL"),U=this._get(t,"showButtonPanel"),H=this._get(t,"hideIfNoPrevNext"),Y=this._get(t,"navigationAsDateFormat"),G=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),W=this._get(t,"stepMonths"),K=1!==G[0]||1!==G[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,tt=t.drawYear;if(0>Z&&(Z+=12,tt--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-G[0]*G[1]+1,Q.getDate())),e=J&&J>e?J:e;this._daylightSavingAdjust(new Date(tt,Z,1))>e;)Z--,0>Z&&(Z=11,tt--);for(t.drawMonth=Z,t.drawYear=tt,i=this._get(t,"prevText"),i=Y?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,Z-W,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":H?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",o=this._get(t,"nextText"),o=Y?this.formatDate(o,this._daylightSavingAdjust(new Date(tt,Z+W,1)),this._getFormatConfig(t)):o,r=this._canAdjustMonth(t,1,tt,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+o+"</span></a>":H?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+o+"</span></a>",a=this._get(t,"currentText"),s=this._get(t,"gotoCurrent")&&t.currentDay?X:z,a=Y?this.formatDate(a,s,this._getFormatConfig(t)):a,c=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=U?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?c:"")+(this._isInRange(t,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":c)+"</div>":"",u=parseInt(this._get(t,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(t,"showWeek"),p=this._get(t,"dayNames"),h=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),_=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),b="",w=0;G[0]>w;w++){for(k="",this.maxRows=4,D=0;G[1]>D;D++){if(E=this._daylightSavingAdjust(new Date(tt,Z,t.selectedDay)),C=" ui-corner-all",T="",K){if(T+="<div class='ui-datepicker-group",G[1]>1)switch(D){case 0:T+=" ui-datepicker-group-first",C=" ui-corner-"+(B?"right":"left");break;case G[1]-1:T+=" ui-datepicker-group-last",C=" ui-corner-"+(B?"left":"right");break;default:T+=" ui-datepicker-group-middle",C=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===w?B?r:n:"")+(/all|right/.test(C)&&0===w?B?n:r:"")+this._generateMonthYearHeader(t,Z,tt,J,Q,w>0||D>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=d?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;7>x;x++)S=(x+u)%7,A+="<th"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+p[S]+"'>"+h[S]+"</span></th>";for(T+=A+"</tr></thead><tbody>",$=this._getDaysInMonth(tt,Z),tt===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,$)),R=(this._getFirstDayOfMonth(tt,Z)-u+7)%7,I=Math.ceil((R+$)/7),j=K&&this.maxRows>I?this.maxRows:I,this.maxRows=j,q=this._daylightSavingAdjust(new Date(tt,Z,1-R)),O=0;j>O;O++){for(T+="<tr>",M=d?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(q)+"</td>":"",x=0;7>x;x++)L=g?g.apply(t.input?t.input[0]:null,[q]):[!0,""],N=q.getMonth()!==Z,P=N&&!_||!L[0]||J&&J>q||Q&&q>Q,M+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(N?" ui-datepicker-other-month":"")+(q.getTime()===E.getTime()&&Z===t.selectedMonth&&t._keyEvent||y.getTime()===q.getTime()&&y.getTime()===E.getTime()?" "+this._dayOverClass:"")+(P?" "+this._unselectableClass+" ui-state-disabled":"")+(N&&!v?"":" "+L[1]+(q.getTime()===X.getTime()?" "+this._currentClass:"")+(q.getTime()===z.getTime()?" ui-datepicker-today":""))+"'"+(N&&!v||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(P?"":" data-handler='selectDay' data-event='click' data-month='"+q.getMonth()+"' data-year='"+q.getFullYear()+"'")+">"+(N&&!v?"&#xa0;":P?"<span class='ui-state-default'>"+q.getDate()+"</span>":"<a class='ui-state-default"+(q.getTime()===z.getTime()?" ui-state-highlight":"")+(q.getTime()===X.getTime()?" ui-state-active":"")+(N?" ui-priority-secondary":"")+"' href='#'>"+q.getDate()+"</a>")+"</td>",q.setDate(q.getDate()+1),q=this._daylightSavingAdjust(q);T+=M+"</tr>"}Z++,Z>11&&(Z=0,tt++),T+="</tbody></table>"+(K?"</div>"+(G[0]>0&&D===G[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=T}b+=k}return b+=l,t._keyEvent=!1,b},_generateMonthYearHeader:function(t,e,i,n,o,r,a,s){var c,l,u,d,p,h,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),_=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",b="";if(r||!g)b+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(c=n&&n.getFullYear()===i,l=o&&o.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!c||u>=n.getMonth())&&(!l||o.getMonth()>=u)&&(b+="<option value='"+u+"'"+(u===e?" selected='selected'":"")+">"+s[u]+"</option>");b+="</select>"}if(_||(y+=b+(!r&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",r||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(t,"yearRange").split(":"),p=(new Date).getFullYear(),h=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?p+parseInt(t,10):parseInt(t,10);return isNaN(e)?p:e},f=h(d[0]),m=Math.max(f,h(d[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=o?Math.min(m,o.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),_&&(y+=(!r&&g&&v?"":"&#xa0;")+b),y+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),o=t.drawMonth+("M"===i?e:0),r=Math.min(t.selectedDay,this._getDaysInMonth(n,o))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,o,r)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),o=i&&i>e?i:e;return n&&o>n?n:o},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var o=this._getNumberOfMonths(t),r=this._daylightSavingAdjust(new Date(i,n+(0>e?e:o[0]*o[1]),1));return 0>e&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(t,r)},_isInRange:function(t,e){var i,n,o=this._getMinMaxDate(t,"min"),r=this._getMinMaxDate(t,"max"),a=null,s=null,c=this._get(t,"yearRange");return c&&(i=c.split(":"),n=(new Date).getFullYear(),a=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=n),i[1].match(/[+\-].*/)&&(s+=n)),(!o||e.getTime()>=o.getTime())&&(!r||e.getTime()<=r.getTime())&&(!a||e.getFullYear()>=a)&&(!s||s>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var o=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),o,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.3"}(jQuery),define("common/basic/js/jquery-ui/jquery.ui.datepicker.min",function(){}),function(t,e){function i(e,i){var o,r,a,s=e.nodeName.toLowerCase();return"area"===s?(o=e.parentNode,r=o.name,!(!e.href||!r||"map"!==o.nodeName.toLowerCase())&&(a=t("img[usemap=#"+r+"]")[0],!!a&&n(a))):(/input|select|textarea|button|object/.test(s)?!e.disabled:"a"===s?e.href||i:i)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var n,o,r=t(this[0]);r.length&&r[0]!==document;){if(n=r.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var n=t.attr(e,"tabindex"),o=isNaN(n);return(o||n>=0)&&i(e,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,n){
function o(e,i,n,o){return t.each(r,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var r="Width"===n?["Left","Right"]:["Top","Bottom"],a=n.toLowerCase(),s={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?s["inner"+n].call(this):this.each(function(){t(this).css(a,o(this,i)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?s["outer"+n].call(this,e):this.each(function(){t(this).css(a,o(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,n){var o,r=t.ui[e].prototype;for(o in n)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([i,n[o]])},call:function(t,e,i){var n,o=t.plugins[e];if(o&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;o.length>n;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return e[n]>0||(e[n]=1,o=e[n]>0,e[n]=0,o)}})}(jQuery),define("common/basic/js/jquery-ui/jquery.ui.core.min",function(){}),define("common/basic/js/require-css!common/ui/datepicker/datepicker",[],function(){}),define("common/ui/datepicker/datepicker_forcity",["common/basic/js/jquery-ui/jquery.ui.datepicker.min","common/basic/js/jquery-ui/jquery.ui.datepicker.min","common/basic/js/jquery-ui/jquery.ui.core.min","css!common/ui/datepicker/datepicker.css"],function(){jQuery(function(t){t.datepicker.regional["zh-CN"]={closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},t.datepicker.setDefaults(t.datepicker.regional["zh-CN"])})}),define("project/js/search/datepicker",["common/ui/datepicker/datepicker_forcity"],function(){function t(t){return new Date(t).getTime()}function e(e){var i,r=e.getTime(),a=n.datepicker("getDate"),s=o.datepicker("getDate"),c=t(a),l=t(s);return i=r>c&&r<l?[!0,"ui-state-selected ui-state-between",""]:r==c?[!0,"ui-state-startDay",""]:r==l?[!0,"ui-state-endDay",""]:r>l?[!0,"ui-state-after-endDay",""]:[!1,"ui-state-before-startDay",""],r=startDateTe=s=c=l=null,i}var i,n=$(".js-datepicker[data-type='checkin']"),o=n.siblings(".js-datepicker"),r=n.siblings(".js-dayText"),a=n.val(),s=o.val(),c=(t(a),t(s));n.datepicker({changeMonthType:!0,changeYear:!0,dateFormat:"yy-mm-dd",minDate:new Date}),o.datepicker({changeMonthType:!0,changeYear:!0,dateFormat:"yy-mm-dd",numberOfMonths:2,minDate:new Date(c),beforeShowDay:e}),i=o.datepicker("widget"),o.datepicker("option",{beforeShow:function(){i.on("mouseover",".ui-state-after-endDay,.ui-state-endDay",function(t){var e,n=$(this),o=i.find(".ui-state-after-endDay,.ui-state-endDay"),r=0;o.removeClass("ui-state-selected ui-state-hover"),n.addClass("ui-state-hover");for(var r=0,a=o.size();r<a&&(e=o.eq(r),e.addClass("ui-state-selected"),!e.hasClass("ui-state-hover"));r++);}).on("mouseover",".ui-state-between,.ui-state-before-startDay",function(t){var e=$(this),n=i.find(".ui-state-after-endDay,.ui-state-endDay");n.removeClass("ui-state-selected ui-state-hover"),e.addClass("ui-state-hover")})},onClose:function(){i.off("mouseover",".ui-state-after-endDay")},onSelect:function(t){var e=new Date(n.datepicker("getDate")).getTime(),i=new Date(o.datepicker("getDate")).getTime(),a=1*(i-e)/3600*1/24*1/1e3;r.text("共"+a+"晚")}}),n.datepicker("option","onSelect",function(e,i){var n,r,a=$(this),s=a.datepicker("getDate"),c=o.datepicker("getDate"),l=t(s),u=t(c);r=new Date(l+864e5),n=new Date(Math.max(l+864e5,u)),setTimeout(function(){o.datepicker("option",{minDate:r}).datepicker("setDate",n).datepicker("show")},200)})}),define("project/js/search/genHotelURI",[],function(){var t;if("undefined"==typeof jQuery&&"undefined"==typeof Zepto)return{};t=jQuery||Zepto;var e={getBookingJumpUrl:function(e){var i={url:"",cityname:"",check_in:"",check_out:""},n=t.extend({},i,e);n.url||(n.url="http://www.booking.com/searchresults.html");var o="",r=n.check_in,a=n.check_out,s="",c="",l="",u="",d=null,p="",h="";return r?d=new Date(r):(d=new Date,d.setMonth(d.getMonth()+1)),p=d.getMonth()+1,p<10&&(p="0"+p),h=d.getDate(),h<10&&(h="0"+h),s=d.getFullYear()+"-"+p,c=h,a?d=new Date(a):r?(d=new Date(r),d.setTime(d.getTime()+172800)):(d=new Date,d.setMonth(d.getMonth()+1),d.setDate(d.getDate()+2)),p=d.getMonth()+1,p<10&&(p="0"+p),h=d.getDate(),h<10&&(h="0"+h),l=d.getFullYear()+"-"+p,u=h,o+=n.url,o+=-1===n.url.indexOf("?")?"?":"&",o+="lang=zh-cn&ifl=&ss="+encodeURIComponent(n.cityname),o+="&checkin_monthday="+c+"&checkin_year_month="+s+"&checkout_monthday="+u+"&checkout_year_month="+l,o+="&si=ai%2Cco%2Cci%2Cre%2Cdi"},getGotoUrl:function(e){var i={url:"",hotel_id:0,hotel_name:"",aid_key:"",cityid:0,device:"",jump_second:0},n=t.extend({},i,e);if(!n.url)return n.url;n.aid_key||(n.aid_key="default");var o="";return o+="http://www.qyer.com/goto.php?",o+="url="+encodeURIComponent(n.url),0!==n.jump_second&&(o+="&jump_second="+n.jump_second),""!==n.hotel_name&&(o+="&hotel_name="+encodeURIComponent(n.hotel_name)),0!==n.hotel_id&&(o+="&hotelid="+n.hotel_id),0!==n.cityid&&(o+="&cityid="+n.cityid),""!==n.device&&(o+="&device="+n.device),""!==n.aid_key&&(o+="&aid_key="+n.aid_key),o},getBookingGotoUrl:function(e){var i=this,n={url:"",aid_key:"",hotel_id:0,hotel_name:"",cityid:0,cityname:"",check_in:"",check_out:"",device:"",jump_second:0},o=t.extend({},n,e),r="";return r=i.getGotoUrl({url:i.getBookingJumpUrl({url:o.url,cityname:o.cityname,check_in:o.check_in,check_out:o.check_out}),hotel_id:o.hotel_id,hotel_name:o.hotel_name,aid_key:o.aid_key,cityid:o.cityid,device:o.device,jump_second:o.jump_second})}};return e});var PageController={_timer:null,_curPage:1,proxy:null,redirect:function(){},init:function(t){var e=this;this.city=t,requirejs(["project/js/search/proxy"],function(t){e.proxy=t,e.proxy.triggerHandler("initLinkCity",{list:window.__globalData__.hot_data,city_data:window.__globalData__.city_data}),e.bindEvt()}),e.initComponent()},initComponent:function(){var t=this;requirejs(["project/js/search/datepicker"]),requirejs(["project/js/search/genHotelURI"],function(e){t.redirect=function(t){function i(t){var e,i=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(i))?e[2]:null}var n,o,r,a,s,c,l,u,d,p,h,f,m,g,v,_,y,b,x=$(".js-pop-city"),w=$(".js-datepicker[data-type='checkin']"),k=$(".js-datepicker[data-type='checkout']");t&&t.el&&(o=$(t.el).closest(".js-hotel"),c=806198,s=o.attr("data-url"),city_id=x.attr("data-cityid"),city_name=x.val(),r=w.val()||"",a=k.val()||"",l=r.replace(/\-\d{2}$/,""),u=r.replace(/^\d{4}\-\d{2}\-/,""),d=a.replace(/\-\d{2}$/,""),p=a.replace(/^\d{4}\-\d{2}\-/,""),h=$.trim(o.find(".js-hotelname").text()),f=o.attr("data-hotelid"),m=window.QYER?window.QYER.uid:0,g=i("_guid"),v=(new Date).getTime()+""+Math.floor(1e3*Math.random()),_="uid_"+m+"_guid_"+g+"_datetime_"+v+"_cityid_"+city_id+"_hotelid_"+f,y="http://www.booking.com/?aid="+c,n="http://www.qyer.com/goto.php",params={checkin_year_month:l,checkin_monthday:u,checkout_year_month:d,checkout_monthday:p,label:_,lang:"zh-cn",error_url:y},b=e.getBookingGotoUrl({url:s,aid_key:"hotel_list",hotel_id:f,hotel_name:h,cityid:city_id,cityname:city_name,check_in:r,check_out:a,device:"",jump_second:0}),window.open(/^(http:\/\/)?hotel.qyer.com/.test(s)===!0?s:b))}})},bindEvt:function(){var t=this,e=this.city,i=(e.id,e.name,$(".js-pop-city"));$(document).on("click",".js-pop-city",function(t){$(this).removeClass("error")}).on("input",".js-pop-city",function(e){var n=$(this),o=n.val();i=$(".js-city"),cur_city_id=i.attr("data-cityid"),cur_city_name=i.text(),o!==cur_city_name?(n.removeAttr("data-cityid"),o&&o.length||t.proxy.triggerHandler("initHotCity")):n.attr("data-cityid",cur_city_id)}).on("click",".js-btn-mainSearch",function(e){t.proxy.triggerHandler("mainSearch")}).on("click",".js-booking-btn",function(e){e.preventDefault(),e.stopPropagation();var i=this;t.redirect({el:i})})}};$(function(){var t={init:function(){$.extend(window.__globalData__,{map:{}});var t={id:window.__globalData__&&window.__globalData__.city_data?window.__globalData__.city_data.city_id:0,name:window.__globalData__&&window.__globalData__.city_data?window.__globalData__.city_data.city_name:""};cachePlaceData(t);try{PageController.init(t)}catch(e){console&&console.log("页面初始化JS失败")}}};t.init()}),define("project/js/hotelPromotion",function(){}),function(t){var e=document,i="appendChild",n="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][i](o),o[n]?o[n].cssText=t:o[i](e.createTextNode(t))}(".qui-inputAutocomplete{\n\tposition: absolute;\n\tz-index: 1100;\n\tbackground-color: #fff;\n\tborder: solid 1px #eee;\n}\n.qui-inputAutocomplete-ul{\n}\n.qui-inputAutocomplete-ul li{\n\theight: 32px;\n\tline-height: 32px;\n\tborder-bottom: solid 1px #eee;\n    background-color: #fff;\n    cursor: pointer;\n    word-break: keep-all;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n.qui-inputAutocomplete-ul li:hover,\n.qui-inputAutocomplete-ul li[data-select=true]{\n\tbackground-color: #e0f1de;\n}\n.qui-inputAutocomplete-ul li.disableDefalut{\n    background-color: #fff !important;\n    cursor: default;\n}\n.qui-inputAutocomplete-noResult{\n\tcolor:red;\n}\n.qyer_inputAutocomplete_name { padding:0 5px 0 10px;}\n.qyer_inputAutocomplete_name .current { color:#077345;}\n.qyer_inputAutocomplete_en { padding-right:10px; font-family:Tahoma, Geneva, sans-serif;}\n.qyer_inputAutocomplete_found { color:#959595; padding-right:10px;}\n.qyer_inputAutocomplete_creat { padding:10px;}/*\n * jQuery UI Datepicker 1.8.18\n *\n * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Datepicker#theming\n */\n.ui-datepicker { display:none; width:218px; padding:10px; background:#fff; border:1px solid #ccc; box-shadow:2px 2px 3px #ccc; z-index:2001 !important; }\n.ui-datepicker .ui-datepicker-header { position:relative; height:34px; background-color:#34914c; color:#fff; line-height:34px; border-top-left-radius:2px; border-top-right-radius:2px; }\n.ui-datepicker .ui-datepicker-prev, .ui-datepicker .ui-datepicker-next { position:absolute; top:0; width:24px; height:34px; overflow:hidden; cursor:pointer; }\n.ui-datepicker .ui-datepicker-prev { left:0;border-right: none !important; }\n.ui-datepicker .ui-datepicker-next { right:0;border-left: none !important; }\n.ui-datepicker .ui-datepicker-prev-hover, .ui-datepicker .ui-datepicker-next-hover { background-color:#038250; }\n.ui-datepicker .ui-datepicker-prev-hover { }\n.ui-datepicker .ui-datepicker-next-hover { }\n.ui-datepicker .ui-state-disabled { opacity:0.5; background-color:transparent; cursor:default;}\n.ui-datepicker .ui-datepicker-prev span, .ui-datepicker .ui-datepicker-next span { display:block; width:23px; height:34px; background:url(http://static.qyer.com/models/common/ui/datepicker/icon.png) no-repeat 8px 11px; overflow:hidden; line-height:200px;}\n.ui-datepicker .ui-datepicker-prev span { border-right: none !important;}\n.ui-datepicker .ui-datepicker-next span { background-position:-35px 11px; border-left: none !important;}\n.ui-datepicker .ui-datepicker-title { margin:0 24px; text-align: center; font-size:14px;}\n.ui-datepicker .ui-datepicker-title select { font-size:1em; margin:1px 0; }\n.ui-datepicker select.ui-datepicker-month-year {width: 100%;}\n.ui-datepicker select.ui-datepicker-month, \n.ui-datepicker select.ui-datepicker-year { width:60px; margin-right:5px;}\n.ui-datepicker table {width: 100%; border-collapse: collapse; border:1px solid #e6e6e6; border-top:none; }\n.ui-datepicker th { padding:4px 0; text-align: center; border: 0; color:#9e9e9e;  }\n.ui-datepicker td { border:1px solid #e6e6e6; }\n.ui-datepicker td span, .ui-datepicker td a { display: block; padding:6px; text-decoration: none; text-align:center; background-color:#fff; border:999999; color:#323232;}\n.ui-datepicker td span { color:#959595;}\n.ui-datepicker td .ui-state-default { }\n.ui-datepicker td .ui-state-space { background-color:#d6e8e1;}\n.ui-datepicker td .ui-state-hover { background-color:#e7e7e7;}\n.ui-datepicker td .ui-state-highlight { background:#fff894; color:#636363;}\n.ui-datepicker td .ui-state-active { background:#34914c; color:#fff;}\n.ui-datepicker .ui-datepicker-buttonpane { background-image: none; margin: .7em 0 0 0; padding:0 .2em; border-left: 0; border-right: 0; border-bottom: 0; }\n.ui-datepicker .ui-datepicker-buttonpane button { float: right; margin: .5em .2em .4em; cursor: pointer; padding: .2em .6em .3em .6em; width:auto; overflow:visible; }\n.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current { float:left; }\n.ui-datepicker.ui-datepicker-multi { width:auto; }\n.ui-datepicker-multi .ui-datepicker-group { float:left; }\n.ui-datepicker-multi .ui-datepicker-group table { width:100%; margin:0 auto; }\n.ui-datepicker-multi-2 .ui-datepicker-group { width:218px; }\n.ui-datepicker-multi-3 .ui-datepicker-group { width:218px; }\n.ui-datepicker-multi-4 .ui-datepicker-group { width:218px; }\n.ui-datepicker-multi .ui-datepicker-group-first { margin-right:10px;}\n.ui-datepicker-multi .ui-datepicker-group-middle { margin-right:10px;}\n.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header { border-left-width:0; }\n.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header { border-left-width:0; }\n.ui-datepicker-multi .ui-datepicker-buttonpane { clear:left; }\n.ui-datepicker-row-break { clear:both; width:100%; font-size:0em; }\n.ui-datepicker-rtl { direction: rtl; }\n.ui-datepicker-rtl .ui-datepicker-prev { right: 2px; left: auto; }\n.ui-datepicker-rtl .ui-datepicker-next { left: 2px; right: auto; }\n.ui-datepicker-rtl .ui-datepicker-prev:hover { right: 1px; left: auto; }\n.ui-datepicker-rtl .ui-datepicker-next:hover { left: 1px; right: auto; }\n.ui-datepicker-rtl .ui-datepicker-buttonpane { clear:right; }\n.ui-datepicker-rtl .ui-datepicker-buttonpane button { float: left; }\n.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current { float:right; }\n.ui-datepicker-rtl .ui-datepicker-group { float:right; }\n.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header { border-right-width:0; border-left-width:1px; }\n.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header { border-right-width:0; border-left-width:1px; }\n.ui-datepicker-cover {\n    display: none; \n    display: block; \n    position: absolute; \n    z-index: -1; \n    filter: mask(); \n    top: -4px; \n    left: -4px; \n    width: 200px; \n    height: 200px; \n}"),$(document).ready(function(){$(".js-batchDpingBtn, .pla_topbtns .yelp").off("click").on("click",function(){requirejs(["common/component/footprint/js/comment"],function(t){t.commShow({city_id:PLACE.PID,source_type:"C-des-batchComment"})})})});